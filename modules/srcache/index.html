
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Automatic documentation from sources, for NGINX Extras.">
      
      
        <meta name="author" content="Danila Vershinin">
      
      
        <link rel="canonical" href="https://nginx-extras.getpagespeed.com/modules/srcache/">
      
      
        <link rel="prev" href="../spnego-http-auth/">
      
      
        <link rel="next" href="../srt/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>srcache - NGINX Extras Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-YZHLYCQK9D"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-YZHLYCQK9D",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-YZHLYCQK9D",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="srcache - NGINX Extras Documentation" >
      
        <meta  property="og:description"  content="Automatic documentation from sources, for NGINX Extras." >
      
        <meta  property="og:image"  content="https://nginx-extras.getpagespeed.com/assets/images/social/modules/srcache.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://nginx-extras.getpagespeed.com/modules/srcache/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="srcache - NGINX Extras Documentation" >
      
        <meta  name="twitter:description"  content="Automatic documentation from sources, for NGINX Extras." >
      
        <meta  name="twitter:image"  content="https://nginx-extras.getpagespeed.com/assets/images/social/modules/srcache.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="getpagespeed" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#srcache-transparent-subrequest-based-caching-layout-for-arbitrary-nginx-locations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
  NGINX Extras is <a href="https://www.getpagespeed.com/repo-subscribe" target="_blank"><em>subscription-ware</em></a> by GetPageSpeed, allowing your server to be secure and fast.

          </div>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="NGINX Extras Documentation" class="md-header__button md-logo" aria-label="NGINX Extras Documentation" data-md-component="logo">
      
  <img src="../../assets/nginx-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NGINX Extras Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              srcache
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="getpagespeed" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  Modules

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../lua/" class="md-tabs__link">
          
  
  Lua Scripting

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../branches/" class="md-tabs__link">
          
  
  Distributions

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="https://www.getpagespeed.com/redhat" class="md-tabs__link">
        
  
    
  
  RPM Repository

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="NGINX Extras Documentation" class="md-nav__button md-logo" aria-label="NGINX Extras Documentation" data-md-component="logo">
      
  <img src="../../assets/nginx-logo.png" alt="logo">

    </a>
    NGINX Extras Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../accept-language/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    accept-language
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ajp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ajp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../array-var/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    array-var
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auth-digest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-digest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auth-ldap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-ldap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auth-pam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-pam
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bot-verifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bot-verifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../brotli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    brotli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cache-purge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cache-purge
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../captcha/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    captcha
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combined-upstreams/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    combined-upstreams
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    concat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cookie-flag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cookie-flag
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cookie-limit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cookie-limit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../coolkit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    coolkit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dav-ext/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dav-ext
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../doh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    doh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic-etag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dynamic-etag
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic-limit-req/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dynamic-limit-req
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../echo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    echo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encrypted-session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    encrypted-session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../execute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    execute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../f4fhds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    f4fhds
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fancyindex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fancyindex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fips-check/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fips-check
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    flv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../form-input/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    form-input
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geoip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geoip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geoip2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geoip2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../google/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    google
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graphite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../headers-more/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    headers-more
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hmac-secure-link/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hmac-secure-link
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../html-sanitize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    html-sanitize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../iconv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iconv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../image-filter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    image-filter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../immutable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    immutable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ipscrub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ipscrub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jpeg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jpeg
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../js-challenge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    js-challenge
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../json/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    json
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../json-var/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    json-var
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jwt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jwt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../length-hiding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    length-hiding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../let/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    let
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../live-common/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    live-common
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../log-zmq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log-zmq
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lua/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lua
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    markdown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../memc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    memc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../naxsi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    naxsi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nchan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nchan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ndk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ndk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../njs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    njs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ntlm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ntlm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pagespeed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pagespeed
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../passenger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    passenger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../perl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    perl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../phantom-token/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    phantom-token
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postgres/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    postgres
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pta
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../push-stream/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    push-stream
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rdns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rdns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../redis2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rtmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rtmp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../secure-token/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    secure-token
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security-headers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    security-headers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../set-misc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    set-misc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shibboleth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shibboleth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../slowfs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    slowfs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../small-light/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    small-light
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spnego-http-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spnego-http-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    srcache
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    srcache
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#status" class="md-nav__link">
    <span class="md-ellipsis">
      Status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synopsis" class="md-nav__link">
    <span class="md-ellipsis">
      Synopsis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    <span class="md-ellipsis">
      Description
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#subrequest-caching" class="md-nav__link">
    <span class="md-ellipsis">
      Subrequest caching
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#distributed-memcached-caching" class="md-nav__link">
    <span class="md-ellipsis">
      Distributed Memcached Caching
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caching-with-redis" class="md-nav__link">
    <span class="md-ellipsis">
      Caching with Redis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cache-key-preprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Cache Key Preprocessing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#directives" class="md-nav__link">
    <span class="md-ellipsis">
      Directives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_fetch" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_fetch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_fetch_skip" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_fetch_skip
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_max_size" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_max_size
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_skip" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_skip
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_statuses" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_statuses
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_ranges" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_ranges
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_header_buffer_size" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_header_buffer_size
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_hide_header" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_hide_header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_pass_header" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_pass_header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_methods" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_methods
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_ignore_content_encoding" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_ignore_content_encoding
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_request_cache_control" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_request_cache_control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_response_cache_control" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_response_cache_control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_no_store" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_no_store
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_no_cache" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_no_cache
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_private" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_private
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_default_expire" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_default_expire
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_max_expire" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_max_expire
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    <span class="md-ellipsis">
      Variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_expire" class="md-nav__link">
    <span class="md-ellipsis">
      $srcache_expire
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_fetch_status" class="md-nav__link">
    <span class="md-ellipsis">
      $srcache_fetch_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_status" class="md-nav__link">
    <span class="md-ellipsis">
      $srcache_store_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#known-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Known Issues
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caveats" class="md-nav__link">
    <span class="md-ellipsis">
      Caveats
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trouble-shooting" class="md-nav__link">
    <span class="md-ellipsis">
      Trouble Shooting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-suite" class="md-nav__link">
    <span class="md-ellipsis">
      Test Suite
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github" class="md-nav__link">
    <span class="md-ellipsis">
      GitHub
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../srt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    srt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../statsd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    statsd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sticky/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sticky
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stream-lua/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stream-lua
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stream-sts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stream-sts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stream-upsync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stream-upsync
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../substitutions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    substitutions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sysguard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sysguard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../testcookie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    testcookie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../traffic-accounting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    traffic-accounting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../untar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    untar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upstream-fair/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream-fair
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upstream-jdomain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream-jdomain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upsync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upsync
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vod
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    webp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xslt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xslt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xss/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xss
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zstd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zstd
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lua Scripting
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Lua Scripting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/acme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    acme
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/auto-ssl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auto-ssl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/aws-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/aws-sdk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws-sdk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/balancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    balancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/base-encoding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    base-encoding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/cache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/checkups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    checkups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/consul/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    consul
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/consul-event/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    consul-event
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/cookie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cookie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    core
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/cors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/counter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    counter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/ctxdump/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ctxdump
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/dns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/dns-server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dns-server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/etcd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    etcd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/exec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/feishu-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    feishu-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/fileinfo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fileinfo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/ftpclient/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ftpclient
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/global-throttle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    global-throttle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/healthcheck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    healthcheck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/hmac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hmac
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/hoedown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hoedown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/http/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    http
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/http2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    http2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/httpipe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    httpipe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/hyperscan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hyperscan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/influx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    influx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/ini/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ini
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/iputils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iputils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/jit-uuid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jit-uuid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/jsonrpc-batch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jsonrpc-batch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/jump-consistent-hash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jump-consistent-hash
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/jwt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jwt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/kafka/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kafka
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/libcjson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    libcjson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/libr3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    libr3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/limit-rate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    limit-rate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/limit-traffic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    limit-traffic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/lmdb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lmdb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/locations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    locations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/lock/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/logger-socket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    logger-socket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/lrucache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lrucache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/macaroons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    macaroons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/mail/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mail
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/maxminddb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    maxminddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/memcached/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    memcached
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/mlcache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mlcache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/multiplexer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    multiplexer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/murmurhash2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    murmurhash2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/mysql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mysql
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/nettle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nettle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/newrelic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    newrelic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/nsq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nsq
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/ntlm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ntlm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/openidc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    openidc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/openssl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    openssl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/perf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    perf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/prettycjson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    prettycjson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/pubsub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pubsub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/qless/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    qless
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/qless-web/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    qless-web
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/rabbitmqstomp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rabbitmqstomp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/rack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/radixtree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    radixtree
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/redis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/redis-connector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis-connector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/redis-ratelimit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis-ratelimit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/redis-util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis-util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/repl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    repl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/reqargs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    reqargs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/requests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    requests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/riak/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    riak
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/router/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    router
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/rsa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rsa
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/scrypt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scrypt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/signal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    signal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/smtp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    smtp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/snappy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    snappy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/sniproxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sniproxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/socket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    socket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/string/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/t1k/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    t1k
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tags
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/tarantool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tarantool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/template/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    template
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    test
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/timer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    timer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/tlc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tlc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/tsort/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tsort
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/txid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    txid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/upload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/upstream/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/upstream-healthcheck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream-healthcheck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/uuid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    uuid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/validation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/vhost/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vhost
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/waf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    waf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/weauth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    weauth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/websocket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    websocket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/woothee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    woothee
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/worker-events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    worker-events
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/xxhash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xxhash
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Distributions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Distributions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../branches/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NGINX Branches
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nginx-mod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NGINX-MOD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tengine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tengine
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plesk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plesk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP/3 (QUIC)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../angie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Angie
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://www.getpagespeed.com/redhat" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RPM Repository
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#status" class="md-nav__link">
    <span class="md-ellipsis">
      Status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synopsis" class="md-nav__link">
    <span class="md-ellipsis">
      Synopsis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    <span class="md-ellipsis">
      Description
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#subrequest-caching" class="md-nav__link">
    <span class="md-ellipsis">
      Subrequest caching
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#distributed-memcached-caching" class="md-nav__link">
    <span class="md-ellipsis">
      Distributed Memcached Caching
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caching-with-redis" class="md-nav__link">
    <span class="md-ellipsis">
      Caching with Redis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cache-key-preprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Cache Key Preprocessing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#directives" class="md-nav__link">
    <span class="md-ellipsis">
      Directives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_fetch" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_fetch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_fetch_skip" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_fetch_skip
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_max_size" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_max_size
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_skip" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_skip
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_statuses" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_statuses
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_ranges" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_ranges
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_header_buffer_size" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_header_buffer_size
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_hide_header" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_hide_header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_pass_header" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_pass_header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_methods" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_methods
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_ignore_content_encoding" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_ignore_content_encoding
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_request_cache_control" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_request_cache_control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_response_cache_control" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_response_cache_control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_no_store" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_no_store
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_no_cache" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_no_cache
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_private" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_store_private
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_default_expire" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_default_expire
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_max_expire" class="md-nav__link">
    <span class="md-ellipsis">
      srcache_max_expire
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    <span class="md-ellipsis">
      Variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_expire" class="md-nav__link">
    <span class="md-ellipsis">
      $srcache_expire
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_fetch_status" class="md-nav__link">
    <span class="md-ellipsis">
      $srcache_fetch_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#srcache_store_status" class="md-nav__link">
    <span class="md-ellipsis">
      $srcache_store_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#known-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Known Issues
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caveats" class="md-nav__link">
    <span class="md-ellipsis">
      Caveats
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trouble-shooting" class="md-nav__link">
    <span class="md-ellipsis">
      Trouble Shooting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-suite" class="md-nav__link">
    <span class="md-ellipsis">
      Test Suite
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github" class="md-nav__link">
    <span class="md-ellipsis">
      GitHub
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="srcache-transparent-subrequest-based-caching-layout-for-arbitrary-nginx-locations"><em>srcache</em>: Transparent subrequest-based caching layout for arbitrary NGINX locations</h1>
<h2 id="installation">Installation</h2>
<p>You can install this module in any <abbr title="Red Hat Enterprise Linux">RHEL</abbr>-based distribution, including, but not limited to:</p>
<ul>
<li>RedHat Enterprise Linux 7, 8, 9</li>
<li>CentOS 7, 8, 9</li>
<li>AlmaLinux 8, 9</li>
<li>Rocky Linux 8, 9</li>
<li>Amazon Linux 2 and Amazon Linux 2023</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">CentOS/<abbr title="Red Hat Enterprise Linux">RHEL</abbr> 7 and Amazon Linux 2</label><label for="__tabbed_1_2">CentOS/<abbr title="Red Hat Enterprise Linux">RHEL</abbr> 8, 9 and Fedora Linux, Amazon Linux 2023, etc.</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>```bash
yum -y install <a href="https://extras.getpagespeed.com/release-latest.rpm">https://extras.getpagespeed.com/release-latest.rpm</a>
yum -y install <a href="https://epel.cloud/pub/epel/epel-release-latest-7.noarch.rpm">https://epel.cloud/pub/epel/epel-release-latest-7.noarch.rpm</a> 
yum -y install nginx-module-srcache</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>https://extras.getpagespeed.com/release-latest.rpm<span class="w"> </span>
dnf<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>nginx-module-srcache
</code></pre></div>
</div>
</div>
</div>
<p>Enable the module by adding the following at the top of <code>/etc/nginx/nginx.conf</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">load_module</span><span class="w"> </span><span class="s">modules/ngx_http_srcache_filter_module.so</span><span class="p">;</span>
</code></pre></div>
<p>This document describes nginx-module-srcache <a href="https://github.com/dvershinin/srcache-nginx-module/releases/tag/v0.32" target="_blank">v0.32</a> 
released on Jun 28 2022.</p>
<hr />

<p><strong>ngx_srcache</strong> - Transparent subrequest-based caching layout for arbitrary nginx locations</p>
<h2 id="status">Status</h2>
<p>This module is production ready.</p>
<h2 id="synopsis">Synopsis</h2>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">upstream</span><span class="w"> </span><span class="s">my_memcached</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">server</span><span class="w"> </span><span class="n">10.62.136.7</span><span class="p">:</span><span class="mi">11211</span><span class="p">;</span>
<span class="w">     </span><span class="kn">keepalive</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>

<span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">/memc</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">internal</span><span class="p">;</span>

<span class="w">     </span><span class="kn">memc_connect_timeout</span><span class="w"> </span><span class="s">100ms</span><span class="p">;</span>
<span class="w">     </span><span class="kn">memc_send_timeout</span><span class="w"> </span><span class="s">100ms</span><span class="p">;</span>
<span class="w">     </span><span class="kn">memc_read_timeout</span><span class="w"> </span><span class="s">100ms</span><span class="p">;</span>
<span class="w">     </span><span class="kn">memc_ignore_client_abort</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>

<span class="w">     </span><span class="kn">set</span><span class="w"> </span><span class="nv">$memc_key</span><span class="w"> </span><span class="nv">$query_string</span><span class="p">;</span>
<span class="w">     </span><span class="kn">set</span><span class="w"> </span><span class="nv">$memc_exptime</span><span class="w"> </span><span class="mi">300</span><span class="p">;</span>

<span class="w">     </span><span class="kn">memc_pass</span><span class="w"> </span><span class="s">my_memcached</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>

<span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/foo</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">set</span><span class="w"> </span><span class="nv">$key</span><span class="w"> </span><span class="nv">$uri$args</span><span class="p">;</span>
<span class="w">     </span><span class="kn">srcache_fetch</span><span class="w"> </span><span class="s">GET</span><span class="w"> </span><span class="s">/memc</span><span class="w"> </span><span class="nv">$key</span><span class="p">;</span>
<span class="w">     </span><span class="kn">srcache_store</span><span class="w"> </span><span class="s">PUT</span><span class="w"> </span><span class="s">/memc</span><span class="w"> </span><span class="nv">$key</span><span class="p">;</span>
<span class="w">     </span><span class="kn">srcache_store_statuses</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="mi">301</span><span class="w"> </span><span class="mi">302</span><span class="w"> </span><span class="mi">307</span><span class="w"> </span><span class="mi">308</span><span class="p">;</span>

<span class="w">     </span><span class="c1"># proxy_pass/fastcgi_pass/drizzle_pass/echo/etc...</span>
<span class="w">     </span><span class="c1"># or even static files on the disk</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">/memc2</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">internal</span><span class="p">;</span>

<span class="w">     </span><span class="kn">memc_connect_timeout</span><span class="w"> </span><span class="s">100ms</span><span class="p">;</span>
<span class="w">     </span><span class="kn">memc_send_timeout</span><span class="w"> </span><span class="s">100ms</span><span class="p">;</span>
<span class="w">     </span><span class="kn">memc_read_timeout</span><span class="w"> </span><span class="s">100ms</span><span class="p">;</span>
<span class="w">     </span><span class="kn">memc_ignore_client_abort</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>

<span class="w">     </span><span class="kn">set_unescape_uri</span><span class="w"> </span><span class="nv">$memc_key</span><span class="w"> </span><span class="nv">$arg_key</span><span class="p">;</span>
<span class="w">     </span><span class="kn">set</span><span class="w"> </span><span class="nv">$memc_exptime</span><span class="w"> </span><span class="nv">$arg_exptime</span><span class="p">;</span>

<span class="w">     </span><span class="kn">memc_pass</span><span class="w"> </span><span class="s">unix:/tmp/memcached.sock</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>

<span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/bar</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">set_escape_uri</span><span class="w"> </span><span class="nv">$key</span><span class="w"> </span><span class="nv">$uri$args</span><span class="p">;</span>
<span class="w">     </span><span class="kn">srcache_fetch</span><span class="w"> </span><span class="s">GET</span><span class="w"> </span><span class="s">/memc2</span><span class="w"> </span><span class="s">key=</span><span class="nv">$key</span><span class="p">;</span>
<span class="w">     </span><span class="kn">srcache_store</span><span class="w"> </span><span class="s">PUT</span><span class="w"> </span><span class="s">/memc2</span><span class="w"> </span><span class="s">key=</span><span class="nv">$key&amp;exptime=$srcache_expire</span><span class="p">;</span>

<span class="w">     </span><span class="c1"># proxy_pass/fastcgi_pass/drizzle_pass/echo/etc...</span>
<span class="w">     </span><span class="c1"># or even static files on the disk</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="nv">$request_method</span><span class="w"> </span><span class="nv">$skip_fetch</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">default</span><span class="w">     </span><span class="mi">0</span><span class="p">;</span>
<span class="w">     </span><span class="kn">POST</span><span class="w">        </span><span class="mi">1</span><span class="p">;</span>
<span class="w">     </span><span class="kn">PUT</span><span class="w">         </span><span class="mi">1</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>

<span class="w"> </span><span class="k">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">listen</span><span class="w"> </span><span class="mi">8080</span><span class="p">;</span>

<span class="w">     </span><span class="kn">location</span><span class="w"> </span><span class="s">/api/</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="kn">set</span><span class="w"> </span><span class="nv">$key</span><span class="w"> </span><span class="s">&quot;</span><span class="nv">$uri?$args&quot;</span><span class="p">;</span>

<span class="w">         </span><span class="kn">srcache_fetch</span><span class="w"> </span><span class="s">GET</span><span class="w"> </span><span class="s">/memc</span><span class="w"> </span><span class="nv">$key</span><span class="p">;</span>
<span class="w">         </span><span class="kn">srcache_store</span><span class="w"> </span><span class="s">PUT</span><span class="w"> </span><span class="s">/memc</span><span class="w"> </span><span class="nv">$key</span><span class="p">;</span>

<span class="w">         </span><span class="kn">srcache_methods</span><span class="w"> </span><span class="s">GET</span><span class="w"> </span><span class="s">PUT</span><span class="w"> </span><span class="s">POST</span><span class="p">;</span>
<span class="w">         </span><span class="kn">srcache_fetch_skip</span><span class="w"> </span><span class="nv">$skip_fetch</span><span class="p">;</span>

<span class="w">         </span><span class="c1"># proxy_pass/drizzle_pass/content_by_lua/echo/...</span>
<span class="w">     </span><span class="p">}</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<h2 id="description">Description</h2>
<p>This module provides a transparent caching layer for arbitrary nginx locations (like those use an upstream or even serve static disk files). The caching behavior is mostly compatible with <a href="http://www.ietf.org/rfc/rfc2616.txt">RFC 2616</a>.</p>
<p>Usually, <a href="https://github.com/openresty/memc-nginx-module">memc-nginx-module</a> is used together with this module to provide a concrete caching storage backend. But technically, any modules that provide a REST interface can be used as the fetching and storage subrequests used by this module.</p>
<p>For main requests, the <a href="#srcache_fetch">srcache_fetch</a> directive works at the end of the access phase, so the <a href="http://nginx.org/en/docs/http/ngx_http_access_module.html">standard access module</a>'s <a href="http://nginx.org/en/docs/http/ngx_http_access_module.html#allow">allow</a> and <a href="http://nginx.org/en/docs/http/ngx_http_access_module.html#deny">deny</a> direcives run <em>before</em> ours, which is usually the desired behavior for security reasons.</p>
<p>The workflow of this module looks like below:</p>
<p><img alt="srcache flowchart" src="http://agentzh.org/misc/image/srcache-flowchart.png" title="srcache flowchart" /></p>
<h2 id="subrequest-caching">Subrequest caching</h2>
<p>For <em>subrequests</em>, we explicitly <strong>disallow</strong> the use of this module because it's too difficult to get right. There used to be an implementation but it was buggy and I finally gave up fixing it and abandoned it.</p>
<p>However, if you're using <a href="https://github.com/openresty/lua-nginx-module">lua-nginx-module</a>, it's easy to do subrequest caching in Lua all by yourself. That is, first issue a subrequest to an <a href="https://github.com/openresty/memc-nginx-module">memc-nginx-module</a> location to do an explicit cache lookup, if cache hit, just use the cached data returned; otherwise, fall back to the true backend, and finally do a cache insertion to feed the data into the cache.</p>
<p>Using this module for main request caching and Lua for subrequest caching is the approach that we're taking in our business. This hybrid solution works great in production.</p>
<h2 id="distributed-memcached-caching">Distributed Memcached Caching</h2>
<p>Here is a simple example demonstrating a distributed memcached caching mechanism built atop this module. Suppose we do have three different memcached nodes and we use simple modulo to hash our keys.</p>
<p><div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">upstream</span><span class="w"> </span><span class="s">moon</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="kn">server</span><span class="w"> </span><span class="n">10.62.136.54</span><span class="p">:</span><span class="mi">11211</span><span class="p">;</span>
<span class="w">         </span><span class="kn">server</span><span class="w"> </span><span class="s">unix:/tmp/memcached.sock</span><span class="w"> </span><span class="s">backup</span><span class="p">;</span>
<span class="w">     </span><span class="p">}</span>

<span class="w">     </span><span class="kn">upstream</span><span class="w"> </span><span class="s">earth</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="kn">server</span><span class="w"> </span><span class="n">10.62.136.55</span><span class="p">:</span><span class="mi">11211</span><span class="p">;</span>
<span class="w">     </span><span class="p">}</span>

<span class="w">     </span><span class="kn">upstream</span><span class="w"> </span><span class="s">sun</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="kn">server</span><span class="w"> </span><span class="n">10.62.136.56</span><span class="p">:</span><span class="mi">11211</span><span class="p">;</span>
<span class="w">     </span><span class="p">}</span>

<span class="w">     </span><span class="kn">upstream_list</span><span class="w"> </span><span class="s">universe</span><span class="w"> </span><span class="s">moon</span><span class="w"> </span><span class="s">earth</span><span class="w"> </span><span class="s">sun</span><span class="p">;</span>

<span class="w">     </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="kn">memc_connect_timeout</span><span class="w"> </span><span class="s">100ms</span><span class="p">;</span>
<span class="w">         </span><span class="kn">memc_send_timeout</span><span class="w"> </span><span class="s">100ms</span><span class="p">;</span>
<span class="w">         </span><span class="kn">memc_read_timeout</span><span class="w"> </span><span class="s">100ms</span><span class="p">;</span>

<span class="w">         </span><span class="kn">location</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">/memc</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="kn">internal</span><span class="p">;</span>

<span class="w">             </span><span class="kn">set</span><span class="w"> </span><span class="nv">$memc_key</span><span class="w"> </span><span class="nv">$query_string</span><span class="p">;</span>
<span class="w">             </span><span class="kn">set_hashed_upstream</span><span class="w"> </span><span class="nv">$backend</span><span class="w"> </span><span class="s">universe</span><span class="w"> </span><span class="nv">$memc_key</span><span class="p">;</span>
<span class="w">             </span><span class="kn">set</span><span class="w"> </span><span class="nv">$memc_exptime</span><span class="w"> </span><span class="mi">3600</span><span class="p">;</span><span class="w"> </span><span class="c1"># in seconds</span>
<span class="w">             </span><span class="kn">memc_pass</span><span class="w"> </span><span class="nv">$backend</span><span class="p">;</span>
<span class="w">         </span><span class="p">}</span>

<span class="w">         </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="kn">set</span><span class="w"> </span><span class="nv">$key</span><span class="w"> </span><span class="nv">$uri</span><span class="p">;</span>
<span class="w">             </span><span class="kn">srcache_fetch</span><span class="w"> </span><span class="s">GET</span><span class="w"> </span><span class="s">/memc</span><span class="w"> </span><span class="nv">$key</span><span class="p">;</span>
<span class="w">             </span><span class="kn">srcache_store</span><span class="w"> </span><span class="s">PUT</span><span class="w"> </span><span class="s">/memc</span><span class="w"> </span><span class="nv">$key</span><span class="p">;</span>

<span class="w">             </span><span class="c1"># proxy_pass/fastcgi_pass/content_by_lua/drizzle_pass/...</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">     </span><span class="p">}</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
Here's what is going on in the sample above:
1. We first define three upstreams, <code>moon</code>, <code>earth</code>, and <code>sun</code>. These are our three memcached servers.
1. And then we group them together as an upstream list entity named <code>universe</code> with the <code>upstream_list</code> directive provided by <a href="https://github.com/openresty/set-misc-nginx-module">set-misc-nginx-module</a>.
1. After that, we define an internal location named <code>/memc</code> for talking to the memcached cluster.
1. In this <code>/memc</code> location, we first set the <code>$memc_key</code> variable with the query string (<code>$args</code>), and then use the <a href="https://github.com/openresty/set-misc-nginx-module#set_hashed_upstream">set_hashed_upstream</a> directive to hash our <a href="https://github.com/openresty/memc-nginx-module#memc_key">$memc_key</a> over the upsteam list <code>universe</code>, so as to obtain a concrete upstream name to be assigned to the variable <code>$backend</code>.
1. We pass this <code>$backend</code> variable into the <a href="https://github.com/openresty/memc-nginx-module#memc_pass">memc_pass</a> directive. The <code>$backend</code> variable can hold a value among <code>moon</code>, <code>earth</code>, and <code>sun</code>.
1. Also, we define the memcached caching expiration time to be 3600 seconds (i.e., an hour) by overriding the <a href="https://github.com/openresty/memc-nginx-module#memc_exptime">$memc_exptime</a> variable.
1. In our main public location <code>/</code>, we configure the <code>$uri</code> variable as our cache key, and then configure <a href="#srcache_fetch">srcache_fetch</a> for cache lookups and <a href="#srcache_store">srcache_store</a> for cache updates. We're using two subrequests to our <code>/memc</code> location defined earlier in these two directives.</p>
<p>One can use <a href="https://github.com/openresty/lua-nginx-module">lua-nginx-module</a>'s <a href="https://github.com/openresty/lua-nginx-module#set_by_lua">set_by_lua</a> or <a href="https://github.com/openresty/lua-nginx-module#rewrite_by_lua">rewrite_by_lua</a> directives to inject custom Lua code to compute the <code>$backend</code> and/or <code>$key</code> variables in the sample above.</p>
<p>One thing that should be taken care of is that memcached does have restriction on key lengths, i.e., 250 bytes, so for keys that may be very long, one could use the <a href="https://github.com/openresty/set-misc-nginx-module#set_md5">set_md5</a> directive or its friends to pre-hash the key to a fixed-length digest before assigning it to <code>$memc_key</code> in the <code>/memc</code> location or the like.</p>
<p>Further, one can utilize the <a href="#srcache_fetch_skip">srcache_fetch_skip</a> and <a href="#srcache_store_skip">srcache_store_skip</a> directives to control what to cache and what not on a per-request basis, and Lua can also be used here in a similar way. So the possibility is really unlimited.</p>
<p>To maximize speed, we often enable TCP (or Unix Domain Socket) connection pool for our memcached upstreams provided by <a href="http://wiki.nginx.org/HttpUpstreamKeepaliveModule">HttpUpstreamKeepaliveModule</a>, for example,</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">upstream</span><span class="w"> </span><span class="s">moon</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">server</span><span class="w"> </span><span class="n">10.62.136.54</span><span class="p">:</span><span class="mi">11211</span><span class="p">;</span>
<span class="w">     </span><span class="kn">server</span><span class="w"> </span><span class="s">unix:/tmp/memcached.sock</span><span class="w"> </span><span class="s">backup</span><span class="p">;</span>
<span class="w">     </span><span class="kn">keepalive</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>where we define a connection pool which holds up to 10 keep-alive connections (per nginx worker process) for our <code>moon</code> upstream (cluster).</p>
<h2 id="caching-with-redis">Caching with Redis</h2>
<p>Redis is an alternative key-value store with many additional features.</p>
<p>Here is a working example using the lua-resty-redis module:</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="k">location</span><span class="w"> </span><span class="p">~</span><span class="w"> </span><span class="sr">&#39;\.php$|^/update.php&#39;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># cache setup</span>
<span class="w">    </span><span class="kn">set</span><span class="w"> </span><span class="nv">$key</span><span class="w"> </span><span class="nv">$request_uri</span><span class="p">;</span>
<span class="w">    </span><span class="kn">try_files</span><span class="w"> </span><span class="nv">$uri</span><span class="w"> </span><span class="p">=</span><span class="mi">404</span><span class="p">;</span>

<span class="w">    </span><span class="kn">srcache_fetch_skip</span><span class="w"> </span><span class="nv">$skip_cache</span><span class="p">;</span>
<span class="w">    </span><span class="kn">srcache_store_skip</span><span class="w"> </span><span class="nv">$skip_cache</span><span class="p">;</span>

<span class="w">    </span><span class="kn">srcache_response_cache_control</span><span class="w"> </span><span class="no">off</span><span class="p">;</span>
<span class="w">    </span><span class="kn">srcache_store_statuses</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="mi">201</span><span class="w"> </span><span class="mi">301</span><span class="w"> </span><span class="mi">302</span><span class="w"> </span><span class="mi">307</span><span class="w"> </span><span class="mi">308</span><span class="w"> </span><span class="mi">404</span><span class="w"> </span><span class="mi">503</span><span class="p">;</span>

<span class="w">    </span><span class="kn">set_escape_uri</span><span class="w"> </span><span class="nv">$escaped_key</span><span class="w"> </span><span class="nv">$key</span><span class="p">;</span>

<span class="w">    </span><span class="kn">srcache_fetch</span><span class="w"> </span><span class="s">GET</span><span class="w"> </span><span class="s">/redis-fetch</span><span class="w"> </span><span class="nv">$key</span><span class="p">;</span>
<span class="w">    </span><span class="kn">srcache_store</span><span class="w"> </span><span class="s">PUT</span><span class="w"> </span><span class="s">/redis-store</span><span class="w"> </span><span class="s">key=</span><span class="nv">$escaped_key</span><span class="p">;</span>

<span class="w">    </span><span class="kn">more_set_headers</span><span class="w"> </span><span class="s">&#39;X-Cache-Fetch-Status</span><span class="w"> </span><span class="nv">$srcache_fetch_status&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="kn">more_set_headers</span><span class="w"> </span><span class="s">&#39;X-Cache-Store-Status</span><span class="w"> </span><span class="nv">$srcache_store_status&#39;</span><span class="p">;</span>

<span class="w">    </span><span class="kn">fastcgi_split_path_info</span><span class="w"> </span><span class="s">^(.+?\.php)(|/.*)</span>$<span class="p">;</span>
<span class="w">    </span><span class="c1"># Security note: If you&#39;re running a version of PHP older than the</span>
<span class="w">    </span><span class="c1"># latest 5.3, you should have &quot;cgi.fix_pathinfo = 0;&quot; in php.ini.</span>
<span class="w">    </span><span class="c1"># See http://serverfault.com/q/627903/94922 for details.</span>
<span class="w">    </span><span class="kn">include</span><span class="w"> </span><span class="s">fastcgi_params</span><span class="p">;</span>
<span class="w">    </span><span class="c1"># Block httproxy attacks. See https://httpoxy.org/.</span>
<span class="w">    </span><span class="kn">fastcgi_param</span><span class="w"> </span><span class="s">HTTP_PROXY</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="kn">fastcgi_param</span><span class="w"> </span><span class="s">SCRIPT_FILENAME</span><span class="w"> </span><span class="s">/var/www/html/</span><span class="nv">$fastcgi_script_name</span><span class="p">;</span>
<span class="w">    </span><span class="kn">fastcgi_param</span><span class="w"> </span><span class="s">PATH_INFO</span><span class="w"> </span><span class="nv">$fastcgi_path_info</span><span class="p">;</span>
<span class="w">    </span><span class="kn">fastcgi_param</span><span class="w"> </span><span class="s">QUERY_STRING</span><span class="w"> </span><span class="nv">$query_string</span><span class="p">;</span>
<span class="w">    </span><span class="kn">fastcgi_intercept_errors</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>

<span class="w">    </span><span class="kn">fastcgi_pass</span><span class="w"> </span><span class="s">upstream-name</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">location</span><span class="w"> </span><span class="s">/redis-fetch</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">internal</span><span class="p">;</span>

<span class="w">    </span><span class="kn">resolver</span><span class="w"> </span><span class="mi">8</span><span class="s">.8.8.8</span><span class="w"> </span><span class="s">valid=300s</span><span class="p">;</span>
<span class="w">    </span><span class="kn">resolver_timeout</span><span class="w"> </span><span class="s">10s</span><span class="p">;</span>

<span class="w">    </span><span class="kn">content_by_lua_block</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kn">local</span><span class="w"> </span><span class="s">key</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">assert(ngx.var.request_uri,</span><span class="w"> </span><span class="s">&quot;no</span><span class="w"> </span><span class="s">key</span><span class="w"> </span><span class="s">found&quot;)</span>
<span class="w">      </span><span class="s">local</span><span class="w"> </span><span class="s">redis</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">require</span><span class="w"> </span><span class="s">&quot;resty.redis&quot;</span>
<span class="w">      </span><span class="s">local</span><span class="w"> </span><span class="s">red,</span><span class="w"> </span><span class="s">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">redis:new()</span>
<span class="w">      </span><span class="s">if</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">red</span><span class="w"> </span><span class="s">then</span>
<span class="w">        </span><span class="s">ngx.log(ngx.ERR,</span><span class="w"> </span><span class="s">&quot;Failed</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">create</span><span class="w"> </span><span class="s">redis</span><span class="w"> </span><span class="s">variable,</span><span class="w"> </span><span class="s">error</span><span class="w"> </span><span class="s">-&gt;</span><span class="w"> </span><span class="s">&quot;,</span><span class="w"> </span><span class="s">err)</span>
<span class="w">        </span><span class="s">ngx.exit(500)</span>
<span class="w">      </span><span class="s">end</span>
<span class="w">      </span><span class="s">assert(red:connect(&quot;redis-master.default.svc.cluster.local&quot;,</span><span class="w"> </span><span class="mi">6379</span><span class="s">))</span>
<span class="w">      </span><span class="s">if</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">red</span><span class="w"> </span><span class="s">then</span>
<span class="w">        </span><span class="s">ngx.log(ngx.ERR,</span><span class="w"> </span><span class="s">&quot;Failed</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">connect</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">redis,</span><span class="w"> </span><span class="s">error</span><span class="w"> </span><span class="s">-&gt;</span><span class="w"> </span><span class="s">&quot;,</span><span class="w"> </span><span class="s">err)</span>
<span class="w">        </span><span class="s">ngx.exit(500)</span>
<span class="w">      </span><span class="s">end</span>
<span class="w">      </span><span class="s">local</span><span class="w"> </span><span class="s">res,</span><span class="w"> </span><span class="s">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">red:auth(&quot;redispassword&quot;)</span>
<span class="w">      </span><span class="s">if</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">res</span><span class="w"> </span><span class="s">then</span>
<span class="w">        </span><span class="s">ngx.say(&quot;failed</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">authenticate,</span><span class="w"> </span><span class="s">&quot;,</span><span class="w"> </span><span class="s">err)</span>
<span class="w">        </span><span class="s">ngx.exit(500)</span>
<span class="w">      </span><span class="s">end</span>
<span class="w">      </span><span class="s">local</span><span class="w"> </span><span class="s">data</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">assert(red:get(key))</span>
<span class="w">      </span><span class="s">assert(red:set_keepalive(10000,</span><span class="w"> </span><span class="mi">100</span><span class="s">))</span>
<span class="w">      </span><span class="s">if</span><span class="w"> </span><span class="s">res</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">ngx.null</span><span class="w"> </span><span class="s">then</span>
<span class="w">        </span><span class="s">return</span><span class="w"> </span><span class="s">ngx.exit(404)</span>
<span class="w">      </span><span class="s">end</span>
<span class="w">      </span><span class="s">ngx.print(data)</span>
<span class="w">    </span><span class="err">}</span>
<span class="w">  </span><span class="err">}</span>

<span class="w">  </span><span class="s">location</span><span class="w"> </span><span class="s">/redis-store</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">internal</span><span class="p">;</span>

<span class="w">    </span><span class="kn">resolver</span><span class="w"> </span><span class="mi">8</span><span class="s">.8.8.8</span><span class="w"> </span><span class="s">valid=300s</span><span class="p">;</span>
<span class="w">    </span><span class="kn">resolver_timeout</span><span class="w"> </span><span class="s">10s</span><span class="p">;</span>

<span class="w">    </span><span class="kn">content_by_lua_block</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kn">local</span><span class="w"> </span><span class="s">value</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">assert(ngx.req.get_body_data(),</span><span class="w"> </span><span class="s">&quot;no</span><span class="w"> </span><span class="s">value</span><span class="w"> </span><span class="s">found&quot;)</span>
<span class="w">      </span><span class="s">local</span><span class="w"> </span><span class="s">key</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">assert(ngx.var.request_uri,</span><span class="w"> </span><span class="s">&quot;no</span><span class="w"> </span><span class="s">key</span><span class="w"> </span><span class="s">found&quot;)</span>
<span class="w">      </span><span class="s">local</span><span class="w"> </span><span class="s">redis</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">require</span><span class="w"> </span><span class="s">&quot;resty.redis&quot;</span>
<span class="w">      </span><span class="s">local</span><span class="w"> </span><span class="s">red,</span><span class="w"> </span><span class="s">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">redis:new()</span>
<span class="w">      </span><span class="s">if</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">red</span><span class="w"> </span><span class="s">then</span>
<span class="w">        </span><span class="s">ngx.log(ngx.ERR,</span><span class="w"> </span><span class="s">&quot;Failed</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">create</span><span class="w"> </span><span class="s">redis</span><span class="w"> </span><span class="s">variable,</span><span class="w"> </span><span class="s">error</span><span class="w"> </span><span class="s">-&gt;</span><span class="w"> </span><span class="s">&quot;,</span><span class="w"> </span><span class="s">err)</span>
<span class="w">        </span><span class="s">ngx.exit(500)</span>
<span class="w">      </span><span class="s">end</span>
<span class="w">      </span><span class="s">assert(red:connect(&quot;redis-master.default.svc.cluster.local&quot;,</span><span class="w"> </span><span class="mi">6379</span><span class="s">))</span>
<span class="w">      </span><span class="s">if</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">red</span><span class="w"> </span><span class="s">then</span>
<span class="w">        </span><span class="s">ngx.log(ngx.ERR,</span><span class="w"> </span><span class="s">&quot;Failed</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">connect</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">redis,</span><span class="w"> </span><span class="s">error</span><span class="w"> </span><span class="s">-&gt;</span><span class="w"> </span><span class="s">&quot;,</span><span class="w"> </span><span class="s">err)</span>
<span class="w">        </span><span class="s">ngx.exit(500)</span>
<span class="w">      </span><span class="s">end</span>
<span class="w">      </span><span class="s">local</span><span class="w"> </span><span class="s">res,</span><span class="w"> </span><span class="s">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">red:auth(&quot;redispassword&quot;)</span>
<span class="w">      </span><span class="s">if</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">res</span><span class="w"> </span><span class="s">then</span>
<span class="w">        </span><span class="s">ngx.say(&quot;failed</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">authenticate,</span><span class="w"> </span><span class="s">&quot;,</span><span class="w"> </span><span class="s">err)</span>
<span class="w">        </span><span class="s">ngx.exit(500)</span>
<span class="w">      </span><span class="s">end</span>
<span class="w">      </span><span class="s">local</span><span class="w"> </span><span class="s">data</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">assert(red:set(key,</span><span class="w"> </span><span class="s">value))</span>
<span class="w">      </span><span class="s">assert(red:set_keepalive(10000,</span><span class="w"> </span><span class="mi">100</span><span class="s">))</span>
<span class="w">      </span><span class="s">if</span><span class="w"> </span><span class="s">res</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">ngx.null</span><span class="w"> </span><span class="s">then</span>
<span class="w">        </span><span class="s">return</span><span class="w"> </span><span class="s">ngx.exit(404)</span>
<span class="w">      </span><span class="s">end</span>
<span class="w">    </span><span class="err">}</span>
<span class="w">  </span><span class="err">}</span>
</code></pre></div>
<p>Here is a working example by using the HTTPRedis (fetch) and Redis2 (store) modules:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/api</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">default_type</span><span class="w"> </span><span class="s">text/css</span><span class="p">;</span>

<span class="w">     </span><span class="kn">set</span><span class="w"> </span><span class="nv">$key</span><span class="w"> </span><span class="nv">$uri</span><span class="p">;</span>
<span class="w">     </span><span class="kn">set_escape_uri</span><span class="w"> </span><span class="nv">$escaped_key</span><span class="w"> </span><span class="nv">$key</span><span class="p">;</span>

<span class="w">     </span><span class="kn">srcache_fetch</span><span class="w"> </span><span class="s">GET</span><span class="w"> </span><span class="s">/redis</span><span class="w"> </span><span class="nv">$key</span><span class="p">;</span>
<span class="w">     </span><span class="kn">srcache_store</span><span class="w"> </span><span class="s">PUT</span><span class="w"> </span><span class="s">/redis2</span><span class="w"> </span><span class="s">key=</span><span class="nv">$escaped_key&amp;exptime=120</span><span class="p">;</span>

<span class="w">     </span><span class="c1"># fastcgi_pass/proxy_pass/drizzle_pass/postgres_pass/echo/etc</span>
<span class="w"> </span><span class="p">}</span>

<span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">/redis</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">internal</span><span class="p">;</span>

<span class="w">     </span><span class="kn">set_md5</span><span class="w"> </span><span class="nv">$redis_key</span><span class="w"> </span><span class="nv">$args</span><span class="p">;</span>
<span class="w">     </span><span class="kn">redis_pass</span><span class="w"> </span><span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">6379</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>

<span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">/redis2</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">internal</span><span class="p">;</span>

<span class="w">     </span><span class="kn">set_unescape_uri</span><span class="w"> </span><span class="nv">$exptime</span><span class="w"> </span><span class="nv">$arg_exptime</span><span class="p">;</span>
<span class="w">     </span><span class="kn">set_unescape_uri</span><span class="w"> </span><span class="nv">$key</span><span class="w"> </span><span class="nv">$arg_key</span><span class="p">;</span>
<span class="w">     </span><span class="kn">set_md5</span><span class="w"> </span><span class="nv">$key</span><span class="p">;</span>

<span class="w">     </span><span class="kn">redis2_query</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="nv">$key</span><span class="w"> </span><span class="nv">$echo_request_body</span><span class="p">;</span>
<span class="w">     </span><span class="kn">redis2_query</span><span class="w"> </span><span class="s">expire</span><span class="w"> </span><span class="nv">$key</span><span class="w"> </span><span class="nv">$exptime</span><span class="p">;</span>
<span class="w">     </span><span class="kn">redis2_pass</span><span class="w"> </span><span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">6379</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>This example makes use of the <a href="https://github.com/openresty/echo-nginx-module#echo_request_body">$echo_request_body</a> variable provided by <a href="https://github.com/openresty/echo-nginx-module">echo-nginx-module</a>. Note that you need the latest version of <a href="https://github.com/openresty/echo-nginx-module">echo-nginx-module</a>, <code>v0.38rc2</code> because earlier versions may not work reliably.</p>
<p>Also, you need both <a href="http://wiki.nginx.org/HttpRedisModule">HttpRedisModule</a> and <a href="https://github.com/openresty/redis2-nginx-module">redis2-nginx-module</a>. The former is used in the <a href="#srcache_fetch">srcache_fetch</a> subrequest and the latter is used in the <a href="#srcache_store">srcache_store</a> subrequest.</p>
<p>The Nginx core also has a bug that could prevent <a href="https://github.com/openresty/redis2-nginx-module">redis2-nginx-module</a>'s pipelining support from working properly in certain extreme conditions. And the following patch fixes this:</p>
<p><a href="http://mailman.nginx.org/pipermail/nginx-devel/2012-March/002040.html">http://mailman.nginx.org/pipermail/nginx-devel/2012-March/002040.html</a></p>
<p>Note that, however, if you are using the <a href="http://openresty.org/">OpenResty</a> 1.0.15.3 bundle or later, then you already have everything that you need here in the bundle.</p>
<h2 id="cache-key-preprocessing">Cache Key Preprocessing</h2>
<p>It is often desired to preprocess the cache key to exclude random noises that may hurt the cache hit rate. For example, random session IDs in the URI arguments are usually desired to get removed.</p>
<p>Consider the following URI querystring</p>
<div class="highlight"><pre><span></span><code>SID=BC3781C3-2E02-4A11-89CF-34E5CFE8B0EF&amp;UID=44332&amp;L=EN&amp;M=1&amp;H=1&amp;UNC=0&amp;SRC=LK&amp;RT=62
</code></pre></div>
<p>we want to remove the <code>SID</code> and <code>UID</code> arguments from it. It is easy to achieve if you use <a href="https://github.com/openresty/lua-nginx-module">lua-nginx-module</a> at the same time:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">/t</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">rewrite_by_lua</span><span class="w"> </span><span class="s">&#39;</span>
<span class="w">         </span><span class="s">local</span><span class="w"> </span><span class="s">args</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">ngx.req.get_uri_args()</span>
<span class="w">         </span><span class="s">args.SID</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">nil</span>
<span class="w">         </span><span class="s">args.UID</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">nil</span>
<span class="w">         </span><span class="s">ngx.req.set_uri_args(args)</span>
<span class="w">     </span><span class="s">&#39;</span><span class="p">;</span>

<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="nv">$args</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>Here we use the <a href="https://github.com/openresty/echo-nginx-module#echo">echo</a> directive from <a href="https://github.com/openresty/echo-nginx-module">echo-nginx-module</a> to dump out
the final value of <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_args">$args</a> in the end. You can replace it with your
<a href="https://github.com/openresty/srcache-nginx-module">srcache-nginx-module</a> configurations and upstream configurations instead for
your case. Let's test this /t interface with curl:</p>
<div class="highlight"><pre><span></span><code>$ curl &#39;localhost:8081/t?RT=62&amp;SID=BC3781C3-2E02-4A11-89CF-34E5CFE8B0EF&amp;UID=44332&amp;L=EN&amp;M=1&amp;H=1&amp;UNC=0&amp;SRC=LK&#39;
M=1&amp;UNC=0&amp;RT=62&amp;H=1&amp;L=EN&amp;SRC=LK
</code></pre></div>
<p>It is worth mentioning that, if you want to retain the order of the URI
arguments, then you can do string substitutions on the value of <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_args">$args</a>
directly, for example,</p>
<div class="highlight"><pre><span></span><code>location = /t {
    rewrite_by_lua &#39;
        local args = ngx.var.args
        newargs, n, err = ngx.re.gsub(args, [[\b[SU]ID=[^&amp;]*&amp;?]], &quot;&quot;, &quot;jo&quot;)
        if n and n &gt; 0 then
            ngx.var.args = newargs
        end
    &#39;;

    echo $args;
}
</code></pre></div>
<p>Now test it with the original curl command again, we get exactly what
we would expect:</p>
<div class="highlight"><pre><span></span><code>RT=62&amp;L=EN&amp;M=1&amp;H=1&amp;UNC=0&amp;SRC=LK
</code></pre></div>
<p>But for caching purposes, it's good to normalize the URI argument
order so that you can increase the cache hit rate. And the hash table
entry order used by LuaJIT or Lua can be used to normalize the order
as a nice side effect.</p>
<h2 id="directives">Directives</h2>
<h2 id="srcache_fetch">srcache_fetch</h2>
<p><strong>syntax:</strong> <em>srcache_fetch &lt;method&gt; &lt;uri&gt; &lt;args&gt;?</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>http, server, location, location if</em></p>
<p><strong>phase:</strong> <em>post-access</em></p>
<p>This directive registers an access phase handler that will issue an Nginx subrequest to lookup the cache.</p>
<p>When the subrequest returns status code other than <code>200</code>, than a cache miss is signaled and the control flow will continue to the later phases including the content phase configured by <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html">ngx_http_proxy_module</a>, <a href="http://nginx.org/en/docs/http/ngx_http_fastcgi_module.html">ngx_http_fastcgi_module</a>, and others. If the subrequest returns <code>200 OK</code>, then a cache hit is signaled and this module will send the subrequest's response as the current main request's response to the client directly.</p>
<p>This directive will always run at the end of the access phase, such that <a href="http://nginx.org/en/docs/http/ngx_http_access_module.html">ngx_http_access_module</a>'s <a href="http://nginx.org/en/docs/http/ngx_http_access_module.html#allow">allow</a> and <a href="http://nginx.org/en/docs/http/ngx_http_access_module.html#deny">deny</a> will always run <em>before</em> this.</p>
<p>You can use the <a href="#srcache_fetch_skip">srcache_fetch_skip</a> directive to disable cache look-up selectively.</p>
<h2 id="srcache_fetch_skip">srcache_fetch_skip</h2>
<p><strong>syntax:</strong> <em>srcache_fetch_skip &lt;flag&gt;</em></p>
<p><strong>default:</strong> <em>srcache_fetch_skip 0</em></p>
<p><strong>context:</strong> <em>http, server, location, location if</em></p>
<p><strong>phase:</strong> <em>post-access</em></p>
<p>The <code>&lt;flag&gt;</code> argument supports nginx variables. When this argument's value is not empty <em>and</em> not equal to <code>0</code>, then the fetching process will be unconditionally skipped.</p>
<p>For example, to skip caching requests which have a cookie named <code>foo</code> with the value <code>bar</code>, we can write</p>
<p><div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">set</span><span class="w"> </span><span class="nv">$key</span><span class="w"> </span><span class="s">...</span><span class="p">;</span>
<span class="w">     </span><span class="kn">set_by_lua</span><span class="w"> </span><span class="nv">$skip</span><span class="w"> </span><span class="s">&#39;</span>
<span class="w">         </span><span class="s">if</span><span class="w"> </span><span class="s">ngx.var.cookie_foo</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;bar&quot;</span><span class="w"> </span><span class="s">then</span>
<span class="w">             </span><span class="s">return</span><span class="w"> </span><span class="mi">1</span>
<span class="w">         </span><span class="s">end</span>
<span class="w">         </span><span class="s">return</span><span class="w"> </span><span class="mi">0</span>
<span class="w">     </span><span class="s">&#39;</span><span class="p">;</span>

<span class="w">     </span><span class="kn">srcache_fetch_skip</span><span class="w"> </span><span class="nv">$skip</span><span class="p">;</span>
<span class="w">     </span><span class="kn">srcache_store_skip</span><span class="w"> </span><span class="nv">$skip</span><span class="p">;</span>

<span class="w">     </span><span class="kn">srcache_fetch</span><span class="w"> </span><span class="s">GET</span><span class="w"> </span><span class="s">/memc</span><span class="w"> </span><span class="nv">$key</span><span class="p">;</span>
<span class="w">     </span><span class="kn">srcache_store</span><span class="w"> </span><span class="s">GET</span><span class="w"> </span><span class="s">/memc</span><span class="w"> </span><span class="nv">$key</span><span class="p">;</span>

<span class="w">     </span><span class="c1"># proxy_pass/fastcgi_pass/content_by_lua/...</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
where <a href="https://github.com/openresty/lua-nginx-module">lua-nginx-module</a> is used to calculate the value of the <code>$skip</code> variable at the (earlier) rewrite phase. Similarly, the <code>$key</code> variable can be computed by Lua using the <a href="https://github.com/openresty/lua-nginx-module#set_by_lua">set_by_lua</a> or <a href="https://github.com/openresty/lua-nginx-module#rewrite_by_lua">rewrite_by_lua</a> directive too.</p>
<p>The standard <a href="http://nginx.org/en/docs/http/ngx_http_map_module.html#map">map</a> directive can also be used to compute the value of the <code>$skip</code> variable used in the sample above:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="nv">$cookie_foo</span><span class="w"> </span><span class="nv">$skip</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">default</span><span class="w">     </span><span class="mi">0</span><span class="p">;</span>
<span class="w">     </span><span class="kn">bar</span><span class="w">         </span><span class="mi">1</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>but your <a href="http://nginx.org/en/docs/http/ngx_http_map_module.html#map">map</a> statement should be put into the <code>http</code> config block in your <code>nginx.conf</code> file though.</p>
<h2 id="srcache_store">srcache_store</h2>
<p><strong>syntax:</strong> <em>srcache_store &lt;method&gt; &lt;uri&gt; &lt;args&gt;?</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>http, server, location, location if</em></p>
<p><strong>phase:</strong> <em>output-filter</em></p>
<p>This directive registers an output filter handler that will issue an Nginx subrequest to save the response of the current main request into a cache backend. The status code of the subrequest will be ignored.</p>
<p>You can use the <a href="#srcache_store_skip">srcache_store_skip</a> and <a href="#srcache_store_max_size">srcache_store_max_size</a> directives to disable caching for certain requests in case of a cache miss.</p>
<p>Since the <code>v0.12rc7</code> release, both the response status line, response headers, and response bodies will be put into the cache. By default, the following special response headers will not be cached:</p>
<ul>
<li>Connection</li>
<li>Keep-Alive</li>
<li>Proxy-Authenticate</li>
<li>Proxy-Authorization</li>
<li>TE</li>
<li>Trailers</li>
<li>Transfer-Encoding</li>
<li>Upgrade</li>
<li>Set-Cookie</li>
</ul>
<p>You can use the <a href="#srcache_store_pass_header">srcache_store_pass_header</a> and/or <a href="#srcache_store_hide_header">srcache_store_hide_header</a> directives to control what headers to cache and what not.</p>
<p>The original response's data chunks get emitted as soon as
they arrive. <code>srcache_store</code> just copies and collects the data in an output filter without postponing them from being sent downstream.</p>
<p>But please note that even though all the response data will be sent immediately, the current Nginx request lifetime will not finish until the srcache_store subrequest completes. That means a delay in closing the TCP connection on the server side (when <abbr title="Hyper Text Transfer Protocol">HTTP</abbr> keepalive is disabled, but proper <abbr title="Hyper Text Transfer Protocol">HTTP</abbr> clients should close the connection actively on the client side, which adds no extra delay or other issues at all) or serving the next request sent on the same TCP connection (when <abbr title="Hyper Text Transfer Protocol">HTTP</abbr> keepalive is in action).</p>
<h2 id="srcache_store_max_size">srcache_store_max_size</h2>
<p><strong>syntax:</strong> <em>srcache_store_max_size &lt;size&gt;</em></p>
<p><strong>default:</strong> <em>srcache_store_max_size 0</em></p>
<p><strong>context:</strong> <em>http, server, location, location if</em></p>
<p><strong>phase:</strong> <em>output-header-filter</em></p>
<p>When the response body length is exceeding this size, this module will not try to store the response body into the cache using the subrequest template that is specified in <a href="#srcache_store">srcache_store</a>.</p>
<p>This is particular useful when using a cache storage backend that does have a hard upper limit on the input data. For example, the Memcached server has a default limit of <code>1 MB</code> by item.</p>
<p>When <code>0</code> is specified (the default value), there's no limit check at all.</p>
<h2 id="srcache_store_skip">srcache_store_skip</h2>
<p><strong>syntax:</strong> <em>srcache_store_skip &lt;flag&gt;</em></p>
<p><strong>default:</strong> <em>srcache_store_skip 0</em></p>
<p><strong>context:</strong> <em>http, server, location, location if</em></p>
<p><strong>phase:</strong> <em>output-header-filter</em></p>
<p>The <code>&lt;flag&gt;</code> argument supports Nginx variables. When this argument's value is not empty <em>and</em> not equal to <code>0</code>, then the storing process will be unconditionally skipped.</p>
<p>Starting from the <code>v0.25</code> release, the <code>&lt;flag&gt;</code> expression (possibly containing Nginx variables) can be evaluated up to twice: the first time is right after the response header is being sent and when the <code>&lt;flag&gt;</code> expression is not evaluated to true values it will be evaluated again right after the end of the response body data stream is seen. Before <code>v0.25</code>, only the first time evaluation is performed.</p>
<p>Here's an example using Lua to set $nocache to avoid storing URIs that contain the string "/tmp":</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">set_by_lua</span><span class="w"> </span><span class="nv">$nocache</span><span class="w"> </span><span class="s">&#39;</span>
<span class="w">     </span><span class="s">if</span><span class="w"> </span><span class="s">string.match(ngx.var.uri,</span><span class="w"> </span><span class="s">&quot;/tmp&quot;)</span><span class="w"> </span><span class="s">then</span>
<span class="w">         </span><span class="s">return</span><span class="w"> </span><span class="mi">1</span>
<span class="w">     </span><span class="s">end</span>
<span class="w">     </span><span class="s">return</span><span class="w"> </span><span class="mi">0</span><span class="s">&#39;</span><span class="p">;</span>

<span class="w"> </span><span class="k">srcache_store_skip</span><span class="w"> </span><span class="nv">$nocache</span><span class="p">;</span>
</code></pre></div>
<h2 id="srcache_store_statuses">srcache_store_statuses</h2>
<p><strong>syntax:</strong> <em>srcache_store_statuses &lt;status1&gt; &lt;status2&gt; ..</em></p>
<p><strong>default:</strong> <em>srcache_store_statuses 200 301 302 307 308</em></p>
<p><strong>context:</strong> <em>http, server, location, location if</em></p>
<p><strong>phase:</strong> <em>output-header-filter</em></p>
<p>This directive controls what responses to store to the cache according to their status code.</p>
<p>By default, only <code>200</code>, <code>301</code>, <code>302</code>, <code>307</code> and <code>308</code> responses will be stored to cache and any other responses will skip <a href="#srcache_store">srcache_store</a>.</p>
<p>You can specify arbitrary positive numbers for the response status code that you'd like to cache, even including error code like <code>404</code> and <code>503</code>. For example:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">srcache_store_statuses</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="mi">201</span><span class="w"> </span><span class="mi">301</span><span class="w"> </span><span class="mi">302</span><span class="w"> </span><span class="mi">307</span><span class="w"> </span><span class="mi">308</span><span class="w"> </span><span class="mi">404</span><span class="w"> </span><span class="mi">503</span><span class="p">;</span>
</code></pre></div>
<p>At least one argument should be given to this directive.</p>
<p>This directive was first introduced in the <code>v0.13rc2</code> release.</p>
<h2 id="srcache_store_ranges">srcache_store_ranges</h2>
<p><strong>syntax:</strong> <em>srcache_store_ranges on|off</em></p>
<p><strong>default:</strong> <em>srcache_store_ranges off</em></p>
<p><strong>context:</strong> <em>http, server, location, location if</em></p>
<p><strong>phase:</strong> <em>output-body-filter</em></p>
<p>When this directive is turned on (default to <code>off</code>), <a href="#srcache_store">srcache_store</a> will also store 206 Partial Content responses generated by the standard <code>ngx_http_range_filter_module</code>. If you turn this directive on, you MUST add <code>$http_range</code> to your cache keys. For example,</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">set</span><span class="w"> </span><span class="nv">$key</span><span class="w"> </span><span class="s">&quot;</span><span class="nv">$uri$args$http_range&quot;</span><span class="p">;</span>
<span class="w">     </span><span class="kn">srcache_fetch</span><span class="w"> </span><span class="s">GET</span><span class="w"> </span><span class="s">/memc</span><span class="w"> </span><span class="nv">$key</span><span class="p">;</span>
<span class="w">     </span><span class="kn">srcache_store</span><span class="w"> </span><span class="s">PUT</span><span class="w"> </span><span class="s">/memc</span><span class="w"> </span><span class="nv">$key</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>This directive was first introduced in the <code>v0.27</code> release.</p>
<h2 id="srcache_header_buffer_size">srcache_header_buffer_size</h2>
<p><strong>syntax:</strong> <em>srcache_header_buffer_size &lt;size&gt;</em></p>
<p><strong>default:</strong> <em>srcache_header_buffer_size 4k/8k</em></p>
<p><strong>context:</strong> <em>http, server, location, location if</em></p>
<p><strong>phase:</strong> <em>output-header-filter</em></p>
<p>This directive controles the header buffer when serializing response headers for <a href="#srcache_store">srcache_store</a>. The default size is the page size, usually <code>4k</code> or <code>8k</code> depending on specific platforms.</p>
<p>Note that the buffer is not used to hold all the response headers, but just each individual header. So the buffer is merely needed to be big enough to hold the longest response header.</p>
<p>This directive was first introduced in the <code>v0.12rc7</code> release.</p>
<h2 id="srcache_store_hide_header">srcache_store_hide_header</h2>
<p><strong>syntax:</strong> <em>srcache_store_hide_header &lt;header&gt;</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>http, server, location, location if</em></p>
<p><strong>phase:</strong> <em>output-header-filter</em></p>
<p>By default, this module caches all the response headers except the following ones:</p>
<ul>
<li>Connection</li>
<li>Keep-Alive</li>
<li>Proxy-Authenticate</li>
<li>Proxy-Authorization</li>
<li>TE</li>
<li>Trailers</li>
<li>Transfer-Encoding</li>
<li>Upgrade</li>
<li>Set-Cookie</li>
</ul>
<p>You can hide even more response headers from <a href="#srcache_store">srcache_store</a> by listing their names (case-insensitive) by means of this directive. For examples,</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">srcache_store_hide_header</span><span class="w"> </span><span class="s">X-Foo</span><span class="p">;</span>
<span class="w"> </span><span class="k">srcache_store_hide_header</span><span class="w"> </span><span class="s">Last-Modified</span><span class="p">;</span>
</code></pre></div>
<p>Multiple occurrences of this directive are allowed in a single location.</p>
<p>This directive was first introduced in the <code>v0.12rc7</code> release.</p>
<p>See also <a href="#srcache_store_pass_header">srcache_store_pass_header</a>.</p>
<h2 id="srcache_store_pass_header">srcache_store_pass_header</h2>
<p><strong>syntax:</strong> <em>srcache_store_pass_header &lt;header&gt;</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>http, server, location, location if</em></p>
<p><strong>phase:</strong> <em>output-header-filter</em></p>
<p>By default, this module caches all the response headers except the following ones:</p>
<ul>
<li>Connection</li>
<li>Keep-Alive</li>
<li>Proxy-Authenticate</li>
<li>Proxy-Authorization</li>
<li>TE</li>
<li>Trailers</li>
<li>Transfer-Encoding</li>
<li>Upgrade</li>
<li>Set-Cookie</li>
</ul>
<p>You can force <a href="#srcache_store">srcache_store</a> to store one or more of these response headers from <a href="#srcache_store">srcache_store</a> by listing their names (case-insensitive) by means of this directive. For examples,</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">srcache_store_pass_header</span><span class="w"> </span><span class="s">Set-Cookie</span><span class="p">;</span>
<span class="w"> </span><span class="k">srcache_store_pass_header</span><span class="w"> </span><span class="s">Proxy-Autenticate</span><span class="p">;</span>
</code></pre></div>
<p>Multiple occurrences of this directive are allowed in a single location.</p>
<p>This directive was first introduced in the <code>v0.12rc7</code> release.</p>
<p>See also <a href="#srcache_store_hide_header">srcache_store_hide_header</a>.</p>
<h2 id="srcache_methods">srcache_methods</h2>
<p><strong>syntax:</strong> <em>srcache_methods &lt;method&gt;...</em></p>
<p><strong>default:</strong> <em>srcache_methods GET HEAD</em></p>
<p><strong>context:</strong> <em>http, server, location</em></p>
<p><strong>phase:</strong> <em>post-access, output-header-filter</em></p>
<p>This directive specifies <abbr title="Hyper Text Transfer Protocol">HTTP</abbr> request methods that are considered by either <a href="#srcache_fetch">srcache_fetch</a> or <a href="#srcache_store">srcache_store</a>. <abbr title="Hyper Text Transfer Protocol">HTTP</abbr> request methods not listed will be skipped completely from the cache.</p>
<p>The following <abbr title="Hyper Text Transfer Protocol">HTTP</abbr> methods are allowed: <code>GET</code>, <code>HEAD</code>, <code>POST</code>, <code>PUT</code>, and <code>DELETE</code>. The <code>GET</code> and <code>HEAD</code> methods are always implicitly included in the list regardless of their presence in this directive.</p>
<p>Note that since the <code>v0.17</code> release <code>HEAD</code> requests are always skipped by <a href="#srcache_store">srcache_store</a> because their responses never carry a response body.</p>
<p>This directive was first introduced in the <code>v0.12rc7</code> release.</p>
<h2 id="srcache_ignore_content_encoding">srcache_ignore_content_encoding</h2>
<p><strong>syntax:</strong> <em>srcache_ignore_content_encoding on|off</em></p>
<p><strong>default:</strong> <em>srcache_ignore_content_encoding off</em></p>
<p><strong>context:</strong> <em>http, server, location, location if</em></p>
<p><strong>phase:</strong> <em>output-header-filter</em></p>
<p>When this directive is turned <code>off</code> (which is the default), non-empty <code>Content-Encoding</code> response header will cause <a href="#srcache_store">srcache_store</a> skip storing the whole response into the cache and issue a warning into nginx's <code>error.log</code> file like this:</p>
<div class="highlight"><pre><span></span><code>[warn] 12500#0: *1 srcache_store skipped due to response header &quot;Content-Encoding: gzip&quot;
            (maybe you forgot to disable compression on the backend?)
</code></pre></div>
<p>Turning on this directive will ignore the <code>Content-Encoding</code> response header and store the response as usual (and also without warning).</p>
<p>It's recommended to always disable gzip/deflate compression on your backend server by specifying the following line in your <code>nginx.conf</code> file:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">proxy_set_header</span><span class="w">  </span><span class="s">Accept-Encoding</span><span class="w">  </span><span class="s">&quot;&quot;</span><span class="p">;</span>
</code></pre></div>
<p>This directive was first introduced in the <code>v0.12rc7</code> release.</p>
<h2 id="srcache_request_cache_control">srcache_request_cache_control</h2>
<p><strong>syntax:</strong> <em>srcache_request_cache_control on|off</em></p>
<p><strong>default:</strong> <em>srcache_request_cache_control off</em></p>
<p><strong>context:</strong> <em>http, server, location</em></p>
<p><strong>phase:</strong> <em>post-access, output-header-filter</em></p>
<p>When this directive is turned <code>on</code>, the request headers <code>Cache-Control</code> and <code>Pragma</code> will be honored by this module in the following ways:</p>
<ol>
<li><a href="#srcache_fetch">srcache_fetch</a>, i.e., the cache lookup operation, will be skipped when request headers <code>Cache-Control: no-cache</code> and/or <code>Pragma: no-cache</code> are present.</li>
<li><a href="#srcache_store">srcache_store</a>, i.e., the cache store operation, will be skipped when the request header <code>Cache-Control: no-store</code> is specified.</li>
</ol>
<p>Turning off this directive will disable this functionality and is considered safer for busy sites mainly relying on cache for speed.</p>
<p>This directive was first introduced in the <code>v0.12rc7</code> release.</p>
<p>See also <a href="#srcache_response_cache_control">srcache_response_cache_control</a>.</p>
<h2 id="srcache_response_cache_control">srcache_response_cache_control</h2>
<p><strong>syntax:</strong> <em>srcache_response_cache_control on|off</em></p>
<p><strong>default:</strong> <em>srcache_response_cache_control on</em></p>
<p><strong>context:</strong> <em>http, server, location</em></p>
<p><strong>phase:</strong> <em>output-header-filter</em></p>
<p>When this directive is turned <code>on</code>, the response headers <code>Cache-Control</code> and <code>Expires</code> will be honored by this module in the following ways:</p>
<ul>
<li><code>Cache-Control: private</code> skips <a href="#srcache_store">srcache_store</a>,</li>
<li><code>Cache-Control: no-store</code> skips <a href="#srcache_store">srcache_store</a>,</li>
<li><code>Cache-Control: no-cache</code> skips <a href="#srcache_store">srcache_store</a>,</li>
<li><code>Cache-Control: max-age=0</code> skips <a href="#srcache_store">srcache_store</a>,</li>
<li>and <code>Expires: &lt;date-no-more-recently-than-now&gt;</code> skips <a href="#srcache_store">srcache_store</a>.</li>
</ul>
<p>This directive takes priority over the <a href="#srcache_store_no_store">srcache_store_no_store</a>, <a href="#srcache_store_no_cache">srcache_store_no_cache</a>, and <a href="#srcache_store_private">srcache_store_private</a> directives.</p>
<p>This directive was first introduced in the <code>v0.12rc7</code> release.</p>
<p>See also <a href="#srcache_request_cache_control">srcache_request_cache_control</a>.</p>
<h2 id="srcache_store_no_store">srcache_store_no_store</h2>
<p><strong>syntax:</strong> <em>srcache_store_no_store on|off</em></p>
<p><strong>default:</strong> <em>srcache_store_no_store off</em></p>
<p><strong>context:</strong> <em>http, server, location</em></p>
<p><strong>phase:</strong> <em>output-header-filter</em></p>
<p>Turning this directive on will force responses with the header <code>Cache-Control: no-store</code> to be stored into the cache when <a href="#srcache_response_cache_control">srcache_response_cache_control</a> is turned <code>on</code> <em>and</em> other conditions are met. Default to <code>off</code>.</p>
<p>This directive was first introduced in the <code>v0.12rc7</code> release.</p>
<h2 id="srcache_store_no_cache">srcache_store_no_cache</h2>
<p><strong>syntax:</strong> <em>srcache_store_no_cache on|off</em></p>
<p><strong>default:</strong> <em>srcache_store_no_cache off</em></p>
<p><strong>context:</strong> <em>http, server, location</em></p>
<p><strong>phase:</strong> <em>output-header-filter</em></p>
<p>Turning this directive on will force responses with the header <code>Cache-Control: no-cache</code> to be stored into the cache when <a href="#srcache_response_cache_control">srcache_response_cache_control</a> is turned <code>on</code> <em>and</em> other conditions are met. Default to <code>off</code>.</p>
<p>This directive was first introduced in the <code>v0.12rc7</code> release.</p>
<h2 id="srcache_store_private">srcache_store_private</h2>
<p><strong>syntax:</strong> <em>srcache_store_private on|off</em></p>
<p><strong>default:</strong> <em>srcache_store_private off</em></p>
<p><strong>context:</strong> <em>http, server, location</em></p>
<p><strong>phase:</strong> <em>output-header-filter</em></p>
<p>Turning this directive on will force responses with the header <code>Cache-Control: private</code> to be stored into the cache when <a href="#srcache_response_cache_control">srcache_response_cache_control</a> is turned <code>on</code> <em>and</em> other conditions are met. Default to <code>off</code>.</p>
<p>This directive was first introduced in the <code>v0.12rc7</code> release.</p>
<h2 id="srcache_default_expire">srcache_default_expire</h2>
<p><strong>syntax:</strong> <em>srcache_default_expire &lt;time&gt;</em></p>
<p><strong>default:</strong> <em>srcache_default_expire 60s</em></p>
<p><strong>context:</strong> <em>http, server, location, location if</em></p>
<p><strong>phase:</strong> <em>output-header-filter</em></p>
<p>This directive controls the default expiration time period that is allowed for the <a href="#srcache_expire">$srcache_expire</a> variable value when neither <code>Cache-Control: max-age=N</code> nor <code>Expires</code> are specified in the response headers.</p>
<p>The <code>&lt;time&gt;</code> argument values are in seconds by default. But it's wise to always explicitly specify the time unit to avoid confusion. Time units supported are "s"(seconds), "ms"(milliseconds), "y"(years), "M"(months), "w"(weeks), "d"(days), "h"(hours), and "m"(minutes). For example,</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">srcache_default_expire</span><span class="w"> </span><span class="mi">30m</span><span class="p">;</span><span class="w"> </span><span class="c1"># 30 minutes</span>
</code></pre></div>
<p>This time must be less than 597 hours.</p>
<p>The semantics of a zero expiration time depends on the actual cache backend storage you are currently using, which is agnostic to this
module. In the case of memcached, for example, zero expiration times mean that the item will never expire.</p>
<p>This directive was first introduced in the <code>v0.12rc7</code> release.</p>
<h2 id="srcache_max_expire">srcache_max_expire</h2>
<p><strong>syntax:</strong> <em>srcache_max_expire &lt;time&gt;</em></p>
<p><strong>default:</strong> <em>srcache_max_expire 0</em></p>
<p><strong>context:</strong> <em>http, server, location, location if</em></p>
<p><strong>phase:</strong> <em>output-header-filter</em></p>
<p>This directive controls the maximal expiration time period that is allowed for the <a href="#srcache_expire">$srcache_expire</a> variable value. This setting takes priority over other calculating methods.</p>
<p>The <code>&lt;time&gt;</code> argument values are in seconds by default. But it's wise to always explicitly specify the time unit to avoid confusion. Time units supported are "s"(seconds), "ms"(milliseconds), "y"(years), "M"(months), "w"(weeks), "d"(days), "h"(hours), and "m"(minutes). For example,</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">srcache_max_expire</span><span class="w"> </span><span class="s">2h</span><span class="p">;</span><span class="w">  </span><span class="c1"># 2 hours</span>
</code></pre></div>
<p>This time must be less than 597 hours.</p>
<p>When <code>0</code> is specified, which is the default setting, then there will be <em>no</em> limit at all.</p>
<p>This directive was first introduced in the <code>v0.12rc7</code> release.</p>
<h2 id="variables">Variables</h2>
<h2 id="srcache_expire">$srcache_expire</h2>
<p><strong>type:</strong> <em>integer</em></p>
<p><strong>cacheable:</strong> <em>no</em></p>
<p><strong>writable:</strong> <em>no</em></p>
<p>This Nginx variable gives the recommended expiration time period (in seconds) for the current response being stored into the cache. The algorithm of computing the value is as follows:</p>
<ol>
<li>When the response header <code>Cache-Control: max-age=N</code> is specified, then <code>N</code> will be used as the expiration time,</li>
<li>otherwise if the response header <code>Expires</code> is specified, then the expiration time will be obtained by subtracting the current time stamp from the time specified in the <code>Expires</code> header,</li>
<li>when neither <code>Cache-Control: max-age=N</code> nor <code>Expires</code> headers are specified, use the value specified in the <a href="#srcache_default_expire">srcache_default_expire</a> directive.</li>
</ol>
<p>The final value of this variable will be the value specified by the <a href="#srcache_max_expire">srcache_max_expire</a> directive if the value obtained in the algorithm above exceeds the maximal value (if any).</p>
<p>You don't have to use this variable for the expiration time.</p>
<p>This variable was first introduced in the <code>v0.12rc7</code> release.</p>
<h2 id="srcache_fetch_status">$srcache_fetch_status</h2>
<p><strong>type:</strong> <em>string</em></p>
<p><strong>cacheable:</strong> <em>no</em></p>
<p><strong>writable:</strong> <em>no</em></p>
<p>This Nginx variable is evaluated to the status of the "fetch" phase for the caching system. Three values are possible, <code>HIT</code>, <code>MISS</code>, and <code>BYPASS</code>.</p>
<p>When the "fetch" subrequest returns status code other than <code>200</code> or its response data is not well-formed, then this variable is evaluated to the value <code>MISS</code>.</p>
<p>The value of this variable is only meaningful after the <code>access</code> request processing phase, or <code>BYPASS</code> is always given.</p>
<p>This variable was first introduced in the <code>v0.14</code> release.</p>
<h2 id="srcache_store_status">$srcache_store_status</h2>
<p><strong>type:</strong> <em>string</em></p>
<p><strong>cacheable:</strong> <em>no</em></p>
<p><strong>writable:</strong> <em>no</em></p>
<p>This Nginx variable gives the current caching status for the "store" phase. Two possible values, <code>STORE</code> and <code>BYPASS</code> can be obtained.</p>
<p>Because the responses for the "store" subrequest are always discarded, so the value of this variable will always be <code>STORE</code> as long as the "store" subrequest is actually issued.</p>
<p>The value of this variable is only meaningful at least when the request headers of the current (main) request are being sent. The final result can only be obtained after all the response body has been sent if the <code>Content-Length</code> response header is not specified for the main request.</p>
<p>This variable was first introduced in the <code>v0.14</code> release.</p>
<h2 id="known-issues">Known Issues</h2>
<ul>
<li>On certain systems, enabling aio and/or sendfile may stop <a href="#srcache_store">srcache_store</a> from working. You can disable them in the locations configured by <a href="#srcache_store">srcache_store</a>.</li>
<li>The <a href="#srcache_store">srcache_store</a> directive can not be used to capture the responses generated by <a href="https://github.com/openresty/echo-nginx-module">echo-nginx-module</a>'s subrequest directivees like <a href="https://github.com/openresty/echo-nginx-module#echo_subrequest_async">echo_subrequest_async</a> and <a href="https://github.com/openresty/echo-nginx-module#echo_location">echo_location</a>. You are recommended to use HttpLuaModule to initiate and capture subrequests, which should work with <a href="#srcache_store">srcache_store</a>.</li>
</ul>
<h2 id="caveats">Caveats</h2>
<ul>
<li>It is recommended to disable your backend server's gzip compression and use nginx's <a href="http://nginx.org/en/docs/http/ngx_http_gzip_module.html">ngx_http_gzip_module</a> to do the job. In case of <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html">ngx_http_proxy_module</a>, you can use the following configure setting to disable backend gzip compression:
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">proxy_set_header</span><span class="w">  </span><span class="s">Accept-Encoding</span><span class="w">  </span><span class="s">&quot;&quot;</span><span class="p">;</span>
</code></pre></div></li>
<li>Do <em>not</em> use <a href="http://nginx.org/en/docs/http/ngx_http_rewrite_module.html">ngx_http_rewrite_module</a>'s <a href="http://nginx.org/en/docs/http/ngx_http_rewrite_module.html#if">if</a> directive in the same location as this module's, because "<a href="http://nginx.org/en/docs/http/ngx_http_rewrite_module.html#if">if</a> is evil". Instead, use <a href="http://nginx.org/en/docs/http/ngx_http_map_module.html">ngx_http_map_module</a> or <a href="https://github.com/openresty/lua-nginx-module">lua-nginx-module</a> combined with this module's <a href="#srcache_store_skip">srcache_store_skip</a> and/or <a href="#srcache_fetch_skip">srcache_fetch_skip</a> directives. For example:
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="nv">$request_method</span><span class="w"> </span><span class="nv">$skip_fetch</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">default</span><span class="w">     </span><span class="mi">0</span><span class="p">;</span>
<span class="w">     </span><span class="kn">POST</span><span class="w">        </span><span class="mi">1</span><span class="p">;</span>
<span class="w">     </span><span class="kn">PUT</span><span class="w">         </span><span class="mi">1</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>

<span class="w"> </span><span class="k">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">listen</span><span class="w"> </span><span class="mi">8080</span><span class="p">;</span>

<span class="w">     </span><span class="kn">location</span><span class="w"> </span><span class="s">/api/</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="kn">set</span><span class="w"> </span><span class="nv">$key</span><span class="w"> </span><span class="s">&quot;</span><span class="nv">$uri?$args&quot;</span><span class="p">;</span>

<span class="w">         </span><span class="kn">srcache_fetch</span><span class="w"> </span><span class="s">GET</span><span class="w"> </span><span class="s">/memc</span><span class="w"> </span><span class="nv">$key</span><span class="p">;</span>
<span class="w">         </span><span class="kn">srcache_store</span><span class="w"> </span><span class="s">PUT</span><span class="w"> </span><span class="s">/memc</span><span class="w"> </span><span class="nv">$key</span><span class="p">;</span>

<span class="w">         </span><span class="kn">srcache_methods</span><span class="w"> </span><span class="s">GET</span><span class="w"> </span><span class="s">PUT</span><span class="w"> </span><span class="s">POST</span><span class="p">;</span>
<span class="w">         </span><span class="kn">srcache_fetch_skip</span><span class="w"> </span><span class="nv">$skip_fetch</span><span class="p">;</span>

<span class="w">         </span><span class="c1"># proxy_pass/drizzle_pass/content_by_lua/echo/...</span>
<span class="w">     </span><span class="p">}</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div></li>
</ul>
<h2 id="trouble-shooting">Trouble Shooting</h2>
<p>To debug issues, you should always check your Nginx <code>error.log</code> file first. If no error messages are printed, you need to enable the Nginx debugging logs to get more details, as explained in <a href="http://nginx.org/en/docs/debugging_log.html">debugging log</a>.</p>
<p>Several common pitfalls for beginners:</p>
<ul>
<li>The original response carries a <code>Cache-Control</code> header that explicitly disables caching and you do not configure directives like <a href="#srcache_response_cache_control">srcache_response_cache_control</a>.</li>
<li>The original response is already gzip compressed, which is not cached by default (see <a href="#srcache_ignore_content_encoding">srcache_ignore_content_encoding</a>).</li>
<li>Memcached might return <code>CLIENT_ERROR bad command line format</code> when using a too long key (250 chars as of version 1.4.25). It is thus safer to use <code>set_md5 $key $uri$args;</code> instead of <code>set $key $uri$args;</code>. The <code>set_md5</code> directive (and more) is available from <a href="https://github.com/openresty/set-misc-nginx-module">OpenResty's set-misc module</a>.</li>
<li>Nginx might return <code>client intended to send too large body</code> when trying to store objects larger than 1m to the storage backend, in which case nginx <code>client_max_body_size</code> must be set to a higher value.</li>
<li>Memcached might fail to store objects larger than 1m, causing errors like <code>srcache_store subrequest failed status=502</code>. Since version 1.4.2, memcached supports a command-line <code>-I</code> option to override the default size of each slab page. Please read its manpage for more information.</li>
</ul>
<h2 id="test-suite">Test Suite</h2>
<p>This module comes with a Perl-driven test suite. The <a href="https://github.com/openresty/srcache-nginx-module/tree/master/test/t">test cases</a> are <a href="https://github.com/openresty/srcache-nginx-module/blob/master/test/t/main-req.t">declarative</a> too. Thanks to the <a href="http://search.cpan.org/perldoc?Test::Base">Test::Nginx</a> module in the Perl world.</p>
<p>To run it on your side:
<div class="highlight"><pre><span></span><code><span class="w"> </span>$<span class="w"> </span><span class="nv">PATH</span><span class="o">=</span>/path/to/your/nginx-with-srcache-module:<span class="nv">$PATH</span><span class="w"> </span>prove<span class="w"> </span>-r<span class="w"> </span>t
</code></pre></div>
You need to terminate any Nginx processes before running the test suite if you have changed the Nginx server binary.</p>
<p>Because a single nginx server (by default, <code>localhost:1984</code>) is used across all the test scripts (<code>.t</code> files), it's meaningless to run the test suite in parallel by specifying <code>-jN</code> when invoking the <code>prove</code> utility.</p>
<p>Some parts of the test suite requires modules <a href="http://nginx.org/en/docs/http/ngx_http_rewrite_module.html">ngx_http_rewrite_module</a>, <a href="https://github.com/openresty/echo-nginx-module">echo-nginx-module</a>, <a href="https://github.com/openresty/rds-json-nginx-module">rds-json-nginx-module</a>, and <a href="https://github.com/openresty/drizzle-nginx-module">drizzle-nginx-module</a> to be enabled as well when building Nginx.</p>
<h2 id="see-also">See Also</h2>
<ul>
<li><a href="https://github.com/openresty/memc-nginx-module">memc-nginx-module</a></li>
<li><a href="https://github.com/openresty/lua-nginx-module">lua-nginx-module</a></li>
<li><a href="https://github.com/openresty/set-misc-nginx-module">set-misc-nginx-module</a></li>
<li>The <a href="http://openresty.org">openresty bundle</a></li>
</ul>
<h2 id="github">GitHub</h2>
<p>You may find additional configuration tips and documentation for this module in the <a href="https://github.com/dvershinin/srcache-nginx-module" target="_blank">GitHub 
repository for 
nginx-module-srcache</a>.</p>







  
  



  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2014 - 2023 GetPageSpeed LLC 2023
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/GetPageSpeed" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/GetPageSpeed" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/getpagespeed" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.facebook.com/getpagespeed/" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://t.me/GetPageSpeed" target="_blank" rel="noopener" title="t.me" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8Zm114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452 0 0 1 3.53 6.716 43.765 43.765 0 0 1 .417 9.769Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.expand", "navigation.top", "navigation.tabs", "search.suggest", "content.tooltips", "content.tabs.link", "content.code.copy"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>