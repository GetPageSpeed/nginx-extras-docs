
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Automatic documentation from sources, for NGINX Extras.">
      
      
        <meta name="author" content="Danila Vershinin">
      
      
        <link rel="canonical" href="https://nginx-extras.getpagespeed.com/modules/echo/">
      
      
        <link rel="prev" href="../dynamic-limit-req/">
      
      
        <link rel="next" href="../encrypted-session/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>echo - NGINX Extras Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-YZHLYCQK9D"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-YZHLYCQK9D",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-YZHLYCQK9D",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="echo - NGINX Extras Documentation" >
      
        <meta  property="og:description"  content="Automatic documentation from sources, for NGINX Extras." >
      
        <meta  property="og:image"  content="https://nginx-extras.getpagespeed.com/assets/images/social/modules/echo.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://nginx-extras.getpagespeed.com/modules/echo/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="echo - NGINX Extras Documentation" >
      
        <meta  name="twitter:description"  content="Automatic documentation from sources, for NGINX Extras." >
      
        <meta  name="twitter:image"  content="https://nginx-extras.getpagespeed.com/assets/images/social/modules/echo.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="getpagespeed" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#echo-nginx-echo-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
  NGINX Extras is <a href="https://www.getpagespeed.com/repo-subscribe" target="_blank"><em>subscription-ware</em></a> by GetPageSpeed, allowing your server to be secure and fast.

          </div>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="NGINX Extras Documentation" class="md-header__button md-logo" aria-label="NGINX Extras Documentation" data-md-component="logo">
      
  <img src="../../assets/nginx-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NGINX Extras Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              echo
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="getpagespeed" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  Modules

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../lua/" class="md-tabs__link">
          
  
  Lua Scripting

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../branches/" class="md-tabs__link">
          
  
  Distributions

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="https://www.getpagespeed.com/redhat" class="md-tabs__link">
        
  
    
  
  RPM Repository

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="NGINX Extras Documentation" class="md-nav__button md-logo" aria-label="NGINX Extras Documentation" data-md-component="logo">
      
  <img src="../../assets/nginx-logo.png" alt="logo">

    </a>
    NGINX Extras Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../accept-language/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    accept-language
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ajp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ajp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../array-var/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    array-var
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auth-digest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-digest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auth-ldap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-ldap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auth-pam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-pam
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bot-verifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bot-verifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../brotli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    brotli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cache-purge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cache-purge
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../captcha/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    captcha
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combined-upstreams/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    combined-upstreams
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    concat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cookie-flag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cookie-flag
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cookie-limit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cookie-limit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../coolkit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    coolkit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dav-ext/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dav-ext
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../doh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    doh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic-etag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dynamic-etag
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic-limit-req/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dynamic-limit-req
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    echo
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    echo
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#status" class="md-nav__link">
    <span class="md-ellipsis">
      Status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synopsis" class="md-nav__link">
    <span class="md-ellipsis">
      Synopsis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    <span class="md-ellipsis">
      Description
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#content-handler-directives" class="md-nav__link">
    <span class="md-ellipsis">
      Content Handler Directives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo" class="md-nav__link">
    <span class="md-ellipsis">
      echo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_duplicate" class="md-nav__link">
    <span class="md-ellipsis">
      echo_duplicate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_flush" class="md-nav__link">
    <span class="md-ellipsis">
      echo_flush
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_sleep" class="md-nav__link">
    <span class="md-ellipsis">
      echo_sleep
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_blocking_sleep" class="md-nav__link">
    <span class="md-ellipsis">
      echo_blocking_sleep
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_reset_timer" class="md-nav__link">
    <span class="md-ellipsis">
      echo_reset_timer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_read_request_body" class="md-nav__link">
    <span class="md-ellipsis">
      echo_read_request_body
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_location_async" class="md-nav__link">
    <span class="md-ellipsis">
      echo_location_async
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_location" class="md-nav__link">
    <span class="md-ellipsis">
      echo_location
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_subrequest_async" class="md-nav__link">
    <span class="md-ellipsis">
      echo_subrequest_async
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_subrequest" class="md-nav__link">
    <span class="md-ellipsis">
      echo_subrequest
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_foreach_split" class="md-nav__link">
    <span class="md-ellipsis">
      echo_foreach_split
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_end" class="md-nav__link">
    <span class="md-ellipsis">
      echo_end
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_request_body" class="md-nav__link">
    <span class="md-ellipsis">
      echo_request_body
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_exec" class="md-nav__link">
    <span class="md-ellipsis">
      echo_exec
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_status" class="md-nav__link">
    <span class="md-ellipsis">
      echo_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filter-directives" class="md-nav__link">
    <span class="md-ellipsis">
      Filter Directives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_before_body" class="md-nav__link">
    <span class="md-ellipsis">
      echo_before_body
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_after_body" class="md-nav__link">
    <span class="md-ellipsis">
      echo_after_body
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    <span class="md-ellipsis">
      Variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_it" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_it
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_timer_elapsed" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_timer_elapsed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_request_body_1" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_request_body
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_request_method" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_request_method
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_client_request_method" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_client_request_method
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_client_request_headers" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_client_request_headers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_cacheable_request_uri" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_cacheable_request_uri
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_request_uri" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_request_uri
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_incr" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_incr
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_response_status" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_response_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules-that-use-this-module-for-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Modules that use this module for testing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#changes" class="md-nav__link">
    <span class="md-ellipsis">
      Changes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-suite" class="md-nav__link">
    <span class="md-ellipsis">
      Test Suite
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github" class="md-nav__link">
    <span class="md-ellipsis">
      GitHub
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encrypted-session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    encrypted-session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../execute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    execute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../f4fhds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    f4fhds
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fancyindex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fancyindex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fips-check/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fips-check
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    flv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../form-input/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    form-input
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geoip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geoip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geoip2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geoip2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../google/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    google
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graphite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../headers-more/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    headers-more
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hmac-secure-link/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hmac-secure-link
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../html-sanitize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    html-sanitize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../iconv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iconv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../image-filter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    image-filter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../immutable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    immutable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ipscrub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ipscrub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jpeg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jpeg
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../js-challenge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    js-challenge
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../json/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    json
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../json-var/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    json-var
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jwt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jwt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../length-hiding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    length-hiding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../let/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    let
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../live-common/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    live-common
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../log-zmq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log-zmq
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lua/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lua
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    markdown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../memc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    memc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../naxsi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    naxsi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nchan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nchan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ndk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ndk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../njs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    njs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ntlm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ntlm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pagespeed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pagespeed
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../passenger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    passenger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../perl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    perl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../phantom-token/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    phantom-token
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postgres/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    postgres
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pta
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../push-stream/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    push-stream
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rdns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rdns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../redis2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rtmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rtmp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../secure-token/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    secure-token
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security-headers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    security-headers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../set-misc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    set-misc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shibboleth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shibboleth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../slowfs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    slowfs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../small-light/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    small-light
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spnego-http-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spnego-http-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../srcache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    srcache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../srt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    srt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../statsd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    statsd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sticky/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sticky
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stream-lua/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stream-lua
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stream-sts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stream-sts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stream-upsync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stream-upsync
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../substitutions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    substitutions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sysguard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sysguard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../testcookie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    testcookie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../traffic-accounting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    traffic-accounting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../untar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    untar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upstream-fair/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream-fair
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upstream-jdomain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream-jdomain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upsync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upsync
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vod
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    webp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xslt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xslt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xss/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xss
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zstd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zstd
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lua Scripting
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Lua Scripting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/acme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    acme
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/auto-ssl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auto-ssl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/aws-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/aws-sdk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws-sdk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/balancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    balancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/base-encoding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    base-encoding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/cache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/checkups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    checkups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/consul/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    consul
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/consul-event/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    consul-event
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/cookie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cookie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    core
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/cors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/counter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    counter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/ctxdump/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ctxdump
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/dns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/dns-server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dns-server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/etcd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    etcd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/exec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/feishu-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    feishu-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/fileinfo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fileinfo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/ftpclient/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ftpclient
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/global-throttle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    global-throttle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/healthcheck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    healthcheck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/hmac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hmac
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/hoedown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hoedown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/http/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    http
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/http2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    http2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/httpipe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    httpipe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/hyperscan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hyperscan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/influx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    influx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/ini/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ini
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/iputils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iputils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/jit-uuid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jit-uuid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/jsonrpc-batch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jsonrpc-batch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/jump-consistent-hash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jump-consistent-hash
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/jwt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jwt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/kafka/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kafka
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/libcjson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    libcjson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/libr3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    libr3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/limit-rate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    limit-rate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/limit-traffic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    limit-traffic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/lmdb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lmdb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/locations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    locations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/lock/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/logger-socket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    logger-socket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/lrucache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lrucache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/macaroons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    macaroons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/mail/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mail
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/maxminddb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    maxminddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/memcached/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    memcached
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/mlcache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mlcache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/multiplexer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    multiplexer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/murmurhash2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    murmurhash2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/mysql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mysql
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/nettle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nettle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/newrelic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    newrelic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/nsq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nsq
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/ntlm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ntlm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/openidc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    openidc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/openssl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    openssl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/perf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    perf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/prettycjson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    prettycjson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/pubsub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pubsub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/qless/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    qless
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/qless-web/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    qless-web
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/rabbitmqstomp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rabbitmqstomp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/rack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/radixtree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    radixtree
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/redis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/redis-connector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis-connector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/redis-ratelimit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis-ratelimit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/redis-util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis-util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/repl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    repl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/reqargs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    reqargs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/requests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    requests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/riak/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    riak
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/router/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    router
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/rsa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rsa
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/scrypt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scrypt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/signal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    signal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/smtp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    smtp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/snappy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    snappy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/sniproxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sniproxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/socket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    socket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/string/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/t1k/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    t1k
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tags
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/tarantool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tarantool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/template/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    template
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    test
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/timer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    timer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/tlc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tlc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/tsort/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tsort
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/txid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    txid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/upload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/upstream/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/upstream-healthcheck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream-healthcheck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/uuid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    uuid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/validation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/vhost/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vhost
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/waf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    waf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/weauth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    weauth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/websocket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    websocket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/woothee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    woothee
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/worker-events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    worker-events
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/xxhash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xxhash
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Distributions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Distributions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../branches/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NGINX Branches
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nginx-mod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NGINX-MOD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tengine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tengine
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plesk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plesk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP/3 (QUIC)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../angie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Angie
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://www.getpagespeed.com/redhat" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RPM Repository
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#status" class="md-nav__link">
    <span class="md-ellipsis">
      Status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synopsis" class="md-nav__link">
    <span class="md-ellipsis">
      Synopsis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    <span class="md-ellipsis">
      Description
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#content-handler-directives" class="md-nav__link">
    <span class="md-ellipsis">
      Content Handler Directives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo" class="md-nav__link">
    <span class="md-ellipsis">
      echo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_duplicate" class="md-nav__link">
    <span class="md-ellipsis">
      echo_duplicate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_flush" class="md-nav__link">
    <span class="md-ellipsis">
      echo_flush
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_sleep" class="md-nav__link">
    <span class="md-ellipsis">
      echo_sleep
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_blocking_sleep" class="md-nav__link">
    <span class="md-ellipsis">
      echo_blocking_sleep
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_reset_timer" class="md-nav__link">
    <span class="md-ellipsis">
      echo_reset_timer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_read_request_body" class="md-nav__link">
    <span class="md-ellipsis">
      echo_read_request_body
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_location_async" class="md-nav__link">
    <span class="md-ellipsis">
      echo_location_async
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_location" class="md-nav__link">
    <span class="md-ellipsis">
      echo_location
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_subrequest_async" class="md-nav__link">
    <span class="md-ellipsis">
      echo_subrequest_async
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_subrequest" class="md-nav__link">
    <span class="md-ellipsis">
      echo_subrequest
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_foreach_split" class="md-nav__link">
    <span class="md-ellipsis">
      echo_foreach_split
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_end" class="md-nav__link">
    <span class="md-ellipsis">
      echo_end
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_request_body" class="md-nav__link">
    <span class="md-ellipsis">
      echo_request_body
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_exec" class="md-nav__link">
    <span class="md-ellipsis">
      echo_exec
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_status" class="md-nav__link">
    <span class="md-ellipsis">
      echo_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filter-directives" class="md-nav__link">
    <span class="md-ellipsis">
      Filter Directives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_before_body" class="md-nav__link">
    <span class="md-ellipsis">
      echo_before_body
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_after_body" class="md-nav__link">
    <span class="md-ellipsis">
      echo_after_body
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    <span class="md-ellipsis">
      Variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_it" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_it
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_timer_elapsed" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_timer_elapsed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_request_body_1" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_request_body
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_request_method" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_request_method
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_client_request_method" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_client_request_method
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_client_request_headers" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_client_request_headers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_cacheable_request_uri" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_cacheable_request_uri
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_request_uri" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_request_uri
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_incr" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_incr
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#echo_response_status" class="md-nav__link">
    <span class="md-ellipsis">
      $echo_response_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules-that-use-this-module-for-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Modules that use this module for testing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#changes" class="md-nav__link">
    <span class="md-ellipsis">
      Changes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-suite" class="md-nav__link">
    <span class="md-ellipsis">
      Test Suite
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github" class="md-nav__link">
    <span class="md-ellipsis">
      GitHub
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="echo-nginx-echo-module"><em>echo</em>: nginx Echo module</h1>
<h2 id="installation">Installation</h2>
<p>You can install this module in any <abbr title="Red Hat Enterprise Linux">RHEL</abbr>-based distribution, including, but not limited to:</p>
<ul>
<li>RedHat Enterprise Linux 7, 8, 9</li>
<li>CentOS 7, 8, 9</li>
<li>AlmaLinux 8, 9</li>
<li>Rocky Linux 8, 9</li>
<li>Amazon Linux 2 and Amazon Linux 2023</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">CentOS/<abbr title="Red Hat Enterprise Linux">RHEL</abbr> 7 and Amazon Linux 2</label><label for="__tabbed_1_2">CentOS/<abbr title="Red Hat Enterprise Linux">RHEL</abbr> 8, 9 and Fedora Linux, Amazon Linux 2023, etc.</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>```bash
yum -y install <a href="https://extras.getpagespeed.com/release-latest.rpm">https://extras.getpagespeed.com/release-latest.rpm</a>
yum -y install <a href="https://epel.cloud/pub/epel/epel-release-latest-7.noarch.rpm">https://epel.cloud/pub/epel/epel-release-latest-7.noarch.rpm</a> 
yum -y install nginx-module-echo</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>https://extras.getpagespeed.com/release-latest.rpm<span class="w"> </span>
dnf<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>nginx-module-echo
</code></pre></div>
</div>
</div>
</div>
<p>Enable the module by adding the following at the top of <code>/etc/nginx/nginx.conf</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">load_module</span><span class="w"> </span><span class="s">modules/ngx_http_echo_module.so</span><span class="p">;</span>
</code></pre></div>
<p>This document describes nginx-module-echo <a href="https://github.com/openresty/echo-nginx-module/releases/tag/v0.63" target="_blank">v0.63</a> 
released on Jul 31 2022.</p>
<hr />

<p><strong>ngx_echo</strong> - Brings "echo", "sleep", "time", "exec" and more shell-style goodies to Nginx config file.</p>
<h2 id="status">Status</h2>
<p>This module is production ready.</p>
<h2 id="synopsis">Synopsis</h2>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/hello</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;hello,</span><span class="w"> </span><span class="s">world!&quot;</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/hello</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">-n</span><span class="w"> </span><span class="s">&quot;hello,</span><span class="w"> </span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;world!&quot;</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/timed_hello</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_reset_timer</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">hello</span><span class="w"> </span><span class="s">world</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;&#39;hello</span><span class="w"> </span><span class="s">world&#39;</span><span class="w"> </span><span class="s">takes</span><span class="w"> </span><span class="s">about</span><span class="w"> </span><span class="nv">$echo_timer_elapsed</span><span class="w"> </span><span class="s">sec.&quot;</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">hiya</span><span class="w"> </span><span class="s">igor</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;&#39;hiya</span><span class="w"> </span><span class="s">igor&#39;</span><span class="w"> </span><span class="s">takes</span><span class="w"> </span><span class="s">about</span><span class="w"> </span><span class="nv">$echo_timer_elapsed</span><span class="w"> </span><span class="s">sec.&quot;</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/echo_with_sleep</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">hello</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo_flush</span><span class="p">;</span><span class="w">  </span><span class="c1"># ensure the client can see previous output immediately</span>
<span class="w">     </span><span class="kn">echo_sleep</span><span class="w">   </span><span class="mi">2</span><span class="s">.5</span><span class="p">;</span><span class="w">  </span><span class="c1"># in sec</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">world</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="c1"># in the following example, accessing /echo yields</span>
<span class="w">   </span><span class="c1">#   hello</span>
<span class="w">   </span><span class="c1">#   world</span>
<span class="w">   </span><span class="c1">#   blah</span>
<span class="w">   </span><span class="c1">#   hiya</span>
<span class="w">   </span><span class="c1">#   igor</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/echo</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_before_body</span><span class="w"> </span><span class="s">hello</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo_before_body</span><span class="w"> </span><span class="s">world</span><span class="p">;</span>
<span class="w">       </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="nv">$scheme://127.0.0.1:$server_port$request_uri/more</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo_after_body</span><span class="w"> </span><span class="s">hiya</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo_after_body</span><span class="w"> </span><span class="s">igor</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/echo/more</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="s">blah</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="c1"># the output of /main might be</span>
<span class="w">   </span><span class="c1">#   hello</span>
<span class="w">   </span><span class="c1">#   world</span>
<span class="w">   </span><span class="c1">#   took 0.000 sec for total.</span>
<span class="w">   </span><span class="c1"># and the whole request would take about 2 sec to complete.</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/main</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_reset_timer</span><span class="p">;</span>

<span class="w">       </span><span class="c1"># subrequests in parallel</span>
<span class="w">       </span><span class="kn">echo_location_async</span><span class="w"> </span><span class="s">/sub1</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo_location_async</span><span class="w"> </span><span class="s">/sub2</span><span class="p">;</span>

<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;took</span><span class="w"> </span><span class="nv">$echo_timer_elapsed</span><span class="w"> </span><span class="s">sec</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">total.&quot;</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/sub1</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_sleep</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="s">hello</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/sub2</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_sleep</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="s">world</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="c1"># the output of /main might be</span>
<span class="w">   </span><span class="c1">#   hello</span>
<span class="w">   </span><span class="c1">#   world</span>
<span class="w">   </span><span class="c1">#   took 3.003 sec for total.</span>
<span class="w">   </span><span class="c1"># and the whole request would take about 3 sec to complete.</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/main</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_reset_timer</span><span class="p">;</span>

<span class="w">       </span><span class="c1"># subrequests in series (chained by CPS)</span>
<span class="w">       </span><span class="kn">echo_location</span><span class="w"> </span><span class="s">/sub1</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo_location</span><span class="w"> </span><span class="s">/sub2</span><span class="p">;</span>

<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;took</span><span class="w"> </span><span class="nv">$echo_timer_elapsed</span><span class="w"> </span><span class="s">sec</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">total.&quot;</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/sub1</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_sleep</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="s">hello</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/sub2</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_sleep</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="s">world</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="c1"># Accessing /dup gives</span>
<span class="w">   </span><span class="c1">#   ------ END ------</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/dup</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_duplicate</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="s">&quot;--&quot;</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo_duplicate</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="s">&quot;</span><span class="w"> </span><span class="s">END</span><span class="w"> </span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo_duplicate</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="s">&quot;--&quot;</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="c1"># /bighello will generate 1000,000,000 hello&#39;s.</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/bighello</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_duplicate</span><span class="w"> </span><span class="s">1000_000_000</span><span class="w"> </span><span class="s">&#39;hello&#39;</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="c1"># echo back the client request</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/echoback</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_duplicate</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">$echo_client_request_headers</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;\r&quot;</span><span class="p">;</span>

<span class="w">     </span><span class="kn">echo_read_request_body</span><span class="p">;</span>

<span class="w">     </span><span class="kn">echo_request_body</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="c1"># GET /multi will yields</span>
<span class="w">   </span><span class="c1">#   querystring: foo=Foo</span>
<span class="w">   </span><span class="c1">#   method: POST</span>
<span class="w">   </span><span class="c1">#   body: hi</span>
<span class="w">   </span><span class="c1">#   content length: 2</span>
<span class="w">   </span><span class="c1">#   ///</span>
<span class="w">   </span><span class="c1">#   querystring: bar=Bar</span>
<span class="w">   </span><span class="c1">#   method: PUT</span>
<span class="w">   </span><span class="c1">#   body: hello</span>
<span class="w">   </span><span class="c1">#   content length: 5</span>
<span class="w">   </span><span class="c1">#   ///</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/multi</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_subrequest_async</span><span class="w"> </span><span class="s">POST</span><span class="w"> </span><span class="s">&#39;/sub&#39;</span><span class="w"> </span><span class="s">-q</span><span class="w"> </span><span class="s">&#39;foo=Foo&#39;</span><span class="w"> </span><span class="s">-b</span><span class="w"> </span><span class="s">&#39;hi&#39;</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo_subrequest_async</span><span class="w"> </span><span class="s">PUT</span><span class="w"> </span><span class="s">&#39;/sub&#39;</span><span class="w"> </span><span class="s">-q</span><span class="w"> </span><span class="s">&#39;bar=Bar&#39;</span><span class="w"> </span><span class="s">-b</span><span class="w"> </span><span class="s">&#39;hello&#39;</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/sub</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;querystring:</span><span class="w"> </span><span class="nv">$query_string&quot;</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;method:</span><span class="w"> </span><span class="nv">$echo_request_method&quot;</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;body:</span><span class="w"> </span><span class="nv">$echo_request_body&quot;</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;content</span><span class="w"> </span><span class="s">length:</span><span class="w"> </span><span class="nv">$http_content_length&quot;</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="s">&#39;///&#39;</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="c1"># GET /merge?/foo.js&amp;/bar/blah.js&amp;/yui/baz.js will merge the .js resources together</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/merge</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">default_type</span><span class="w"> </span><span class="s">&#39;text/javascript&#39;</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo_foreach_split</span><span class="w"> </span><span class="s">&#39;&amp;&#39;</span><span class="w"> </span><span class="nv">$query_string</span><span class="p">;</span>
<span class="w">           </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;/*</span><span class="w"> </span><span class="s">JS</span><span class="w"> </span><span class="s">File</span><span class="w"> </span><span class="nv">$echo_it</span><span class="w"> </span><span class="s">*/&quot;</span><span class="p">;</span>
<span class="w">           </span><span class="kn">echo_location_async</span><span class="w"> </span><span class="nv">$echo_it</span><span class="p">;</span>
<span class="w">           </span><span class="kn">echo</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo_end</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="c1"># accessing /if?val=abc yields the &quot;hit&quot; output</span>
<span class="w">   </span><span class="c1"># while /if?val=bcd yields &quot;miss&quot;:</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">^~</span><span class="w"> </span><span class="s">/if</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">set</span><span class="w"> </span><span class="nv">$res</span><span class="w"> </span><span class="s">miss</span><span class="p">;</span>
<span class="w">       </span><span class="kn">if</span><span class="w"> </span><span class="s">(</span><span class="nv">$arg_val</span><span class="w"> </span><span class="p">~</span><span class="sr">*</span><span class="w"> </span><span class="s">&#39;^a&#39;)</span><span class="w"> </span><span class="p">{</span>
<span class="w">           </span><span class="kn">set</span><span class="w"> </span><span class="nv">$res</span><span class="w"> </span><span class="s">hit</span><span class="p">;</span>
<span class="w">           </span><span class="kn">echo</span><span class="w"> </span><span class="nv">$res</span><span class="p">;</span>
<span class="w">       </span><span class="p">}</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="nv">$res</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<h2 id="description">Description</h2>
<p>This module wraps lots of Nginx internal APIs for streaming input and output, parallel/sequential subrequests, timers and sleeping, as well as various meta data accessing.</p>
<p>Basically it provides various utilities that help testing and debugging of other modules by trivially emulating different kinds of faked subrequest locations.</p>
<p>People will also find it useful in real-world applications that need to</p>
<ol>
<li>serve static contents directly from memory (loading from the Nginx config file).</li>
<li>wrap the upstream response with custom header and footer (kinda like the <a href="http://nginx.org/en/docs/http/ngx_http_addition_module.html">addition module</a> but with contents read directly from the config file and Nginx variables).</li>
<li>merge contents of various "Nginx locations" (i.e., subrequests) together in a single main request (using <a href="#echo_location">echo_location</a> and its friends).</li>
</ol>
<p>This is a special dual-role module that can <em>lazily</em> serve as a content handler or register itself as an output filter only upon demand. By default, this module does not do anything at all.</p>
<p>Technically, this module has also demonstrated the following techniques that might be helpful for module writers:</p>
<ol>
<li>Issue parallel subrequests directly from content handler.</li>
<li>Issue chained subrequests directly from content handler, by passing continuation along the subrequest chain.</li>
<li>Issue subrequests with all <abbr title="Hyper Text Transfer Protocol">HTTP</abbr> 1.1 methods and even an optional faked <abbr title="Hyper Text Transfer Protocol">HTTP</abbr> request body.</li>
<li>Interact with the Nginx event model directly from content handler using custom events and timers, and resume the content handler back if necessary.</li>
<li>Dual-role module that can (lazily) serve as a content handler or an output filter or both.</li>
<li>Nginx config file variable creation and interpolation.</li>
<li>Streaming output control using output_chain, flush and its friends.</li>
<li>Read client request body from the content handler, and returns back (asynchronously) to the content handler after completion.</li>
<li>Use Perl-based declarative <a href="#test-suite">test suite</a> to drive the development of Nginx C modules.</li>
</ol>
<h2 id="content-handler-directives">Content Handler Directives</h2>
<p>Use of the following directives register this module to the current Nginx location as a content handler. If you want to use another module, like the <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html">standard proxy module</a>, as the content handler, use the <a href="#filter-directives">filter directives</a> provided by this module.</p>
<p>All the content handler directives can be mixed together in a single Nginx location and they're supposed to run sequentially just as in the Bash scripting language.</p>
<p>Every content handler directive supports variable interpolation in its arguments (if any).</p>
<p>The MIME type set by the <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#default_type">standard default_type directive</a> is respected by this module, as in:</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/hello</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">default_type</span><span class="w"> </span><span class="s">text/plain</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">hello</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<p>Then on the client side:</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span>$<span class="w"> </span>curl<span class="w"> </span>-I<span class="w"> </span><span class="s1">&#39;http://localhost/echo&#39;</span>
<span class="w">   </span>HTTP/1.1<span class="w"> </span><span class="m">200</span><span class="w"> </span>OK
<span class="w">   </span>Server:<span class="w"> </span>nginx/0.8.20
<span class="w">   </span>Date:<span class="w"> </span>Sat,<span class="w"> </span><span class="m">17</span><span class="w"> </span>Oct<span class="w"> </span><span class="m">2009</span><span class="w"> </span><span class="m">03</span>:40:19<span class="w"> </span>GMT
<span class="w">   </span>Content-Type:<span class="w"> </span>text/plain
<span class="w">   </span>Connection:<span class="w"> </span>keep-alive
</code></pre></div>
<p>Since the <a href="#v022">v0.22</a> release, all of the directives are allowed in the <a href="http://nginx.org/en/docs/http/ngx_http_rewrite_module.html">rewrite module</a>'s <a href="http://nginx.org/en/docs/http/ngx_http_rewrite_module.html#if">if</a> directive block, for instance:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">^~</span><span class="w"> </span><span class="s">/if</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">set</span><span class="w"> </span><span class="nv">$res</span><span class="w"> </span><span class="s">miss</span><span class="p">;</span>
<span class="w">     </span><span class="kn">if</span><span class="w"> </span><span class="s">(</span><span class="nv">$arg_val</span><span class="w"> </span><span class="p">~</span><span class="sr">*</span><span class="w"> </span><span class="s">&#39;^a&#39;)</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="kn">set</span><span class="w"> </span><span class="nv">$res</span><span class="w"> </span><span class="s">hit</span><span class="p">;</span>
<span class="w">         </span><span class="kn">echo</span><span class="w"> </span><span class="nv">$res</span><span class="p">;</span>
<span class="w">     </span><span class="p">}</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="nv">$res</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<h2 id="echo">echo</h2>
<p><strong>syntax:</strong> <em>echo [options] &lt;string&gt;...</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>content</em></p>
<p>Sends arguments joined by spaces, along with a trailing newline, out to the client.</p>
<p>Note that the data might be buffered by Nginx's underlying buffer. To force the output data flushed immediately, use the <a href="#echo_flush">echo_flush</a> command just after <code>echo</code>, as in</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="k">echo</span><span class="w"> </span><span class="s">hello</span><span class="w"> </span><span class="s">world</span><span class="p">;</span>
<span class="w">    </span><span class="k">echo_flush</span><span class="p">;</span>
</code></pre></div>
<p>When no argument is specified, <em>echo</em> emits the trailing newline alone, just like the <em>echo</em> command in shell.</p>
<p>Variables may appear in the arguments. An example is</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="k">echo</span><span class="w"> </span><span class="s">The</span><span class="w"> </span><span class="s">current</span><span class="w"> </span><span class="s">request</span><span class="w"> </span><span class="s">uri</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="nv">$request_uri</span><span class="p">;</span>
</code></pre></div>
<p>where <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_request_uri">$request_uri</a> is a variable exposed by the <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html">ngx_http_core_module</a>.</p>
<p>This command can be used multiple times in a single location configuration, as in</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/echo</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">hello</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">world</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>The output on the client side looks like this</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span>$<span class="w"> </span>curl<span class="w"> </span><span class="s1">&#39;http://localhost/echo&#39;</span>
<span class="w"> </span>hello
<span class="w"> </span>world
</code></pre></div>
<p>Special characters like newlines (<code>\n</code>) and tabs (<code>\t</code>) can be escaped using C-style escaping sequences. But a notable exception is the dollar sign (<code>$</code>). As of Nginx 0.8.20, there's still no clean way to escape this character. (A work-around might be to use a <code>$echo_dollor</code> variable that is always evaluated to the constant <code>$</code> character. This feature will possibly be introduced in a future version of this module.)</p>
<p>As of the echo <a href="#v028">v0.28</a> release, one can suppress the trailing newline character in the output by using the <code>-n</code> option, as in</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/echo</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">-n</span><span class="w"> </span><span class="s">&quot;hello,</span><span class="w"> </span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;world&quot;</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>Accessing <code>/echo</code> gives</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span>$<span class="w"> </span>curl<span class="w"> </span><span class="s1">&#39;http://localhost/echo&#39;</span>
<span class="w"> </span>hello,<span class="w"> </span>world
</code></pre></div>
<p>Leading <code>-n</code> in variable values won't take effect and will be emitted literally, as in</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/echo</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">set</span><span class="w"> </span><span class="nv">$opt</span><span class="w"> </span><span class="s">-n</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="nv">$opt</span><span class="w"> </span><span class="s">&quot;hello,&quot;</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;world&quot;</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>This gives the following output</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span>$<span class="w"> </span>curl<span class="w"> </span><span class="s1">&#39;http://localhost/echo&#39;</span>
<span class="w"> </span>-n<span class="w"> </span>hello,
<span class="w"> </span>world
</code></pre></div>
<p>One can output leading <code>-n</code> literals and other options using the special <code>--</code> option like this</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/echo</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">--</span><span class="w"> </span><span class="s">-n</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">an</span><span class="w"> </span><span class="s">option</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>which yields</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span>$<span class="w"> </span>curl<span class="w"> </span><span class="s1">&#39;http://localhost/echo&#39;</span>
<span class="w"> </span>-n<span class="w"> </span>is<span class="w"> </span>an<span class="w"> </span>option
</code></pre></div>
<p>Use this form when you want to output anything leading with a dash (<code>-</code>).</p>
<h2 id="echo_duplicate">echo_duplicate</h2>
<p><strong>syntax:</strong> <em>echo_duplicate &lt;count&gt; &lt;string&gt;</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>content</em></p>
<p>Outputs duplication of a string indicated by the second argument, using the count specified in the first argument.</p>
<p>For instance,</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/dup</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_duplicate</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="s">&quot;abc&quot;</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<p>will lead to the output of <code>"abcabcabc"</code>.</p>
<p>Underscores are allowed in the count number, just like in Perl. For example, to emit 1000,000,000 instances of <code>"hello, world"</code>:</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/many_hellos</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_duplicate</span><span class="w"> </span><span class="s">1000_000_000</span><span class="w"> </span><span class="s">&quot;hello,</span><span class="w"> </span><span class="s">world&quot;</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<p>The <code>count</code> argument could be zero, but not negative. The second <code>string</code> argument could be an empty string ("") likewise.</p>
<p>Unlike the <a href="#echo">echo</a> directive, no trailing newline is appended to the result. So it's possible to "abuse" this directive as a no-trailing-newline version of <a href="#echo">echo</a> by using "count" 1, as in</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/echo_art</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_duplicate</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="s">&#39;---&#39;</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo_duplicate</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="s">&#39;</span><span class="w"> </span><span class="s">END</span><span class="w"> </span><span class="s">&#39;</span><span class="p">;</span><span class="w">  </span><span class="c1"># we don&#39;t want a trailing newline here</span>
<span class="w">       </span><span class="kn">echo_duplicate</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="s">&#39;---&#39;</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo</span><span class="p">;</span><span class="w">  </span><span class="c1"># we want a trailing newline here...</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<p>You get</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span>------<span class="w"> </span>END<span class="w"> </span>------
</code></pre></div>
<p>But use of the <code>-n</code> option in <a href="#echo">echo</a> is more appropriate for this purpose.</p>
<p>This directive was first introduced in <a href="#v011">version 0.11</a>.</p>
<h2 id="echo_flush">echo_flush</h2>
<p><strong>syntax:</strong> <em>echo_flush</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>content</em></p>
<p>Forces the data potentially buffered by underlying Nginx output filters to send immediately to the client side via socket.</p>
<p>Note that techically the command just emits a ngx_buf_t object with <code>flush</code> slot set to 1, so certain weird third-party output filter module could still block it before it reaches Nginx's (last) write filter.</p>
<p>This directive does not take any argument.</p>
<p>Consider the following example:</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/flush</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kn">echo</span><span class="w"> </span><span class="s">hello</span><span class="p">;</span>

<span class="w">      </span><span class="kn">echo_flush</span><span class="p">;</span>

<span class="w">      </span><span class="kn">echo_sleep</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">      </span><span class="kn">echo</span><span class="w"> </span><span class="s">world</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<p>Then on the client side, using curl to access <code>/flush</code>, you'll see the "hello" line immediately, but only after 1 second, the last "world" line. Without calling <code>echo_flush</code> in the example above, you'll most likely see no output until 1 second is elapsed due to the internal buffering of Nginx.</p>
<p>This directive will fail to flush the output buffer in case of subrequests get involved. Consider the following example:</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/main</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_location_async</span><span class="w"> </span><span class="s">/sub</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="s">hello</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo_flush</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/sub</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_sleep</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<p>Then the client won't see "hello" appear even if <code>echo_flush</code> has been executed before the subrequest to <code>/sub</code> has actually started executing. The outputs of <code>/main</code> that are sent <em>after</em> <a href="#echo_location_async">echo_location_async</a> will be postponed and buffered firmly.</p>
<p>This does <em>not</em> apply to outputs sent before the subrequest initiated. For a modified version of the example given above:</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/main</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="s">hello</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo_flush</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo_location_async</span><span class="w"> </span><span class="s">/sub</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/sub</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_sleep</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<p>The client will immediately see "hello" before <code>/sub</code> enters sleeping.</p>
<p>See also <a href="#echo">echo</a>, <a href="#echo_sleep">echo_sleep</a>, and <a href="#echo_location_async">echo_location_async</a>.</p>
<h2 id="echo_sleep">echo_sleep</h2>
<p><strong>syntax:</strong> <em>echo_sleep &lt;seconds&gt;</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>content</em></p>
<p>Sleeps for the time period specified by the argument, which is in seconds.</p>
<p>This operation is non-blocking on server side, so unlike the <a href="#echo_blocking_sleep">echo_blocking_sleep</a> directive, it won't block the whole Nginx worker process.</p>
<p>The period might takes three digits after the decimal point and must be greater than 0.001.</p>
<p>An example is</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="k">location</span><span class="w"> </span><span class="s">/echo_after_sleep</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">echo_sleep</span><span class="w"> </span><span class="mi">1</span><span class="s">.234</span><span class="p">;</span>
<span class="w">        </span><span class="kn">echo</span><span class="w"> </span><span class="s">resumed!</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p>Behind the scene, it sets up a per-request "sleep" ngx_event_t object, and adds a timer using that custom event to the Nginx event model and just waits for a timeout on that event. Because the "sleep" event is per-request, this directive can work in parallel subrequests.</p>
<h2 id="echo_blocking_sleep">echo_blocking_sleep</h2>
<p><strong>syntax:</strong> <em>echo_blocking_sleep &lt;seconds&gt;</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>content</em></p>
<p>This is a blocking version of the <a href="#echo_sleep">echo_sleep</a> directive.</p>
<p>See the documentation of <a href="#echo_sleep">echo_sleep</a> for more detail.</p>
<p>Behind the curtain, it calls the ngx_msleep macro provided by the Nginx core which maps to usleep on POSIX-compliant systems.</p>
<p>Note that this directive will block the current Nginx worker process completely while being executed, so never use it in production environment.</p>
<h2 id="echo_reset_timer">echo_reset_timer</h2>
<p><strong>syntax:</strong> <em>echo_reset_timer</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>content</em></p>
<p>Reset the timer begin time to <em>now</em>, i.e., the time when this command is executed during request.</p>
<p>The timer begin time is default to the starting time of the current request and can be overridden by this directive, potentially multiple times in a single location. For example:</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/timed_sleep</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_sleep</span><span class="w"> </span><span class="mi">0</span><span class="s">.03</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;</span><span class="nv">$echo_timer_elapsed</span><span class="w"> </span><span class="s">sec</span><span class="w"> </span><span class="s">elapsed.&quot;</span><span class="p">;</span>

<span class="w">       </span><span class="kn">echo_reset_timer</span><span class="p">;</span>

<span class="w">       </span><span class="kn">echo_sleep</span><span class="w"> </span><span class="mi">0</span><span class="s">.02</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;</span><span class="nv">$echo_timer_elapsed</span><span class="w"> </span><span class="s">sec</span><span class="w"> </span><span class="s">elapsed.&quot;</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<p>The output on the client side might be</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span>$<span class="w"> </span>curl<span class="w"> </span><span class="s1">&#39;http://localhost/timed_sleep&#39;</span>
<span class="w"> </span><span class="m">0</span>.032<span class="w"> </span>sec<span class="w"> </span>elapsed.
<span class="w"> </span><span class="m">0</span>.020<span class="w"> </span>sec<span class="w"> </span>elapsed.
</code></pre></div>
<p>The actual figures you get on your side may vary a bit due to your system's current activities.</p>
<p>Invocation of this directive will force the underlying Nginx timer to get updated to the current system time (regardless the timer resolution specified elsewhere in the config file). Furthermore, references of the <a href="#echo_timer_elapsed">$echo_timer_elapsed</a> variable will also trigger timer update forcibly.</p>
<p>See also <a href="#echo_sleep">echo_sleep</a> and <a href="#echo_timer_elapsed">$echo_timer_elapsed</a>.</p>
<h2 id="echo_read_request_body">echo_read_request_body</h2>
<p><strong>syntax:</strong> <em>echo_read_request_body</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>content</em></p>
<p>Explicitly reads request body so that the <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_request_body">$request_body</a> variable will always have non-empty values (unless the body is so big that it has been saved by Nginx to a local temporary file).</p>
<p>Note that this might not be the original client request body because the current request might be a subrequest with a "artificial" body specified by its parent.</p>
<p>This directive does not generate any output itself, just like <a href="#echo_sleep">echo_sleep</a>.</p>
<p>Here's an example for echo'ing back the original <abbr title="Hyper Text Transfer Protocol">HTTP</abbr> client request (both headers and body are included):</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/echoback</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_duplicate</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">$echo_client_request_headers</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;\r&quot;</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo_read_request_body</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="nv">$request_body</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<p>The content of <code>/echoback</code> looks like this on my side (I was using Perl's LWP utility to access this location on the server):</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span>$<span class="w"> </span><span class="o">(</span><span class="nb">echo</span><span class="w"> </span>hello<span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>world<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>lwp-request<span class="w"> </span>-m<span class="w"> </span>POST<span class="w"> </span><span class="s1">&#39;http://localhost/echoback&#39;</span>
<span class="w">   </span>POST<span class="w"> </span>/echoback<span class="w"> </span>HTTP/1.1
<span class="w">   </span>TE:<span class="w"> </span>deflate,gzip<span class="p">;</span><span class="nv">q</span><span class="o">=</span><span class="m">0</span>.3
<span class="w">   </span>Connection:<span class="w"> </span>TE,<span class="w"> </span>close
<span class="w">   </span>Host:<span class="w"> </span>localhost
<span class="w">   </span>User-Agent:<span class="w"> </span>lwp-request/5.818<span class="w"> </span>libwww-perl/5.820
<span class="w">   </span>Content-Length:<span class="w"> </span><span class="m">12</span>
<span class="w">   </span>Content-Type:<span class="w"> </span>application/x-www-form-urlencoded

<span class="w">   </span>hello
<span class="w">   </span>world
</code></pre></div>
<p>Because <code>/echoback</code> is the main request, <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_request_body">$request_body</a> holds the original client request body.</p>
<p>Before Nginx 0.7.56, it makes no sense to use this directive because <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_request_body">$request_body</a> was first introduced in Nginx 0.7.58.</p>
<p>This directive itself was first introduced in the echo module's <a href="#v014">v0.14 release</a>.</p>
<h2 id="echo_location_async">echo_location_async</h2>
<p><strong>syntax:</strong> <em>echo_location_async &lt;location&gt; [&lt;url_args&gt;]</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>content</em></p>
<p>Issue GET subrequest to the location specified (first argument) with optional url arguments specified in the second argument.</p>
<p>As of Nginx 0.8.20, the <code>location</code> argument does <em>not</em> support named location, due to a limitation in the <code>ngx_http_subrequest</code> function. The same is true for its brother, the <a href="#echo_location">echo_location</a> directive.</p>
<p>A very simple example is</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/main</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_location_async</span><span class="w"> </span><span class="s">/sub</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">world</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
<span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/sub</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">hello</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>Accessing <code>/main</code> gets</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span>hello
<span class="w">   </span>world
</code></pre></div>
<p>Calling multiple locations in parallel is also possible:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/main</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_reset_timer</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo_location_async</span><span class="w"> </span><span class="s">/sub1</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo_location_async</span><span class="w"> </span><span class="s">/sub2</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;took</span><span class="w"> </span><span class="nv">$echo_timer_elapsed</span><span class="w"> </span><span class="s">sec</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">total.&quot;</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
<span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/sub1</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_sleep</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="c1"># sleeps 2 sec</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">hello</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
<span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/sub2</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_sleep</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1"># sleeps 1 sec</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">world</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>Accessing <code>/main</code> yields</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span>$<span class="w"> </span><span class="nb">time</span><span class="w"> </span>curl<span class="w"> </span><span class="s1">&#39;http://localhost/main&#39;</span>
<span class="w">   </span>hello
<span class="w">   </span>world
<span class="w">   </span>took<span class="w"> </span><span class="m">0</span>.000<span class="w"> </span>sec<span class="w"> </span><span class="k">for</span><span class="w"> </span>total.

<span class="w">   </span>real<span class="w">  </span>0m2.006s
<span class="w">   </span>user<span class="w">  </span>0m0.000s
<span class="w">   </span>sys<span class="w">   </span>0m0.004s
</code></pre></div>
<p>You can see that the main handler <code>/main</code> does <em>not</em> wait the subrequests <code>/sub1</code> and <code>/sub2</code> to complete and quickly goes on, hence the "0.000 sec" timing result. The whole request, however takes approximately 2 sec in total to complete because <code>/sub1</code> and <code>/sub2</code> run in parallel (or "concurrently" to be more accurate).</p>
<p>If you use <a href="#echo_blocking_sleep">echo_blocking_sleep</a> in the previous example instead, then you'll get the same output, but with 3 sec total response time, because "blocking sleep" blocks the whole Nginx worker process.</p>
<p>Locations can also take an optional querystring argument, for instance</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/main</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_location_async</span><span class="w"> </span><span class="s">/sub</span><span class="w"> </span><span class="s">&#39;foo=Foo&amp;bar=Bar&#39;</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
<span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/sub</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="nv">$arg_foo</span><span class="w"> </span><span class="nv">$arg_bar</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>Accessing <code>/main</code> yields</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span>$<span class="w"> </span>curl<span class="w"> </span><span class="s1">&#39;http://localhost/main&#39;</span>
<span class="w">   </span>Foo<span class="w"> </span>Bar
</code></pre></div>
<p>Querystrings is <em>not</em> allowed to be concatenated onto the <code>location</code> argument with "?" directly, for example, <code>/sub?foo=Foo&amp;bar=Bar</code> is an invalid location, and shouldn't be fed as the first argument to this directive.</p>
<p>Technically speaking, this directive is an example that Nginx content handler issues one or more subrequests directly. AFAIK, the <a href="https://connectical.com/projects/ngx-fancyindex/wiki">fancyindex module</a> also does such kind of things ;)</p>
<p>Nginx named locations like <code>@foo</code> is <em>not</em> supported here.</p>
<p>This directive is logically equivalent to the GET version of <a href="#echo_subrequest_async">echo_subrequest_async</a>. For example,</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">echo_location_async</span><span class="w"> </span><span class="s">/foo</span><span class="w"> </span><span class="s">&#39;bar=Bar&#39;</span><span class="p">;</span>
</code></pre></div>
<p>is logically equivalent to</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">echo_subrequest_async</span><span class="w"> </span><span class="s">GET</span><span class="w"> </span><span class="s">/foo</span><span class="w"> </span><span class="s">-q</span><span class="w"> </span><span class="s">&#39;bar=Bar&#39;</span><span class="p">;</span>
</code></pre></div>
<p>But calling this directive is slightly faster than calling <a href="#echo_subrequest_async">echo_subrequest_async</a> using <code>GET</code> because we don't have to parse the <abbr title="Hyper Text Transfer Protocol">HTTP</abbr> method names like <code>GET</code> and options like <code>-q</code>.</p>
<p>This directive is first introduced in <a href="#v009">version 0.09</a> of this module and requires at least Nginx 0.7.46.</p>
<h2 id="echo_location">echo_location</h2>
<p><strong>syntax:</strong> <em>echo_location &lt;location&gt; [&lt;url_args&gt;]</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>content</em></p>
<p>Just like the <a href="#echo_location_async">echo_location_async</a> directive, but <code>echo_location</code> issues subrequests <em>in series</em> rather than in parallel. That is, the content handler directives following this directive won't be executed until the subrequest issued by this directive completes.</p>
<p>The final response body is almost always equivalent to the case when <a href="#echo_location_async">echo_location_async</a> is used instead, only if timing variables is used in the outputs.</p>
<p>Consider the following example:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/main</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_reset_timer</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo_location</span><span class="w"> </span><span class="s">/sub1</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo_location</span><span class="w"> </span><span class="s">/sub2</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;took</span><span class="w"> </span><span class="nv">$echo_timer_elapsed</span><span class="w"> </span><span class="s">sec</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">total.&quot;</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
<span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/sub1</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_sleep</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">hello</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
<span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/sub2</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_sleep</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">world</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>The location <code>/main</code> above will take for total 3 sec to complete (compared to 2 sec if <a href="#echo_location_async">echo_location_async</a> is used instead here). Here's the result in action on my machine:</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span>$<span class="w"> </span>curl<span class="w"> </span><span class="s1">&#39;http://localhost/main&#39;</span>
<span class="w">   </span>hello
<span class="w">   </span>world
<span class="w">   </span>took<span class="w"> </span><span class="m">3</span>.003<span class="w"> </span>sec<span class="w"> </span><span class="k">for</span><span class="w"> </span>total.

<span class="w">   </span>real<span class="w">  </span>0m3.027s
<span class="w">   </span>user<span class="w">  </span>0m0.020s
<span class="w">   </span>sys<span class="w">   </span>0m0.004s
</code></pre></div>
<p>This directive is logically equivalent to the GET version of <a href="#echo_subrequest">echo_subrequest</a>. For example,</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">echo_location</span><span class="w"> </span><span class="s">/foo</span><span class="w"> </span><span class="s">&#39;bar=Bar&#39;</span><span class="p">;</span>
</code></pre></div>
<p>is logically equivalent to</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">echo_subrequest</span><span class="w"> </span><span class="s">GET</span><span class="w"> </span><span class="s">/foo</span><span class="w"> </span><span class="s">-q</span><span class="w"> </span><span class="s">&#39;bar=Bar&#39;</span><span class="p">;</span>
</code></pre></div>
<p>But calling this directive is slightly faster than calling <a href="#echo_subrequest">echo_subrequest</a> using <code>GET</code> because we don't have to parse the <abbr title="Hyper Text Transfer Protocol">HTTP</abbr> method names like <code>GET</code> and options like <code>-q</code>.</p>
<p>Behind the scene, it creates an <code>ngx_http_post_subrequest_t</code> object as a <em>continuation</em> and passes it into the <code>ngx_http_subrequest</code> function call. Nginx will later reopen this "continuation" in the subrequest's <code>ngx_http_finalize_request</code> function call. We resumes the execution of the parent-request's content handler and starts to run the next directive (command) if any.</p>
<p>Nginx named locations like <code>@foo</code> is <em>not</em> supported here.</p>
<p>This directive was first introduced in the <a href="#v012">release v0.12</a>.</p>
<p>See also <a href="#echo_location_async">echo_location_async</a> for more details about the meaning of the arguments.</p>
<h2 id="echo_subrequest_async">echo_subrequest_async</h2>
<p><strong>syntax:</strong> <em>echo_subrequest_async &lt;HTTP_method&gt; &lt;location&gt; [-q &lt;url_args&gt;] [-b &lt;request_body&gt;] [-f &lt;request_body_path&gt;]</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>content</em></p>
<p>Initiate an asynchronous subrequest using <abbr title="Hyper Text Transfer Protocol">HTTP</abbr> method, an optional url arguments (or querystring) and an optional request body which can be defined as a string or as a path to a file which contains the body.</p>
<p>This directive is very much like a generalized version of the <a href="#echo_location_async">echo_location_async</a> directive.</p>
<p>Here's a small example demonstrating its usage:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/multi</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="c1"># body defined as string</span>
<span class="w">     </span><span class="kn">echo_subrequest_async</span><span class="w"> </span><span class="s">POST</span><span class="w"> </span><span class="s">&#39;/sub&#39;</span><span class="w"> </span><span class="s">-q</span><span class="w"> </span><span class="s">&#39;foo=Foo&#39;</span><span class="w"> </span><span class="s">-b</span><span class="w"> </span><span class="s">&#39;hi&#39;</span><span class="p">;</span>
<span class="w">     </span><span class="c1"># body defined as path to a file, relative to nginx prefix path if not absolute</span>
<span class="w">     </span><span class="kn">echo_subrequest_async</span><span class="w"> </span><span class="s">PUT</span><span class="w"> </span><span class="s">&#39;/sub&#39;</span><span class="w"> </span><span class="s">-q</span><span class="w"> </span><span class="s">&#39;bar=Bar&#39;</span><span class="w"> </span><span class="s">-f</span><span class="w"> </span><span class="s">&#39;/tmp/hello.txt&#39;</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
<span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/sub</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;querystring:</span><span class="w"> </span><span class="nv">$query_string&quot;</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;method:</span><span class="w"> </span><span class="nv">$echo_request_method&quot;</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;body:</span><span class="w"> </span><span class="nv">$echo_request_body&quot;</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;content</span><span class="w"> </span><span class="s">length:</span><span class="w"> </span><span class="nv">$http_content_length&quot;</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&#39;///&#39;</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>Then on the client side:</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span>hello<span class="w"> </span>&gt;<span class="w"> </span>/tmp/hello.txt
<span class="w">   </span>$<span class="w"> </span>curl<span class="w"> </span><span class="s1">&#39;http://localhost/multi&#39;</span>
<span class="w">   </span>querystring:<span class="w"> </span><span class="nv">foo</span><span class="o">=</span>Foo
<span class="w">   </span>method:<span class="w"> </span>POST
<span class="w">   </span>body:<span class="w"> </span>hi
<span class="w">   </span>content<span class="w"> </span>length:<span class="w"> </span><span class="m">2</span>
<span class="w">   </span>///
<span class="w">   </span>querystring:<span class="w"> </span><span class="nv">bar</span><span class="o">=</span>Bar
<span class="w">   </span>method:<span class="w"> </span>PUT
<span class="w">   </span>body:<span class="w"> </span>hello
<span class="w">   </span>content<span class="w"> </span>length:<span class="w"> </span><span class="m">5</span>
<span class="w">   </span>///
</code></pre></div>
<p>Here's more funny example using the standard <a href="#httpproxymodule">proxy module</a> to handle the subrequest:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/main</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_subrequest_async</span><span class="w"> </span><span class="s">POST</span><span class="w"> </span><span class="s">/sub</span><span class="w"> </span><span class="s">-b</span><span class="w"> </span><span class="s">&#39;hello,</span><span class="w"> </span><span class="s">world&#39;</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
<span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/sub</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="nv">$scheme://127.0.0.1:$server_port/proxied</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
<span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/proxied</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;method:</span><span class="w"> </span><span class="nv">$echo_request_method.&quot;</span><span class="p">;</span>

<span class="w">     </span><span class="c1"># we need to read body explicitly here...or $echo_request_body</span>
<span class="w">     </span><span class="c1">#   will evaluate to empty (&quot;&quot;)</span>
<span class="w">     </span><span class="kn">echo_read_request_body</span><span class="p">;</span>

<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;body:</span><span class="w"> </span><span class="nv">$echo_request_body.&quot;</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>Then on the client side, we can see that</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span>$<span class="w"> </span>curl<span class="w"> </span><span class="s1">&#39;http://localhost/main&#39;</span>
<span class="w">   </span>method:<span class="w"> </span>POST.
<span class="w">   </span>body:<span class="w"> </span>hello,<span class="w"> </span>world.
</code></pre></div>
<p>Nginx named locations like <code>@foo</code> is <em>not</em> supported here.</p>
<p>This directive takes several options:</p>
<div class="highlight"><pre><span></span><code>-q &lt;url_args&gt;        Specify the URL arguments (or URL querystring) for the subrequest.

-f &lt;path&gt;            Specify the path for the file whose content will be serve as the
                     subrequest&#39;s request body.

-b &lt;data&gt;            Specify the request body data
</code></pre></div>
<p>This directive was first introduced in the <a href="#v015">release v0.15</a>.</p>
<p>The <code>-f</code> option to define a file path for the body was introduced in the <a href="#v035">release v0.35</a>.</p>
<p>See also the <a href="#echo_subrequest">echo_subrequest</a> and <a href="#echo_location_async">echo_location_async</a> directives.</p>
<h2 id="echo_subrequest">echo_subrequest</h2>
<p><strong>syntax:</strong> <em>echo_subrequest &lt;HTTP_method&gt; &lt;location&gt; [-q &lt;url_args&gt;] [-b &lt;request_body&gt;] [-f &lt;request_body_path&gt;]</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>content</em></p>
<p>This is the synchronous version of the <a href="#echo_subrequest_async">echo_subrequest_async</a> directive. And just like <a href="#echo_location">echo_location</a>, it does not block the Nginx worker process (while <a href="#echo_blocking_sleep">echo_blocking_sleep</a> does), rather, it uses continuation to pass control along the subrequest chain.</p>
<p>See <a href="#echo_subrequest_async">echo_subrequest_async</a> for more details.</p>
<p>Nginx named locations like <code>@foo</code> is <em>not</em> supported here.</p>
<p>This directive was first introduced in the <a href="#v015">release v0.15</a>.</p>
<h2 id="echo_foreach_split">echo_foreach_split</h2>
<p><strong>syntax:</strong> <em>echo_foreach_split &lt;delimiter&gt; &lt;string&gt;</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>content</em></p>
<p>Split the second argument <code>string</code> using the delimiter specified in the first argument, and then iterate through the resulting items. For instance:</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/loop</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_foreach_split</span><span class="w"> </span><span class="s">&#39;,&#39;</span><span class="w"> </span><span class="nv">$arg_list</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;item:</span><span class="w"> </span><span class="nv">$echo_it&quot;</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo_end</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<p>Accessing /main yields</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span>$<span class="w"> </span>curl<span class="w"> </span><span class="s1">&#39;http://localhost/loop?list=cat,dog,mouse&#39;</span>
<span class="w">   </span>item:<span class="w"> </span>cat
<span class="w">   </span>item:<span class="w"> </span>dog
<span class="w">   </span>item:<span class="w"> </span>mouse
</code></pre></div>
<p>As seen in the previous example, this directive should always be accompanied by an <a href="#echo_end">echo_end</a> directive.</p>
<p>Parallel <code>echo_foreach_split</code> loops are allowed, but nested ones are currently forbidden.</p>
<p>The <code>delimiter</code> argument could contain <em>multiple</em> arbitrary characters, like</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="c1"># this outputs &quot;cat\ndog\nmouse\n&quot;</span>
<span class="w">   </span><span class="k">echo_foreach_split</span><span class="w"> </span><span class="s">--</span><span class="w"> </span><span class="s">&#39;-a-&#39;</span><span class="w"> </span><span class="s">&#39;cat-a-dog-a-mouse&#39;</span><span class="p">;</span>
<span class="w">     </span><span class="k">echo</span><span class="w"> </span><span class="nv">$echo_it</span><span class="p">;</span>
<span class="w">   </span><span class="k">echo_end</span><span class="p">;</span>
</code></pre></div>
<p>Logically speaking, this looping structure is just the <code>foreach</code> loop combined with a <code>split</code> function call in Perl (using the previous example):</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="nb">split</span><span class="w"> </span><span class="s">&#39;,&#39;</span><span class="p">,</span><span class="w"> </span><span class="nv">$arg_list</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;item $_\n&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p>People will also find it useful in merging multiple <code>.js</code> or <code>.css</code> resources into a whole. Here's an example:</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/merge</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">default_type</span><span class="w"> </span><span class="s">&#39;text/javascript&#39;</span><span class="p">;</span>

<span class="w">       </span><span class="kn">echo_foreach_split</span><span class="w"> </span><span class="s">&#39;&amp;&#39;</span><span class="w"> </span><span class="nv">$query_string</span><span class="p">;</span>
<span class="w">           </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;/*</span><span class="w"> </span><span class="s">JS</span><span class="w"> </span><span class="s">File</span><span class="w"> </span><span class="nv">$echo_it</span><span class="w"> </span><span class="s">*/&quot;</span><span class="p">;</span>
<span class="w">           </span><span class="kn">echo_location_async</span><span class="w"> </span><span class="nv">$echo_it</span><span class="p">;</span>
<span class="w">           </span><span class="kn">echo</span><span class="p">;</span>
<span class="w">       </span><span class="kn">echo_end</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<p>Then accessing /merge to merge the <code>.js</code> resources specified in the query string:</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span>$<span class="w"> </span>curl<span class="w"> </span><span class="s1">&#39;http://localhost/merge?/foo/bar.js&amp;/yui/blah.js&amp;/baz.js&#39;</span>
</code></pre></div>
<p>One can also use third-party Nginx cache module to cache the merged response generated by the <code>/merge</code> location in the previous example.</p>
<p>This directive was first introduced in the <a href="#v017">release v0.17</a>.</p>
<h2 id="echo_end">echo_end</h2>
<p><strong>syntax:</strong> <em>echo_end</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>content</em></p>
<p>This directive is used to terminate the body of looping and conditional control structures like <a href="#echo_foreach_split">echo_foreach_split</a>.</p>
<p>This directive was first introduced in the <a href="#v017">release v0.17</a>.</p>
<h2 id="echo_request_body">echo_request_body</h2>
<p><strong>syntax:</strong> <em>echo_request_body</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>content</em></p>
<p>Outputs the contents of the request body previous read.</p>
<p>Behind the scene, it's implemented roughly like this:</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">request_body</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">r</span><span class="o">-&gt;</span><span class="n">request_body</span><span class="o">-&gt;</span><span class="n">bufs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="k">return</span><span class="w"> </span><span class="n">ngx_http_output_filter</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="o">-&gt;</span><span class="n">request_body</span><span class="o">-&gt;</span><span class="n">bufs</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<p>Unlike the <a href="#echo_request_body">$echo_request_body</a> and $request_body variables, this directive will show the whole request body even if some parts or all parts of it are saved in temporary files on the disk.</p>
<p>It is a "no-op" if no request body has been read yet.</p>
<p>This directive was first introduced in the <a href="#v018">release v0.18</a>.</p>
<p>See also <a href="#echo_read_request_body">echo_read_request_body</a> and the <a href="http://github.com/agentzh/chunkin-nginx-module">chunkin module</a>.</p>
<h2 id="echo_exec">echo_exec</h2>
<p><strong>syntax:</strong> <em>echo_exec &lt;location&gt; [&lt;query_string&gt;]</em></p>
<p><strong>syntax:</strong> <em>echo_exec &lt;named_location&gt;</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>content</em></p>
<p>Does an internal redirect to the location specified. An optional query string can be specified for normal locations, as in</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/foo</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_exec</span><span class="w"> </span><span class="s">/bar</span><span class="w"> </span><span class="s">weight=5</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/bar</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="nv">$arg_weight</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<p>Or equivalently</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/foo</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_exec</span><span class="w"> </span><span class="s">/bar?weight=5</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/bar</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="nv">$arg_weight</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<p>Named locations are also supported. Here's an example:</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/foo</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">echo_exec</span><span class="w"> </span><span class="s">@bar</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">@bar</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="c1"># you&#39;ll get /foo rather than @bar</span>
<span class="w">       </span><span class="c1">#  due to a potential bug in nginx.</span>
<span class="w">       </span><span class="kn">echo</span><span class="w"> </span><span class="nv">$echo_request_uri</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<p>But query string (if any) will always be ignored for named location redirects due to a limitation in the <code>ngx_http_named_location</code> function.</p>
<p>Never try to echo things before the <code>echo_exec</code> directive or you won't see the proper response of the location you want to redirect to. Because any echoing will cause the original location handler to send <abbr title="Hyper Text Transfer Protocol">HTTP</abbr> headers before the redirection happens.</p>
<p>Technically speaking, this directive exposes the Nginx internal API functions <code>ngx_http_internal_redirect</code> and <code>ngx_http_named_location</code>.</p>
<p>This directive was first introduced in the <a href="#v021">v0.21 release</a>.</p>
<h2 id="echo_status">echo_status</h2>
<p><strong>syntax:</strong> <em>echo_status &lt;status-num&gt;</em></p>
<p><strong>default:</strong> <em>echo_status 200</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>content</em></p>
<p>Specify the default response status code. Default to <code>200</code>. This directive is declarative and the relative order with other echo-like directives is not important.</p>
<p>Here is an example,</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">/bad</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_status</span><span class="w"> </span><span class="mi">404</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;Something</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">missing...&quot;</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>then we get a response like this:</p>
<div class="highlight"><pre><span></span><code>HTTP/1.1 404 Not Found
Server: nginx/1.2.1
Date: Sun, 24 Jun 2012 03:58:18 GMT
Content-Type: text/plain
Transfer-Encoding: chunked
Connection: keep-alive

Something is missing...
</code></pre></div>
<p>This directive was first introduced in the <code>v0.40</code> release.</p>
<h2 id="filter-directives">Filter Directives</h2>
<p>Use of the following directives trigger the filter registration of this module. By default, no filter will be registered by this module.</p>
<p>Every filter directive supports variable interpolation in its arguments (if any).</p>
<h2 id="echo_before_body">echo_before_body</h2>
<p><strong>syntax:</strong> <em>echo_before_body [options] [argument]...</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>output filter</em></p>
<p>It's the filter version of the <a href="#echo">echo</a> directive, and prepends its output to the beginning of the original outputs generated by the underlying content handler.</p>
<p>An example is</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/echo</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_before_body</span><span class="w"> </span><span class="s">hello</span><span class="p">;</span>
<span class="w">     </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="nv">$scheme://127.0.0.1:$server_port$request_uri/more</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
<span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/echo/more</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">world</span>
<span class="w"> </span><span class="err">}</span>
</code></pre></div>
<p>Accessing <code>/echo</code> from the client side yields</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span>hello
<span class="w">   </span>world
</code></pre></div>
<p>In the previous sample, we borrow the <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html">standard proxy module</a> to serve as the underlying content handler that generates the "main contents".</p>
<p>Multiple instances of this filter directive are also allowed, as in:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/echo</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_before_body</span><span class="w"> </span><span class="s">hello</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo_before_body</span><span class="w"> </span><span class="s">world</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">!</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>On the client side, the output is like</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span>$<span class="w"> </span>curl<span class="w"> </span><span class="s1">&#39;http://localhost/echo&#39;</span>
<span class="w">   </span>hello
<span class="w">   </span>world
<span class="w">   </span>!
</code></pre></div>
<p>In this example, we also use the <a href="#content-handler-directives">content handler directives</a> provided by this module as the underlying content handler.</p>
<p>This directive also supports the <code>-n</code> and <code>--</code> options like the <a href="#echo">echo</a> directive.</p>
<p>This directive can be mixed with its brother directive <a href="#echo_after_body">echo_after_body</a>.</p>
<h2 id="echo_after_body">echo_after_body</h2>
<p><strong>syntax:</strong> <em>echo_after_body [argument]...</em></p>
<p><strong>default:</strong> <em>no</em></p>
<p><strong>context:</strong> <em>location, location if</em></p>
<p><strong>phase:</strong> <em>output filter</em></p>
<p>It's very much like the <a href="#echo_before_body">echo_before_body</a> directive, but <em>appends</em> its output to the end of the original outputs generated by the underlying content handler.</p>
<p>Here's a simple example:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/echo</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_after_body</span><span class="w"> </span><span class="s">hello</span><span class="p">;</span>
<span class="w">     </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://127.0.0.1:</span><span class="nv">$server_port$request_uri/more</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
<span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/echo/more</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">world</span>
<span class="w"> </span><span class="err">}</span>
</code></pre></div>
<p>Accessing <code>/echo</code> from the client side yields</p>
<div class="highlight"><pre><span></span><code>  world
  hello
</code></pre></div>
<p>Multiple instances are allowed, as in:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/echo</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo_after_body</span><span class="w"> </span><span class="s">hello</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo_after_body</span><span class="w"> </span><span class="s">world</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">i</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">say</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>The output on the client side while accessing the <code>/echo</code> location looks like</p>
<div class="highlight"><pre><span></span><code>  i
  say
  hello
  world
</code></pre></div>
<p>This directive also supports the <code>-n</code> and <code>--</code> options like the <a href="#echo">echo</a> directive.</p>
<p>This directive can be mixed with its brother directive <a href="#echo_before_body">echo_before_body</a>.</p>
<h2 id="variables">Variables</h2>
<h2 id="echo_it">$echo_it</h2>
<p>This is a "topic variable" used by <a href="#echo_foreach_split">echo_foreach_split</a>, just like the <code>$_</code> variable in Perl.</p>
<h2 id="echo_timer_elapsed">$echo_timer_elapsed</h2>
<p>This variable holds the seconds elapsed since the start of the current request (might be a subrequest though) or the last invocation of the <a href="#echo_reset_timer">echo_reset_timer</a> command.</p>
<p>The timing result takes three digits after the decimal point.</p>
<p>References of this variable will force the underlying Nginx timer to update to the current system time, regardless the timer resolution settings elsewhere in the config file, just like the <a href="#echo_reset_timer">echo_reset_timer</a> directive.</p>
<h2 id="echo_request_body_1">$echo_request_body</h2>
<p>Evaluates to the current (sub)request's request body previously read if no part of the body has been saved to a temporary file. To always show the request body even if it's very large, use the <a href="#echo_request_body">echo_request_body</a> directive.</p>
<h2 id="echo_request_method">$echo_request_method</h2>
<p>Evaluates to the <abbr title="Hyper Text Transfer Protocol">HTTP</abbr> request method of the current request (it can be a subrequest).</p>
<p>Behind the scene, it just takes the string data stored in <code>r-&gt;method_name</code>.</p>
<p>Compare it to the <a href="#echo_client_request_method">$echo_client_request_method</a> variable.</p>
<p>At least for Nginx 0.8.20 and older, the <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_request_method">$request_method</a> variable provided by the <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html">http core module</a> is actually doing what our <a href="#echo_client_request_method">$echo_client_request_method</a> is doing.</p>
<p>This variable was first introduced in our <a href="#v015">v0.15 release</a>.</p>
<h2 id="echo_client_request_method">$echo_client_request_method</h2>
<p>Always evaluates to the main request's <abbr title="Hyper Text Transfer Protocol">HTTP</abbr> method even if the current request is a subrequest.</p>
<p>Behind the scene, it just takes the string data stored in <code>r-&gt;main-&gt;method_name</code>.</p>
<p>Compare it to the <a href="#echo_request_method">$echo_request_method</a> variable.</p>
<p>This variable was first introduced in our <a href="#v015">v0.15 release</a>.</p>
<h2 id="echo_client_request_headers">$echo_client_request_headers</h2>
<p>Evaluates to the original client request's headers.</p>
<p>Just as the name suggests, it will always take the main request (or the client request) even if it's currently executed in a subrequest.</p>
<p>A simple example is below:</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">location</span><span class="w"> </span><span class="s">/echoback</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;headers</span><span class="w"> </span><span class="s">are:&quot;</span>
<span class="w">      </span><span class="s">echo</span><span class="w"> </span><span class="nv">$echo_client_request_headers</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<p>Accessing <code>/echoback</code> yields</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span>$<span class="w"> </span>curl<span class="w"> </span><span class="s1">&#39;http://localhost/echoback&#39;</span>
<span class="w">   </span>headers<span class="w"> </span>are
<span class="w">   </span>GET<span class="w"> </span>/echoback<span class="w"> </span>HTTP/1.1
<span class="w">   </span>User-Agent:<span class="w"> </span>curl/7.18.2<span class="w"> </span><span class="o">(</span>i486-pc-linux-gnu<span class="o">)</span><span class="w"> </span>libcurl/7.18.2<span class="w"> </span>OpenSSL/0.9.8g
<span class="w">   </span>Host:<span class="w"> </span>localhost:1984
<span class="w">   </span>Accept:<span class="w"> </span>*/*
</code></pre></div>
<p>Behind the scene, it recovers <code>r-&gt;main-&gt;header_in</code> (or the large header buffers, if any) on the C level and does not construct the headers itself by traversing parsed results in the request object.</p>
<p>This varible is always evaluated to an empty value in <abbr title="Hyper Text Transfer Protocol">HTTP</abbr>/2 requests for now due to the current implementation.</p>
<p>This variable was first introduced in <a href="#v015">version 0.15</a>.</p>
<h2 id="echo_cacheable_request_uri">$echo_cacheable_request_uri</h2>
<p>Evaluates to the parsed form of the URI (usually led by <code>/</code>) of the current (sub-)request. Unlike the <a href="#echo_request_uri">$echo_request_uri</a> variable, it is cacheable.</p>
<p>See <a href="#echo_request_uri">$echo_request_uri</a> for more details.</p>
<p>This variable was first introduced in <a href="#v017">version 0.17</a>.</p>
<h2 id="echo_request_uri">$echo_request_uri</h2>
<p>Evaluates to the parsed form of the URI (usually led by <code>/</code>) of the current (sub-)request. Unlike the <a href="#echo_cacheable_request_uri">$echo_cacheable_request_uri</a> variable, it is <em>not</em> cacheable.</p>
<p>This is quite different from the <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_request_uri">$request_uri</a> variable exported by the <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html">ngx_http_core_module</a>, because <code>$request_uri</code> is the <em>unparsed</em> form of the current request's URI.</p>
<p>This variable was first introduced in <a href="#v017">version 0.17</a>.</p>
<h2 id="echo_incr">$echo_incr</h2>
<p>It is a counter that always generate the current counting number, starting from 1. The counter is always associated with the main request even if it is accessed within a subrequest.</p>
<p>Consider the following example</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/main</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;main</span><span class="w"> </span><span class="s">pre:</span><span class="w"> </span><span class="nv">$echo_incr&quot;</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo_location_async</span><span class="w"> </span><span class="s">/sub</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo_location_async</span><span class="w"> </span><span class="s">/sub</span><span class="p">;</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;main</span><span class="w"> </span><span class="s">post:</span><span class="w"> </span><span class="nv">$echo_incr&quot;</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
<span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="s">/sub</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="kn">echo</span><span class="w"> </span><span class="s">&quot;sub:</span><span class="w"> </span><span class="nv">$echo_incr&quot;</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>Accessing <code>/main</code> yields</p>
<div class="highlight"><pre><span></span><code>main pre: 1
sub: 3
sub: 4
main post: 2
</code></pre></div>
<p>This directive was first introduced in the <a href="#v018">v0.18 release</a>.</p>
<h2 id="echo_response_status">$echo_response_status</h2>
<p>Evaluates to the status code of the current (sub)request, null if not any.</p>
<p>Behind the scene, it's just the textual representation of <code>r-&gt;headers_out-&gt;status</code>.</p>
<p>This directive was first introduced in the <a href="#v023">v0.23 release</a>.</p>
<h2 id="modules-that-use-this-module-for-testing">Modules that use this module for testing</h2>
<p>The following modules take advantage of this <code>echo</code> module in their test suite:</p>
<ul>
<li>The <a href="http://github.com/openresty/memc-nginx-module">memc</a> module that supports almost the whole memcached TCP protocol.</li>
<li>The <a href="http://github.com/agentzh/chunkin-nginx-module">chunkin</a> module that adds <abbr title="Hyper Text Transfer Protocol">HTTP</abbr> 1.1 chunked input support to Nginx.</li>
<li>The <a href="http://github.com/openresty/headers-more-nginx-module">headers_more</a> module that allows you to add, set, and clear input and output headers under the conditions that you specify.</li>
<li>The <code>echo</code> module itself.</li>
</ul>
<p>Please mail me other modules that use <code>echo</code> in any form and I'll add them to the list above :)</p>
<h2 id="changes">Changes</h2>
<p>The changes of every release of this module can be obtained from the OpenResty bundle's change logs:</p>
<p><a href="http://openresty.org/#Changes">http://openresty.org/#Changes</a></p>
<h2 id="test-suite">Test Suite</h2>
<p>This module comes with a Perl-driven test suite. The <a href="https://github.com/openresty/echo-nginx-module/tree/master/t/">test cases</a> are
<a href="https://github.com/openresty/echo-nginx-module/blob/master/t/echo.t">declarative</a> too. Thanks to the <a href="http://search.cpan.org/perldoc?Test::Nginx">Test::Nginx</a> module in the Perl world.</p>
<p>To run it on your side:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span>$<span class="w"> </span><span class="nv">PATH</span><span class="o">=</span>/path/to/your/nginx-with-echo-module:<span class="nv">$PATH</span><span class="w"> </span>prove<span class="w"> </span>-r<span class="w"> </span>t
</code></pre></div>
<p>You need to terminate any Nginx processes before running the test suite if you have changed the Nginx server binary.</p>
<p>Because a single nginx server (by default, <code>localhost:1984</code>) is used across all the test scripts (<code>.t</code> files), it's meaningless to run the test suite in parallel by specifying <code>-jN</code> when invoking the <code>prove</code> utility.</p>
<p>Some parts of the test suite requires standard modules <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html">proxy</a>, <a href="http://nginx.org/en/docs/http/ngx_http_rewrite_module.html">rewrite</a> and <a href="http://nginx.org/en/docs/http/ngx_http_ssi_module.html">SSI</a> to be enabled as well when building Nginx.</p>
<h2 id="see-also">See Also</h2>
<ul>
<li>The original <a href="http://agentzh.blogspot.com/2009/10/hacking-on-nginx-echo-module.html">blog post</a> about this module's initial development.</li>
<li>The standard <a href="http://nginx.org/en/docs/http/ngx_http_addition_module.html">addition filter module</a>.</li>
<li>The standard <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html">proxy module</a>.</li>
<li>The <a href="http://openresty.org">OpenResty</a> bundle.</li>
</ul>
<h2 id="github">GitHub</h2>
<p>You may find additional configuration tips and documentation for this module in the <a href="https://github.com/openresty/echo-nginx-module" target="_blank">GitHub 
repository for 
nginx-module-echo</a>.</p>







  
  



  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2014 - 2023 GetPageSpeed LLC 2023
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/GetPageSpeed" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/GetPageSpeed" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/getpagespeed" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.facebook.com/getpagespeed/" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://t.me/GetPageSpeed" target="_blank" rel="noopener" title="t.me" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8Zm114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452 0 0 1 3.53 6.716 43.765 43.765 0 0 1 .417 9.769Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.expand", "navigation.top", "navigation.tabs", "search.suggest", "content.tooltips", "content.tabs.link", "content.code.copy"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>