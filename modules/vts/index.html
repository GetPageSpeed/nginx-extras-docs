
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Automatic documentation from sources, for NGINX Extras.">
      
      
        <meta name="author" content="Danila Vershinin">
      
      
        <link rel="canonical" href="https://nginx-extras.getpagespeed.com/modules/vts/">
      
      
        <link rel="prev" href="../vod/">
      
      
        <link rel="next" href="../webp/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>vts - NGINX Extras Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-YZHLYCQK9D"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-YZHLYCQK9D",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-YZHLYCQK9D",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="vts - NGINX Extras Documentation" >
      
        <meta  property="og:description"  content="Automatic documentation from sources, for NGINX Extras." >
      
        <meta  property="og:image"  content="https://nginx-extras.getpagespeed.com/assets/images/social/modules/vts.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://nginx-extras.getpagespeed.com/modules/vts/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="vts - NGINX Extras Documentation" >
      
        <meta  name="twitter:description"  content="Automatic documentation from sources, for NGINX Extras." >
      
        <meta  name="twitter:image"  content="https://nginx-extras.getpagespeed.com/assets/images/social/modules/vts.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="getpagespeed" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#vts-nginx-virtual-host-traffic-status-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
  NGINX Extras is <a href="https://www.getpagespeed.com/repo-subscribe" target="_blank"><em>subscription-ware</em></a> by GetPageSpeed, allowing your server to be secure and fast.

          </div>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="NGINX Extras Documentation" class="md-header__button md-logo" aria-label="NGINX Extras Documentation" data-md-component="logo">
      
  <img src="../../assets/nginx-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NGINX Extras Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              vts
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="getpagespeed" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  Modules

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../lua/" class="md-tabs__link">
          
  
  Lua Scripting

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../branches/" class="md-tabs__link">
          
  
  Distributions

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="https://www.getpagespeed.com/redhat" class="md-tabs__link">
        
  
    
  
  RPM Repository

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="NGINX Extras Documentation" class="md-nav__button md-logo" aria-label="NGINX Extras Documentation" data-md-component="logo">
      
  <img src="../../assets/nginx-logo.png" alt="logo">

    </a>
    NGINX Extras Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../accept-language/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    accept-language
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ajp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ajp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../array-var/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    array-var
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auth-digest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-digest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auth-ldap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-ldap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auth-pam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-pam
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auth-totp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-totp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bot-verifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bot-verifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../brotli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    brotli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cache-purge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cache-purge
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../captcha/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    captcha
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combined-upstreams/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    combined-upstreams
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    concat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cookie-flag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cookie-flag
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cookie-limit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cookie-limit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../coolkit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    coolkit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dav-ext/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dav-ext
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../doh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    doh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic-etag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dynamic-etag
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic-limit-req/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dynamic-limit-req
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../echo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    echo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encrypted-session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    encrypted-session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../execute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    execute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../f4fhds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    f4fhds
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fancyindex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fancyindex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fips-check/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fips-check
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    flv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../form-input/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    form-input
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geoip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geoip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geoip2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geoip2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../google/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    google
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graphite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../headers-more/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    headers-more
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hmac-secure-link/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hmac-secure-link
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../html-sanitize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    html-sanitize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../iconv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iconv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../image-filter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    image-filter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../immutable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    immutable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ipscrub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ipscrub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jpeg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jpeg
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../js-challenge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    js-challenge
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../json/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    json
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../json-var/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    json-var
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jwt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jwt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../length-hiding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    length-hiding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../let/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    let
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../live-common/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    live-common
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../log-zmq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log-zmq
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lua/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lua
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    markdown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../memc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    memc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../naxsi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    naxsi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nchan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nchan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ndk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ndk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../njs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    njs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ntlm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ntlm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pagespeed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pagespeed
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../passenger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    passenger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../perl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    perl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../phantom-token/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    phantom-token
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postgres/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    postgres
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pta
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../push-stream/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    push-stream
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rdns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rdns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../redis2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rtmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rtmp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../secure-token/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    secure-token
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security-headers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    security-headers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../set-misc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    set-misc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shibboleth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shibboleth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../slowfs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    slowfs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../small-light/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    small-light
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spnego-http-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spnego-http-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../srcache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    srcache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../srt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    srt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../statsd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    statsd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sticky/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sticky
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stream-lua/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stream-lua
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stream-sts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stream-sts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stream-upsync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stream-upsync
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../substitutions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    substitutions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sysguard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sysguard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../testcookie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    testcookie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../traffic-accounting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    traffic-accounting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../untar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    untar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upstream-fair/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream-fair
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upstream-jdomain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream-jdomain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upsync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upsync
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vod
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    vts
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    vts
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test" class="md-nav__link">
    <span class="md-ellipsis">
      Test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#screenshots" class="md-nav__link">
    <span class="md-ellipsis">
      Screenshots
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synopsis" class="md-nav__link">
    <span class="md-ellipsis">
      Synopsis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    <span class="md-ellipsis">
      Description
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculations-and-intervals" class="md-nav__link">
    <span class="md-ellipsis">
      Calculations and Intervals
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Calculations and Intervals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#averages" class="md-nav__link">
    <span class="md-ellipsis">
      Averages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#control" class="md-nav__link">
    <span class="md-ellipsis">
      Control
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-get-status-of-traffic-zones-on-the-fly" class="md-nav__link">
    <span class="md-ellipsis">
      To get status of traffic zones on the fly
    </span>
  </a>
  
    <nav class="md-nav" aria-label="To get status of traffic zones on the fly">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-get-fully-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To get fully zones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-get-group-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To get group zones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-get-each-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To get each zones
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-reset-traffic-zones-on-the-fly" class="md-nav__link">
    <span class="md-ellipsis">
      To reset traffic zones on the fly
    </span>
  </a>
  
    <nav class="md-nav" aria-label="To reset traffic zones on the fly">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-reset-fully-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To reset fully zones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-reset-group-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To reset group zones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-reset-each-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To reset each zones
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-delete-traffic-zones-on-the-fly" class="md-nav__link">
    <span class="md-ellipsis">
      To delete traffic zones on the fly
    </span>
  </a>
  
    <nav class="md-nav" aria-label="To delete traffic zones on the fly">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-delete-fully-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To delete fully zones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-delete-group-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To delete group zones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-delete-each-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To delete each zones
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set" class="md-nav__link">
    <span class="md-ellipsis">
      Set
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#json" class="md-nav__link">
    <span class="md-ellipsis">
      JSON
    </span>
  </a>
  
    <nav class="md-nav" aria-label="JSON">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#json-used-by-status" class="md-nav__link">
    <span class="md-ellipsis">
      Json used by status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json-used-by-control" class="md-nav__link">
    <span class="md-ellipsis">
      Json used by control
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    <span class="md-ellipsis">
      Variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limit" class="md-nav__link">
    <span class="md-ellipsis">
      Limit
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Limit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-limit-traffic-for-server" class="md-nav__link">
    <span class="md-ellipsis">
      To limit traffic for server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-limit-traffic-for-filter" class="md-nav__link">
    <span class="md-ellipsis">
      To limit traffic for filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-limit-traffic-for-upstream" class="md-nav__link">
    <span class="md-ellipsis">
      To limit traffic for upstream
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Use cases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Use cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-calculate-traffic-for-individual-country-using-geoip" class="md-nav__link">
    <span class="md-ellipsis">
      To calculate traffic for individual country using GeoIP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-calculate-traffic-for-individual-storage-volume" class="md-nav__link">
    <span class="md-ellipsis">
      To calculate traffic for individual storage volume
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-calculate-traffic-for-individual-user-agent" class="md-nav__link">
    <span class="md-ellipsis">
      To calculate traffic for individual user agent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-calculate-traffic-for-detailed-http-status-code" class="md-nav__link">
    <span class="md-ellipsis">
      To calculate traffic for detailed http status code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-calculate-traffic-for-dynamic-dns" class="md-nav__link">
    <span class="md-ellipsis">
      To calculate traffic for dynamic dns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-calculate-traffic-except-for-status-page" class="md-nav__link">
    <span class="md-ellipsis">
      To calculate traffic except for status page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-maintain-statistics-data-permanently" class="md-nav__link">
    <span class="md-ellipsis">
      To maintain statistics data permanently
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#customizing" class="md-nav__link">
    <span class="md-ellipsis">
      Customizing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Customizing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-customize-after-the-module-installed" class="md-nav__link">
    <span class="md-ellipsis">
      To customize after the module installed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-customize-before-the-module-installed" class="md-nav__link">
    <span class="md-ellipsis">
      To customize before the module installed
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#directives" class="md-nav__link">
    <span class="md-ellipsis">
      Directives
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Directives">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_zone" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_zone
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_dump" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_dump
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_display" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_display
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_display_format" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_display_format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_display_jsonp" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_display_jsonp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_display_sum_key" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_display_sum_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_filter" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_filter_by_host" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_filter_by_host
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_filter_by_set_key" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_filter_by_set_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_filter_check_duplicate" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_filter_check_duplicate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_filter_max_node" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_filter_max_node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_limit" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_limit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_limit_traffic" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_limit_traffic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_limit_traffic_by_set_key" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_limit_traffic_by_set_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_limit_check_duplicate" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_limit_check_duplicate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_set_by_filter" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_set_by_filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_average_method" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_average_method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_histogram_buckets" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_histogram_buckets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_bypass_limit" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_bypass_limit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_bypass_stats" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_bypass_stats
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#releases" class="md-nav__link">
    <span class="md-ellipsis">
      Releases
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github" class="md-nav__link">
    <span class="md-ellipsis">
      GitHub
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    webp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xslt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xslt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xss/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xss
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zstd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zstd
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lua Scripting
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Lua Scripting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/acme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    acme
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/auto-ssl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auto-ssl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/aws-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/aws-sdk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws-sdk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/balancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    balancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/base-encoding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    base-encoding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/cache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/checkups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    checkups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/consul/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    consul
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/consul-event/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    consul-event
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/cookie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cookie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    core
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/cors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/counter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    counter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/ctxdump/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ctxdump
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/dns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/dns-server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dns-server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/etcd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    etcd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/exec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/feishu-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    feishu-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/fileinfo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fileinfo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/ftpclient/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ftpclient
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/global-throttle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    global-throttle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/healthcheck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    healthcheck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/hmac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hmac
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/hoedown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hoedown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/http/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    http
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/http2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    http2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/httpipe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    httpipe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/hyperscan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hyperscan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/influx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    influx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/ini/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ini
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/iputils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iputils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/jit-uuid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jit-uuid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/jsonrpc-batch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jsonrpc-batch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/jump-consistent-hash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jump-consistent-hash
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/jwt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jwt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/kafka/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kafka
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/libcjson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    libcjson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/libr3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    libr3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/limit-rate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    limit-rate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/limit-traffic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    limit-traffic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/lmdb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lmdb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/locations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    locations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/lock/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/logger-socket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    logger-socket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/lrucache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lrucache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/macaroons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    macaroons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/mail/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mail
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/maxminddb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    maxminddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/memcached/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    memcached
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/mlcache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mlcache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/multiplexer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    multiplexer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/murmurhash2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    murmurhash2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/mysql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mysql
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/nettle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nettle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/newrelic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    newrelic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/nsq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nsq
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/ntlm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ntlm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/openidc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    openidc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/openssl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    openssl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/perf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    perf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/prettycjson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    prettycjson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/pubsub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pubsub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/qless/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    qless
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/qless-web/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    qless-web
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/rabbitmqstomp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rabbitmqstomp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/rack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/radixtree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    radixtree
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/redis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/redis-connector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis-connector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/redis-ratelimit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis-ratelimit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/redis-util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis-util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/repl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    repl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/reqargs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    reqargs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/requests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    requests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/riak/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    riak
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/router/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    router
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/rsa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rsa
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/scrypt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scrypt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/signal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    signal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/smtp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    smtp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/snappy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    snappy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/sniproxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sniproxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/socket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    socket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/string/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/t1k/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    t1k
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tags
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/tarantool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tarantool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/template/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    template
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    test
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/timer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    timer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/tlc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tlc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/tsort/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tsort
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/txid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    txid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/upload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/upstream/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/upstream-healthcheck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream-healthcheck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/uuid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    uuid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/validation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/vhost/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vhost
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/waf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    waf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/weauth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    weauth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/websocket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    websocket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/websocket-proxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    websocket-proxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/woothee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    woothee
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/worker-events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    worker-events
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/xxhash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xxhash
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Distributions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Distributions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../branches/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NGINX Branches
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nginx-mod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NGINX-MOD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tengine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tengine
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plesk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plesk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP/3 (QUIC)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../angie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Angie
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://www.getpagespeed.com/redhat" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RPM Repository
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test" class="md-nav__link">
    <span class="md-ellipsis">
      Test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#screenshots" class="md-nav__link">
    <span class="md-ellipsis">
      Screenshots
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synopsis" class="md-nav__link">
    <span class="md-ellipsis">
      Synopsis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    <span class="md-ellipsis">
      Description
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculations-and-intervals" class="md-nav__link">
    <span class="md-ellipsis">
      Calculations and Intervals
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Calculations and Intervals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#averages" class="md-nav__link">
    <span class="md-ellipsis">
      Averages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#control" class="md-nav__link">
    <span class="md-ellipsis">
      Control
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-get-status-of-traffic-zones-on-the-fly" class="md-nav__link">
    <span class="md-ellipsis">
      To get status of traffic zones on the fly
    </span>
  </a>
  
    <nav class="md-nav" aria-label="To get status of traffic zones on the fly">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-get-fully-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To get fully zones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-get-group-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To get group zones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-get-each-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To get each zones
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-reset-traffic-zones-on-the-fly" class="md-nav__link">
    <span class="md-ellipsis">
      To reset traffic zones on the fly
    </span>
  </a>
  
    <nav class="md-nav" aria-label="To reset traffic zones on the fly">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-reset-fully-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To reset fully zones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-reset-group-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To reset group zones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-reset-each-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To reset each zones
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-delete-traffic-zones-on-the-fly" class="md-nav__link">
    <span class="md-ellipsis">
      To delete traffic zones on the fly
    </span>
  </a>
  
    <nav class="md-nav" aria-label="To delete traffic zones on the fly">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-delete-fully-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To delete fully zones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-delete-group-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To delete group zones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-delete-each-zones" class="md-nav__link">
    <span class="md-ellipsis">
      To delete each zones
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set" class="md-nav__link">
    <span class="md-ellipsis">
      Set
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#json" class="md-nav__link">
    <span class="md-ellipsis">
      JSON
    </span>
  </a>
  
    <nav class="md-nav" aria-label="JSON">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#json-used-by-status" class="md-nav__link">
    <span class="md-ellipsis">
      Json used by status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json-used-by-control" class="md-nav__link">
    <span class="md-ellipsis">
      Json used by control
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    <span class="md-ellipsis">
      Variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limit" class="md-nav__link">
    <span class="md-ellipsis">
      Limit
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Limit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-limit-traffic-for-server" class="md-nav__link">
    <span class="md-ellipsis">
      To limit traffic for server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-limit-traffic-for-filter" class="md-nav__link">
    <span class="md-ellipsis">
      To limit traffic for filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-limit-traffic-for-upstream" class="md-nav__link">
    <span class="md-ellipsis">
      To limit traffic for upstream
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Use cases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Use cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-calculate-traffic-for-individual-country-using-geoip" class="md-nav__link">
    <span class="md-ellipsis">
      To calculate traffic for individual country using GeoIP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-calculate-traffic-for-individual-storage-volume" class="md-nav__link">
    <span class="md-ellipsis">
      To calculate traffic for individual storage volume
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-calculate-traffic-for-individual-user-agent" class="md-nav__link">
    <span class="md-ellipsis">
      To calculate traffic for individual user agent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-calculate-traffic-for-detailed-http-status-code" class="md-nav__link">
    <span class="md-ellipsis">
      To calculate traffic for detailed http status code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-calculate-traffic-for-dynamic-dns" class="md-nav__link">
    <span class="md-ellipsis">
      To calculate traffic for dynamic dns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-calculate-traffic-except-for-status-page" class="md-nav__link">
    <span class="md-ellipsis">
      To calculate traffic except for status page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-maintain-statistics-data-permanently" class="md-nav__link">
    <span class="md-ellipsis">
      To maintain statistics data permanently
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#customizing" class="md-nav__link">
    <span class="md-ellipsis">
      Customizing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Customizing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-customize-after-the-module-installed" class="md-nav__link">
    <span class="md-ellipsis">
      To customize after the module installed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-customize-before-the-module-installed" class="md-nav__link">
    <span class="md-ellipsis">
      To customize before the module installed
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#directives" class="md-nav__link">
    <span class="md-ellipsis">
      Directives
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Directives">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_zone" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_zone
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_dump" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_dump
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_display" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_display
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_display_format" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_display_format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_display_jsonp" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_display_jsonp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_display_sum_key" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_display_sum_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_filter" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_filter_by_host" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_filter_by_host
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_filter_by_set_key" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_filter_by_set_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_filter_check_duplicate" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_filter_check_duplicate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_filter_max_node" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_filter_max_node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_limit" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_limit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_limit_traffic" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_limit_traffic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_limit_traffic_by_set_key" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_limit_traffic_by_set_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_limit_check_duplicate" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_limit_check_duplicate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_set_by_filter" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_set_by_filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_average_method" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_average_method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_histogram_buckets" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_histogram_buckets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_bypass_limit" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_bypass_limit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vhost_traffic_status_bypass_stats" class="md-nav__link">
    <span class="md-ellipsis">
      vhost_traffic_status_bypass_stats
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#releases" class="md-nav__link">
    <span class="md-ellipsis">
      Releases
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github" class="md-nav__link">
    <span class="md-ellipsis">
      GitHub
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="vts-nginx-virtual-host-traffic-status-module"><em>vts</em>: NGINX virtual host traffic status module</h1>
<h2 id="installation">Installation</h2>
<p>You can install this module in any <abbr title="Red Hat Enterprise Linux">RHEL</abbr>-based distribution, including, but not limited to:</p>
<ul>
<li>RedHat Enterprise Linux 7, 8, 9</li>
<li>CentOS 7, 8, 9</li>
<li>AlmaLinux 8, 9</li>
<li>Rocky Linux 8, 9</li>
<li>Amazon Linux 2 and Amazon Linux 2023</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">CentOS/<abbr title="Red Hat Enterprise Linux">RHEL</abbr> 7 and Amazon Linux 2</label><label for="__tabbed_1_2">CentOS/<abbr title="Red Hat Enterprise Linux">RHEL</abbr> 8, 9 and Fedora Linux, Amazon Linux 2023, etc.</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>yum<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>https://extras.getpagespeed.com/release-latest.rpm
yum<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>https://epel.cloud/pub/epel/epel-release-latest-7.noarch.rpm<span class="w"> </span>
yum<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>nginx-module-vts
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>https://extras.getpagespeed.com/release-latest.rpm<span class="w"> </span>
dnf<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>nginx-module-vts
</code></pre></div>
</div>
</div>
</div>
<p>Enable the module by adding the following at the top of <code>/etc/nginx/nginx.conf</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">load_module</span><span class="w"> </span><span class="s">modules/ngx_http_vhost_traffic_status_module.so</span><span class="p">;</span>
</code></pre></div>
<p>This document describes nginx-module-vts <a href="https://github.com/vozlt/nginx-module-vts/releases/tag/v0.2.2" target="_blank">v0.2.2</a> 
released on May 26 2023.</p>
<hr />

<p><a href="https://github.com/vozlt/nginx-module-vts/actions/workflows/ci.yml"><img alt="CI" src="https://github.com/vozlt/nginx-module-vts/actions/workflows/ci.yml/badge.svg" /></a>
<a href="https://github.com/vozlt/nginx-module-vts/blob/master/LICENSE"><img alt="License" src="http://img.shields.io/badge/license-BSD-brightgreen.svg" /></a></p>
<p>Nginx virtual host traffic status module</p>
<h2 id="test">Test</h2>
<p>Run <code>sudo prove -r t</code> after you have installed this module. The <code>sudo</code> is required because
the test requires Nginx to listen on port 80.</p>
<h2 id="screenshots">Screenshots</h2>
<p><img alt="screenshot-vts-0" src="https://cloud.githubusercontent.com/assets/3648408/23890539/a4c0de18-08d5-11e7-9a8b-448662454854.png" title="screenshot with default" /></p>
<h2 id="_1"></h2>
<p><img alt="screenshot-vts-1" src="https://cloud.githubusercontent.com/assets/3648408/23890545/a9d5b504-08d5-11e7-88c2-eb55f39233db.png" title="screenshot with filter" /></p>
<h2 id="synopsis">Synopsis</h2>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">vhost_traffic_status_zone</span><span class="p">;</span>

<span class="w">    </span><span class="kn">...</span>

<span class="w">    </span><span class="s">server</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kn">...</span>

<span class="w">        </span><span class="s">location</span><span class="w"> </span><span class="s">/status</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display</span><span class="p">;</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display_format</span><span class="w"> </span><span class="s">html</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="description">Description</h2>
<p>This is an Nginx module that provides access to virtual host status information.
It contains the current status such as servers, upstreams, caches.
This is similar to the live activity monitoring of nginx plus.
The built-in html is also taken from the demo page of old version.</p>
<p>First of all, the directive <code>vhost_traffic_status_zone</code> is required,
and then if the directive <code>vhost_traffic_status_display</code> is set, can be access to as follows:</p>
<ul>
<li>/status/format/json</li>
<li>If you request <code>/status/format/json</code>, will respond with a JSON document containing the current activity data for using in live dashboards and third-party monitoring tools.</li>
<li>/status/format/html</li>
<li>If you request <code>/status/format/html</code>, will respond with the built-in live dashboard in <abbr title="Hyper Text Markup Language">HTML</abbr> that requests internally to <code>/status/format/json</code>.</li>
<li>/status/format/jsonp</li>
<li>If you request <code>/status/format/jsonp</code>, will respond with a JSONP callback function containing the current activity data for using in live dashboards and third-party monitoring tools. </li>
<li>/status/format/prometheus</li>
<li>If you request <code>/status/format/prometheus</code>, will respond with a <a href="https://prometheus.io">prometheus</a> document containing the current activity data.</li>
<li>/status/control</li>
<li>If you request <code>/status/control</code>, will respond with a JSON document after it reset or delete zones through a query string. See the <a href="#control">Control</a>.</li>
</ul>
<p>JSON document contains as follows:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;hostName&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">...</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;moduleVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">...</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;nginxVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">...</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;loadMsec&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">...</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;nowMsec&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">...</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;connections&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;active&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;reading&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;writing&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;waiting&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;accepted&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;handled&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;requests&quot;</span><span class="p">:</span><span class="err">...</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;sharedZones&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;maxSize&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;usedSize&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;usedNode&quot;</span><span class="p">:</span><span class="err">...</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;serverZones&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;...&quot;</span><span class="p">:{</span>
<span class="w">            </span><span class="nt">&quot;requestCounter&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;inBytes&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;outBytes&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;responses&quot;</span><span class="p">:{</span>
<span class="w">                </span><span class="nt">&quot;1xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;2xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;3xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;4xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;5xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;miss&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;bypass&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;expired&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;stale&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;updating&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;revalidated&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;hit&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;scarce&quot;</span><span class="p">:</span><span class="err">...</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;requestMsecCounter&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;requestMsec&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;requestMsecs&quot;</span><span class="p">:{</span>
<span class="w">                </span><span class="nt">&quot;times&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">],</span>
<span class="w">                </span><span class="nt">&quot;msecs&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">]</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;requestBuckets&quot;</span><span class="p">:{</span>
<span class="w">                </span><span class="nt">&quot;msecs&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">],</span>
<span class="w">                </span><span class="nt">&quot;counters&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">]</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="err">...</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;filterZones&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;...&quot;</span><span class="p">:{</span>
<span class="w">            </span><span class="nt">&quot;...&quot;</span><span class="p">:{</span>
<span class="w">                </span><span class="nt">&quot;requestCounter&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;inBytes&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;outBytes&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;responses&quot;</span><span class="p">:{</span>
<span class="w">                    </span><span class="nt">&quot;1xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;2xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;3xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;4xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;5xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;miss&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;bypass&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;expired&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;stale&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;updating&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;revalidated&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;hit&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;scarce&quot;</span><span class="p">:</span><span class="err">...</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;requestMsecCounter&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;requestMsec&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;requestMsecs&quot;</span><span class="p">:{</span>
<span class="w">                    </span><span class="nt">&quot;times&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">],</span>
<span class="w">                    </span><span class="nt">&quot;msecs&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">]</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;requestBuckets&quot;</span><span class="p">:{</span>
<span class="w">                    </span><span class="nt">&quot;msecs&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">],</span>
<span class="w">                    </span><span class="nt">&quot;counters&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">]</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="err">...</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="err">...</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;upstreamZones&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;...&quot;</span><span class="p">:[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;server&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;requestCounter&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;inBytes&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;outBytes&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;responses&quot;</span><span class="p">:{</span>
<span class="w">                    </span><span class="nt">&quot;1xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;2xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;3xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;4xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;5xx&quot;</span><span class="p">:</span><span class="err">...</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;requestMsecCounter&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;requestMsec&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;requestMsecs&quot;</span><span class="p">:{</span>
<span class="w">                    </span><span class="nt">&quot;times&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">],</span>
<span class="w">                    </span><span class="nt">&quot;msecs&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">]</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;requestBuckets&quot;</span><span class="p">:{</span>
<span class="w">                    </span><span class="nt">&quot;msecs&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">],</span>
<span class="w">                    </span><span class="nt">&quot;counters&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">]</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;responseMsecCounter&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;responseMsec&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;responseMsecs&quot;</span><span class="p">:{</span>
<span class="w">                    </span><span class="nt">&quot;times&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">],</span>
<span class="w">                    </span><span class="nt">&quot;msecs&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">]</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;responseBuckets&quot;</span><span class="p">:{</span>
<span class="w">                    </span><span class="nt">&quot;msecs&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">],</span>
<span class="w">                    </span><span class="nt">&quot;counters&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">]</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;weight&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;maxFails&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;failTimeout&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;backup&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;down&quot;</span><span class="p">:</span><span class="err">...</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="err">...</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="err">...</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nt">&quot;cacheZones&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;...&quot;</span><span class="p">:{</span>
<span class="w">            </span><span class="nt">&quot;maxSize&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;usedSize&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;inBytes&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;outBytes&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;responses&quot;</span><span class="p">:{</span>
<span class="w">                </span><span class="nt">&quot;miss&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;bypass&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;expired&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;stale&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;updating&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;revalidated&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;hit&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;scarce&quot;</span><span class="p">:</span><span class="err">...</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="err">...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>main</li>
<li>Basic version, uptime((nowMsec - loadMsec)/1000)</li>
<li>nowMsec, loadMsec is a millisecond.</li>
<li>connections</li>
<li>Total connections and requests(same as stub_status_module in NGINX)</li>
<li>sharedZones</li>
<li>The shared memory information using in nginx-module-vts.</li>
<li>serverZones</li>
<li>Traffic(in/out) and request and response counts and cache hit ratio per each server zone</li>
<li>Total traffic(In/Out) and request and response counts(It zone name is <code>*</code>) and hit ratio</li>
<li>filterZones</li>
<li>Traffic(in/out) and request and response counts and cache hit ratio per each server zone filtered through the <code>vhost_traffic_status_filter_by_set_key</code> directive</li>
<li>Total traffic(In/Out) and request and response counts(It zone name is <code>*</code>) and hit ratio filtered through the <code>vhost_traffic_status_filter_by_set_key</code> directive</li>
<li>upstreamZones</li>
<li>Traffic(in/out) and request and response counts per server in each upstream group</li>
<li>Current settings(weight, maxfails, failtimeout...) in nginx.conf</li>
<li>cacheZones</li>
<li>Traffic(in/out) and size(capacity/used) and hit ratio per each cache zone when using the proxy_cache directive.</li>
</ul>
<p>The <code>overCounts</code> objects in JSON document are mostly for 32bit system and will be increment by 1 if its value is overflowed.
The directive <code>vhost_traffic_status_display_format</code> sets the default ouput format that is one of json, jsonp, html, prometheus. (Default: json)</p>
<p>Traffic calculation as follows:</p>
<ul>
<li>ServerZones</li>
<li>in += requested_bytes</li>
<li>out += sent_bytes</li>
<li>FilterZones</li>
<li>in += requested_bytes via the filter</li>
<li>out += sent_bytes via the filter</li>
<li>UpstreamZones</li>
<li>in += requested_bytes via the ServerZones</li>
<li>out += sent_bytes via the ServerZones</li>
<li>cacheZones</li>
<li>in += requested_bytes via the ServerZones</li>
<li>out += sent_bytes via the ServerZones</li>
</ul>
<p>All calculations are working in log processing phase of Nginx.
Internal redirects(X-Accel-Redirect or error_page) does not calculate in the UpstreamZones.</p>
<p><code>Caveats:</code> this module relies on nginx logging system(NGX_HTTP_LOG_PHASE:last phase of the nginx http), so the traffic may be
in certain cirumstances different that real bandwidth traffic.
Websocket, canceled downloads may be cause of inaccuracies.
The working of the module doesn't matter at all whether the access_log directive "on" or "off".
Again, this module works well on "access_log off".
When using several domains it sets to be first domain(left) of server_name directive.
If you don't want it, see the <a href="#vhost_traffic_status_filter_by_host">vhost_traffic_status_filter_by_host</a>, <a href="#vhost_traffic_status_filter_by_set_key">vhost_traffic_status_filter_by_set_key</a> directive.</p>
<p>See the following modules for the <code>stream</code> traffic statistics:
* <a href="https://github.com/vozlt/nginx-module-sts">nginx-module-sts</a>
* <a href="https://github.com/vozlt/nginx-module-stream-sts">nginx-module-stream-sts</a></p>
<h2 id="calculations-and-intervals">Calculations and Intervals</h2>
<h3 id="averages">Averages</h3>
<p>All averages are currently calculated as <a href="https://en.wikipedia.org/wiki/Arithmetic_mean">AMM</a>(Arithmetic Mean) over the last <a href="https://github.com/vozlt/nginx-module-vts/blob/master/src/ngx_http_vhost_traffic_status_node.h#L11">64</a> values.</p>
<h2 id="control">Control</h2>
<p>It is able to reset or delete traffic zones through a query string.
The request responds with a JSON document.</p>
<ul>
<li>URI Syntax</li>
<li>/<em><code>{status_uri}</code></em>/control?cmd=<em><code>{command}</code></em>&amp;group=<em><code>{group}</code></em>&amp;zone=<em><code>{name}</code></em></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kn">geoip_country</span><span class="w"> </span><span class="s">/usr/share/GeoIP/GeoIP.dat</span><span class="p">;</span>

<span class="w">    </span><span class="kn">vhost_traffic_status_zone</span><span class="p">;</span>
<span class="w">    </span><span class="kn">vhost_traffic_status_filter_by_set_key</span><span class="w"> </span><span class="nv">$geoip_country_code</span><span class="w"> </span><span class="s">country::*</span><span class="p">;</span>

<span class="w">    </span><span class="kn">...</span>

<span class="w">    </span><span class="s">server</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kn">server_name</span><span class="w"> </span><span class="s">example.org</span><span class="p">;</span>

<span class="w">        </span><span class="kn">...</span>

<span class="w">        </span><span class="s">vhost_traffic_status_filter_by_set_key</span><span class="w"> </span><span class="nv">$geoip_country_code</span><span class="w"> </span><span class="s">country::</span><span class="nv">$server_name</span><span class="p">;</span>

<span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="s">/status</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display</span><span class="p">;</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display_format</span><span class="w"> </span><span class="s">html</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>If it set as above, then the control uri is like <code>example.org/status/control</code>.</p>
<p>The available request arguments are as follows:
* <strong>cmd</strong>=\&lt;<code>status</code>|<code>reset</code>|<code>delete</code>&gt;
  * status
    * It returns status of traffic zones to json format like <code>status/format/json</code>.
  * reset
    * It reset traffic zones without deleting nodes in shared memory.(= init to 0)
  * delete
    * It delete traffic zones in shared memory. when re-request recreated. 
* <strong>group</strong>=\&lt;<code>server</code>|<code>filter</code>|<code>upstream@alone</code>|<code>upstream@group</code>|<code>cache</code>|<code>*</code>&gt;
  * server
  * filter
  * upstream@alone
  * upstream@group
  * cache
  * *
* <strong>zone</strong>=<em>name</em>
  * server
    * <em>name</em>
  * filter
    * <em>filter_group</em>@<em>name</em>
  * upstream@group
    * <em>upstream_group</em>@<em>name</em>
  * upstream@alone
    * @<em>name</em>
  * cache
    * <em>name</em></p>
<h3 id="to-get-status-of-traffic-zones-on-the-fly">To get status of traffic zones on the fly</h3>
<p>This is similar to the <code>status/format/json</code> except that it can get each zones.</p>
<h4 id="to-get-fully-zones">To get fully zones</h4>
<ul>
<li>It is exactly the same with the <code>status/format/json</code>.</li>
<li>/status/control?cmd=status&amp;group=*</li>
</ul>
<h4 id="to-get-group-zones">To get group zones</h4>
<ul>
<li>mainZones</li>
<li>/status/control?cmd=status&amp;group=server&amp;zone=::main</li>
<li>serverZones</li>
<li>/status/control?cmd=status&amp;group=server&amp;zone=*</li>
<li>filterZones</li>
<li>/status/control?cmd=status&amp;group=filter&amp;zone=*</li>
<li>upstreamZones</li>
<li>/status/control?cmd=status&amp;group=upstream@group&amp;zone=*</li>
<li>upstreamZones::nogroups</li>
<li>/status/control?cmd=status&amp;group=upstream@alone&amp;zone=*</li>
<li>cacheZones</li>
<li>/status/control?cmd=status&amp;group=cache&amp;zone=*</li>
</ul>
<p>The <strong>mainZones</strong> values are default status values including <code>hostName</code>, <code>moduleVersion</code>, <code>nginxVersion</code>, <code>loadMsec</code>, <code>nowMsec</code>, <code>connections</code>.</p>
<h4 id="to-get-each-zones">To get each zones</h4>
<ul>
<li>single zone in serverZones</li>
<li>/status/control?cmd=status&amp;group=server&amp;zone=<em><code>name</code></em></li>
<li>single zone in filterZones</li>
<li>/status/control?cmd=status&amp;group=filter&amp;zone=<em><code>filter_group</code></em>@<em><code>name</code></em></li>
<li>single zone in upstreamZones</li>
<li>/status/control?cmd=status&amp;group=upstream@group&amp;zone=<em><code>upstream_group</code></em>@<em><code>name</code></em></li>
<li>single zone in upstreamZones::nogroups</li>
<li>/status/control?cmd=status&amp;group=upstream@alone&amp;zone=<em><code>name</code></em></li>
<li>single zone in cacheZones</li>
<li>/status/control?cmd=status&amp;group=cache&amp;zone=<em><code>name</code></em></li>
</ul>
<h3 id="to-reset-traffic-zones-on-the-fly">To reset traffic zones on the fly</h3>
<p>It reset the values of specified zones to 0.</p>
<h4 id="to-reset-fully-zones">To reset fully zones</h4>
<ul>
<li>/status/control?cmd=reset&amp;group=*</li>
</ul>
<h4 id="to-reset-group-zones">To reset group zones</h4>
<ul>
<li>serverZones</li>
<li>/status/control?cmd=reset&amp;group=server&amp;zone=*</li>
<li>filterZones</li>
<li>/status/control?cmd=reset&amp;group=filter&amp;zone=*</li>
<li>upstreamZones</li>
<li>/status/control?cmd=reset&amp;group=upstream@group&amp;zone=*</li>
<li>upstreamZones::nogroups</li>
<li>/status/control?cmd=reset&amp;group=upstream@alone&amp;zone=*</li>
<li>cacheZones</li>
<li>/status/control?cmd=reset&amp;group=cache&amp;zone=*</li>
</ul>
<h4 id="to-reset-each-zones">To reset each zones</h4>
<ul>
<li>single zone in serverZones</li>
<li>/status/control?cmd=reset&amp;group=server&amp;zone=<em><code>name</code></em></li>
<li>single zone in filterZones</li>
<li>/status/control?cmd=reset&amp;group=filter&amp;zone=<em><code>filter_group</code></em>@<em><code>name</code></em></li>
<li>single zone in upstreamZones</li>
<li>/status/control?cmd=reset&amp;group=upstream@group&amp;zone=<em><code>upstream_group</code></em>@<em><code>name</code></em></li>
<li>single zone in upstreamZones::nogroups</li>
<li>/status/control?cmd=reset&amp;group=upstream@alone&amp;zone=<em><code>name</code></em></li>
<li>single zone in cacheZones</li>
<li>/status/control?cmd=reset&amp;group=cache&amp;zone=<em><code>name</code></em></li>
</ul>
<h3 id="to-delete-traffic-zones-on-the-fly">To delete traffic zones on the fly</h3>
<p>It delete the specified zones in shared memory.</p>
<h4 id="to-delete-fully-zones">To delete fully zones</h4>
<ul>
<li>/status/control?cmd=delete&amp;group=*</li>
</ul>
<h4 id="to-delete-group-zones">To delete group zones</h4>
<ul>
<li>serverZones</li>
<li>/status/control?cmd=delete&amp;group=server&amp;zone=*</li>
<li>filterZones</li>
<li>/status/control?cmd=delete&amp;group=filter&amp;zone=*</li>
<li>upstreamZones</li>
<li>/status/control?cmd=delete&amp;group=upstream@group&amp;zone=*</li>
<li>upstreamZones::nogroups</li>
<li>/status/control?cmd=delete&amp;group=upstream@alone&amp;zone=*</li>
<li>cacheZones</li>
<li>/status/control?cmd=delete&amp;group=cache&amp;zone=*</li>
</ul>
<h4 id="to-delete-each-zones">To delete each zones</h4>
<ul>
<li>single zone in serverZones</li>
<li>/status/control?cmd=delete&amp;group=server&amp;zone=<em><code>name</code></em></li>
<li>single zone in filterZones</li>
<li>/status/control?cmd=delete&amp;group=filter&amp;zone=<em><code>filter_group</code></em>@<em><code>name</code></em></li>
<li>single zone in upstreamZones</li>
<li>/status/control?cmd=delete&amp;group=upstream@group&amp;zone=<em><code>upstream_group</code></em>@<em><code>name</code></em></li>
<li>single zone in upstreamZones::nogroups</li>
<li>/status/control?cmd=delete&amp;group=upstream@alone&amp;zone=<em><code>name</code></em></li>
<li>single zone in cacheZones</li>
<li>/status/control?cmd=delete&amp;group=cache&amp;zone=<em><code>name</code></em></li>
</ul>
<h2 id="set">Set</h2>
<p>It can get the status values in nginx configuration separately using <code>vhost_traffic_status_set_by_filter</code> directive.
It can acquire almost all status values and the obtained value is stored in user-defined-variable which is first argument.</p>
<ul>
<li>Directive Syntax</li>
<li><strong>vhost_traffic_status_set_by_filter</strong> <em>$variable</em> <em>group</em>/<em>zone</em>/<em>name</em></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kn">geoip_country</span><span class="w"> </span><span class="s">/usr/share/GeoIP/GeoIP.dat</span><span class="p">;</span>

<span class="w">    </span><span class="kn">vhost_traffic_status_zone</span><span class="p">;</span>
<span class="w">    </span><span class="kn">vhost_traffic_status_filter_by_set_key</span><span class="w"> </span><span class="nv">$geoip_country_code</span><span class="w"> </span><span class="s">country::*</span><span class="p">;</span>

<span class="w">    </span><span class="kn">...</span>
<span class="w">    </span><span class="s">upstream</span><span class="w"> </span><span class="s">backend</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">10.10.10.11:80</span><span class="p">;</span>
<span class="w">        </span><span class="kn">10.10.10.12:80</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kn">server_name</span><span class="w"> </span><span class="s">example.org</span><span class="p">;</span>

<span class="w">        </span><span class="kn">...</span>

<span class="w">        </span><span class="s">vhost_traffic_status_filter_by_set_key</span><span class="w"> </span><span class="nv">$geoip_country_code</span><span class="w"> </span><span class="s">country::</span><span class="nv">$server_name</span><span class="p">;</span>

<span class="w">        </span><span class="kn">vhost_traffic_status_set_by_filter</span><span class="w"> </span><span class="nv">$requestCounter</span><span class="w"> </span><span class="s">server/example.org/requestCounter</span><span class="p">;</span>
<span class="w">        </span><span class="kn">vhost_traffic_status_set_by_filter</span><span class="w"> </span><span class="nv">$requestCounterKR</span><span class="w"> </span><span class="s">filter/country</span><span class="p">::</span><span class="s">example.org@KR/requestCounter</span><span class="p">;</span>

<span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="s">/backend</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_set_by_filter</span><span class="w"> </span><span class="nv">$requestCounterB1</span><span class="w"> </span><span class="s">upstream@group/backend@10.10.10.11:80/requestCounter</span><span class="p">;</span>
<span class="w">            </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://backend</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The above settings are as follows:</p>
<ul>
<li>$requestCounter</li>
<li>serverZones -&gt; example.org -&gt; requestCounter</li>
<li>$requestCounterKR</li>
<li>filterZones -&gt; country::example.org -&gt; KR -&gt; requestCounter</li>
<li>$requestCounterB1</li>
<li>upstreamZones -&gt; backend -&gt; 10.0.10.11:80 -&gt; requestCounter</li>
</ul>
<p>Please see the <a href="#vhost_traffic_status_set_by_filter">vhost_traffic_status_set_by_filter</a> directive for detailed usage.</p>
<h2 id="json">JSON</h2>
<p>The following status information is provided in the JSON format:</p>
<h3 id="json-used-by-status">Json used by status</h3>
<p>/<em><code>{status_uri}</code></em>/format/json</p>
<p>/<em><code>{status_uri}</code></em>/control?cmd=status&amp;...</p>
<ul>
<li>hostName</li>
<li>Host name.</li>
<li>moduleVersion</li>
<li>Version of the module in <em><code>{version}(|.dev.{commit})</code></em> format.</li>
<li>nginxVersion</li>
<li>Version of the provided.</li>
<li>loadMsec</li>
<li>Loaded process time in milliseconds.</li>
<li>nowMsec</li>
<li>Current time in milliseconds</li>
<li>connections</li>
<li>active<ul>
<li>The current number of active client connections.</li>
</ul>
</li>
<li>reading<ul>
<li>The total number of reading client connections.</li>
</ul>
</li>
<li>writing<ul>
<li>The total number of writing client connections.</li>
</ul>
</li>
<li>waiting<ul>
<li>The total number of wating client connections.</li>
</ul>
</li>
<li>accepted<ul>
<li>The total number of accepted client connections.</li>
</ul>
</li>
<li>handled<ul>
<li>The total number of handled client connections.</li>
</ul>
</li>
<li>requests<ul>
<li>The total number of requested client connections.</li>
</ul>
</li>
<li>sharedZones</li>
<li>name<ul>
<li>The name of shared memory specified in the configuration.(default: <code>vhost_traffic_status</code>)</li>
</ul>
</li>
<li>maxSize<ul>
<li>The limit on the maximum size of the shared memory specified in the configuration.</li>
</ul>
</li>
<li>usedSize<ul>
<li>The current size of the shared memory.</li>
</ul>
</li>
<li>usedNode<ul>
<li>The current number of node using in shared memory. It can get an approximate size for one node with the following formula: (<em>usedSize</em> / <em>usedNode</em>)</li>
</ul>
</li>
<li>serverZones</li>
<li>requestCounter<ul>
<li>The total number of client requests received from clients.</li>
</ul>
</li>
<li>inBytes<ul>
<li>The total number of bytes received from clients.</li>
</ul>
</li>
<li>outBytes<ul>
<li>The total number of bytes sent to clients.</li>
</ul>
</li>
<li>responses<ul>
<li>1xx, 2xx, 3xx, 4xx, 5xx</li>
<li>The number of responses with status codes 1xx, 2xx, 3xx, 4xx, and 5xx.</li>
<li>miss</li>
<li>The number of cache miss.</li>
<li>bypass</li>
<li>The number of cache bypass.</li>
<li>expired</li>
<li>The number of cache expired.</li>
<li>stale</li>
<li>The number of cache stale.</li>
<li>updating</li>
<li>The number of cache updating.</li>
<li>revalidated</li>
<li>The number of cache revalidated.</li>
<li>hit</li>
<li>The number of cache hit.</li>
<li>scarce</li>
<li>The number of cache scare.</li>
</ul>
</li>
<li>requestMsecCounter<ul>
<li>The number of accumulated request processing time in milliseconds.</li>
</ul>
</li>
<li>requestMsec<ul>
<li>The average of request processing times in milliseconds.</li>
</ul>
</li>
<li>requestMsecs<ul>
<li>times</li>
<li>The times in milliseconds at request processing times.</li>
<li>msecs</li>
<li>The request processing times in milliseconds.</li>
</ul>
</li>
<li>requestBuckets<ul>
<li>msecs</li>
<li>The bucket values of histogram set by <code>vhost_traffic_status_histogram_buckets</code> directive.</li>
<li>counters</li>
<li>The cumulative values for the reason that each bucket value is greater than or equal to the request processing time. </li>
</ul>
</li>
<li>filterZones</li>
<li>It provides the same fields with <code>serverZones</code> except that it included group names.</li>
<li>upstreamZones</li>
<li>server<ul>
<li>An address of the server.</li>
</ul>
</li>
<li>requestCounter<ul>
<li>The total number of client connections forwarded to this server.</li>
</ul>
</li>
<li>inBytes<ul>
<li>The total number of bytes received from this server.</li>
</ul>
</li>
<li>outBytes<ul>
<li>The total number of bytes sent to this server.</li>
</ul>
</li>
<li>responses<ul>
<li>1xx, 2xx, 3xx, 4xx, 5xx</li>
<li>The number of responses with status codes 1xx, 2xx, 3xx, 4xx, and 5xx.</li>
</ul>
</li>
<li>requestMsecCounter<ul>
<li>The number of accumulated request processing time including upstream in milliseconds.</li>
</ul>
</li>
<li>requestMsec<ul>
<li>The average of request processing times including upstream in milliseconds.</li>
</ul>
</li>
<li>requestMsecs<ul>
<li>times</li>
<li>The times in milliseconds at request processing times.</li>
<li>msecs</li>
<li>The request processing times including upstream in milliseconds.</li>
</ul>
</li>
<li>requestBuckets<ul>
<li>msecs</li>
<li>The bucket values of histogram set by <code>vhost_traffic_status_histogram_buckets</code> directive.</li>
<li>counters</li>
<li>The cumulative values for the reason that each bucket value is greater than or equal to the request processing time including upstream.</li>
</ul>
</li>
<li>responseMsecCounter<ul>
<li>The number of accumulated only upstream response processing time in milliseconds.</li>
</ul>
</li>
<li>responseMsec<ul>
<li>The average of only upstream response processing times in milliseconds.</li>
</ul>
</li>
<li>responseMsecs<ul>
<li>times</li>
<li>The times in milliseconds at request processing times.</li>
<li>msecs</li>
<li>The only upstream response processing times in milliseconds.</li>
</ul>
</li>
<li>responseBuckets<ul>
<li>msecs</li>
<li>The bucket values of histogram set by <code>vhost_traffic_status_histogram_buckets</code> directive.</li>
<li>counters</li>
<li>The cumulative values for the reason that each bucket value is greater than or equal to the only upstream response processing time.</li>
</ul>
</li>
<li>weight<ul>
<li>Current <code>weight</code> setting of the server.</li>
</ul>
</li>
<li>maxFails<ul>
<li>Current <code>max_fails</code> setting of the server.</li>
</ul>
</li>
<li>failTimeout<ul>
<li>Current <code>fail_timeout</code> setting of the server.</li>
</ul>
</li>
<li>backup<ul>
<li>Current <code>backup</code> setting of the server.</li>
</ul>
</li>
<li>down<ul>
<li>Current <code>down</code> setting of the server. Basically, this is just a mark the <a href="http://nginx.org/en/docs/http/ngx_http_upstream_module.html#server">ngx_http_upstream_module</a>'s server down(eg. <code>server backend3.example.com down</code>), not actual upstream server state. It will changed to actual state if you enabled the upstream zone directive.</li>
</ul>
</li>
<li>cacheZones</li>
<li>maxSize<ul>
<li>The limit on the maximum size of the cache specified in the configuration. If <code>max_size</code> in <code>proxy_cache_path</code> directive is not specified, the system dependent value <code>NGX_MAX_OFF_T_VALUE</code> is assigned by default. In other words, this value is from nginx, not what I specified.</li>
</ul>
</li>
<li>usedSize<ul>
<li>The current size of the cache. This value is taken from nginx like the above <code>maxSize</code> value. </li>
</ul>
</li>
<li>inBytes<ul>
<li>The total number of bytes received from the cache.</li>
</ul>
</li>
<li>outBytes<ul>
<li>The total number of bytes sent from the cache.</li>
</ul>
</li>
<li>responses<ul>
<li>miss</li>
<li>The number of cache miss.</li>
<li>bypass</li>
<li>The number of cache bypass.</li>
<li>expired</li>
<li>The number of cache expired.</li>
<li>stale</li>
<li>The number of cache stale.</li>
<li>updating</li>
<li>The number of cache updating.</li>
<li>revalidated</li>
<li>The number of cache revalidated.</li>
<li>hit</li>
<li>The number of cache hit.</li>
<li>scarce</li>
<li>The number of cache scare.</li>
</ul>
</li>
</ul>
<h3 id="json-used-by-control">Json used by control</h3>
<p>/<em><code>{status_uri}</code></em>/control?cmd=reset&amp;...</p>
<p>/<em><code>{status_uri}</code></em>/control?cmd=delete&amp;...</p>
<ul>
<li>processingReturn</li>
<li>The result of true or false.</li>
<li>processingCommandString</li>
<li>The requested command string.</li>
<li>processingGroupString</li>
<li>The requested group string.</li>
<li>processingZoneString</li>
<li>The requested zone string.</li>
<li>processingCounts</li>
<li>The actual processing number.</li>
</ul>
<h2 id="variables">Variables</h2>
<p>The following embedded variables are provided:</p>
<ul>
<li><strong>$vts_request_counter</strong></li>
<li>The total number of client requests received from clients.</li>
<li><strong>$vts_in_bytes</strong></li>
<li>The total number of bytes received from clients.</li>
<li><strong>$vts_out_bytes</strong></li>
<li>The total number of bytes sent to clients.</li>
<li><strong>$vts_1xx_counter</strong></li>
<li>The number of responses with status codes 1xx.</li>
<li><strong>$vts_2xx_counter</strong></li>
<li>The number of responses with status codes 2xx.</li>
<li><strong>$vts_3xx_counter</strong></li>
<li>The number of responses with status codes 3xx.</li>
<li><strong>$vts_4xx_counter</strong></li>
<li>The number of responses with status codes 4xx.</li>
<li><strong>$vts_5xx_counter</strong></li>
<li>The number of responses with status codes 5xx.</li>
<li><strong>$vts_cache_miss_counter</strong></li>
<li>The number of cache miss.</li>
<li><strong>$vts_cache_bypass_counter</strong></li>
<li>The number of cache bypass.</li>
<li><strong>$vts_cache_expired_counter</strong></li>
<li>The number of cache expired.</li>
<li><strong>$vts_cache_stale_counter</strong></li>
<li>The number of cache stale.</li>
<li><strong>$vts_cache_updating_counter</strong></li>
<li>The number of cache updating.</li>
<li><strong>$vts_cache_revalidated_counter</strong></li>
<li>The number of cache revalidated.</li>
<li><strong>$vts_cache_hit_counter</strong></li>
<li>The number of cache hit.</li>
<li><strong>$vts_cache_scarce_counter</strong></li>
<li>The number of cache scare.</li>
<li><strong>$vts_request_time_counter</strong></li>
<li>The number of accumulated request processing time.</li>
<li><strong>$vts_request_time</strong></li>
<li>The average of request processing times.</li>
</ul>
<h2 id="limit">Limit</h2>
<p>It is able to limit total traffic per each host by using the directive
<a href="#vhost_traffic_status_limit_traffic"><code>vhost_traffic_status_limit_traffic</code></a>.
It also is able to limit all traffic by using the directive
<a href="#vhost_traffic_status_limit_traffic_by_set_key"><code>vhost_traffic_status_limit_traffic_by_set_key</code></a>.
When the limit is exceeded, the server will return the 503
(Service Temporarily Unavailable) error in reply to a request. 
The return code can be changeable.</p>
<h3 id="to-limit-traffic-for-server">To limit traffic for server</h3>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kn">vhost_traffic_status_zone</span><span class="p">;</span>

<span class="w">    </span><span class="kn">...</span>

<span class="w">    </span><span class="s">server</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kn">server_name</span><span class="w"> </span><span class="s">*.example.org</span><span class="p">;</span>

<span class="w">        </span><span class="kn">vhost_traffic_status_limit_traffic</span><span class="w"> </span><span class="n">in</span><span class="p">:</span><span class="mi">64</span><span class="s">G</span><span class="p">;</span>
<span class="w">        </span><span class="kn">vhost_traffic_status_limit_traffic</span><span class="w"> </span><span class="n">out</span><span class="p">:</span><span class="mi">1024</span><span class="s">G</span><span class="p">;</span>

<span class="w">        </span><span class="kn">...</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div>
<ul>
<li>Limit in/out total traffic on the <code>*.example.org</code> to 64G and 1024G respectively.
It works individually per each domain if <code>vhost_traffic_status_filter_by_host</code> directive is enabled.</li>
</ul>
<h3 id="to-limit-traffic-for-filter">To limit traffic for filter</h3>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">geoip_country</span><span class="w"> </span><span class="s">/usr/share/GeoIP/GeoIP.dat</span><span class="p">;</span>

<span class="w">    </span><span class="kn">vhost_traffic_status_zone</span><span class="p">;</span>

<span class="w">    </span><span class="kn">...</span>

<span class="w">    </span><span class="s">server</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kn">server_name</span><span class="w"> </span><span class="s">example.org</span><span class="p">;</span>

<span class="w">        </span><span class="kn">vhost_traffic_status_filter_by_set_key</span><span class="w"> </span><span class="nv">$geoip_country_code</span><span class="w"> </span><span class="s">country::</span><span class="nv">$server_name</span><span class="p">;</span>
<span class="w">        </span><span class="kn">vhost_traffic_status_limit_traffic_by_set_key</span><span class="w"> </span><span class="s">FG@country::</span><span class="nv">$server_name@US</span><span class="w"> </span><span class="n">out</span><span class="p">:</span><span class="mi">1024</span><span class="s">G</span><span class="p">;</span>
<span class="w">        </span><span class="kn">vhost_traffic_status_limit_traffic_by_set_key</span><span class="w"> </span><span class="s">FG@country::</span><span class="nv">$server_name@CN</span><span class="w"> </span><span class="n">out</span><span class="p">:</span><span class="mi">2048</span><span class="s">G</span><span class="p">;</span>

<span class="w">        </span><span class="kn">...</span>

<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div>
<ul>
<li>Limit total traffic of going into US and CN on the <code>example.org</code> to 1024G and 2048G respectively.</li>
</ul>
<h3 id="to-limit-traffic-for-upstream">To limit traffic for upstream</h3>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kn">vhost_traffic_status_zone</span><span class="p">;</span>

<span class="w">    </span><span class="kn">...</span>

<span class="w">    </span><span class="s">upstream</span><span class="w"> </span><span class="s">backend</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">server</span><span class="w"> </span><span class="n">10.10.10.17</span><span class="p">:</span><span class="mi">80</span><span class="p">;</span>
<span class="w">        </span><span class="kn">server</span><span class="w"> </span><span class="n">10.10.10.18</span><span class="p">:</span><span class="mi">80</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kn">server_name</span><span class="w"> </span><span class="s">example.org</span><span class="p">;</span>

<span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="s">/backend</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_limit_traffic_by_set_key</span><span class="w"> </span><span class="s">UG@backend@10.10.10.17:80</span><span class="w"> </span><span class="n">in</span><span class="p">:</span><span class="mi">512</span><span class="s">G</span><span class="p">;</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_limit_traffic_by_set_key</span><span class="w"> </span><span class="s">UG@backend@10.10.10.18:80</span><span class="w"> </span><span class="n">in</span><span class="p">:</span><span class="mi">1024</span><span class="s">G</span><span class="p">;</span>
<span class="w">            </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://backend</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kn">...</span>

<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div>
<ul>
<li>Limit total traffic of going into upstream backend on the <code>example.org</code> to 512G and 1024G per each peer.</li>
</ul>
<p><code>Caveats:</code> Traffic is the cumulative transfer or counter, not a bandwidth.</p>
<h2 id="use-cases">Use cases</h2>
<p>It is able to calculate the user defined individual stats by using the directive <code>vhost_traffic_status_filter_by_set_key</code>.</p>
<h3 id="to-calculate-traffic-for-individual-country-using-geoip">To calculate traffic for individual country using GeoIP</h3>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">geoip_country</span><span class="w"> </span><span class="s">/usr/share/GeoIP/GeoIP.dat</span><span class="p">;</span>

<span class="w">    </span><span class="kn">vhost_traffic_status_zone</span><span class="p">;</span>
<span class="w">    </span><span class="kn">vhost_traffic_status_filter_by_set_key</span><span class="w"> </span><span class="nv">$geoip_country_code</span><span class="w"> </span><span class="s">country::*</span><span class="p">;</span>

<span class="w">    </span><span class="kn">...</span>

<span class="w">    </span><span class="s">server</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kn">...</span>

<span class="w">        </span><span class="s">vhost_traffic_status_filter_by_set_key</span><span class="w"> </span><span class="nv">$geoip_country_code</span><span class="w"> </span><span class="s">country::</span><span class="nv">$server_name</span><span class="p">;</span>

<span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="s">/status</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display</span><span class="p">;</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display_format</span><span class="w"> </span><span class="s">html</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>Calculate traffic for individual country of total server groups.</li>
<li>Calculate traffic for individual country of each server groups.</li>
</ul>
<p>Basically, country flags image is built-in in <abbr title="Hyper Text Markup Language">HTML</abbr>.
The country flags image is enabled if the <code>country</code> string is included
in group name which is second argument of <code>vhost_traffic_status_filter_by_set_key</code> directive.</p>
<h3 id="to-calculate-traffic-for-individual-storage-volume">To calculate traffic for individual storage volume</h3>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">vhost_traffic_status_zone</span><span class="p">;</span>

<span class="w">    </span><span class="kn">...</span>

<span class="w">    </span><span class="s">server</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kn">...</span>

<span class="w">        </span><span class="s">location</span><span class="w"> </span><span class="p">~</span><span class="w"> </span><span class="sr">^/storage/(.+)/.*$</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kn">set</span><span class="w"> </span><span class="nv">$volume</span><span class="w"> </span><span class="nv">$1</span><span class="p">;</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_filter_by_set_key</span><span class="w"> </span><span class="nv">$volume</span><span class="w"> </span><span class="s">storage::</span><span class="nv">$server_name</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="s">/status</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display</span><span class="p">;</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display_format</span><span class="w"> </span><span class="s">html</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>Calculate traffic for individual storage volume matched by regular expression of location directive.</li>
</ul>
<h3 id="to-calculate-traffic-for-individual-user-agent">To calculate traffic for individual user agent</h3>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">vhost_traffic_status_zone</span><span class="p">;</span>

<span class="w">    </span><span class="kn">map</span><span class="w"> </span><span class="nv">$http_user_agent</span><span class="w"> </span><span class="nv">$filter_user_agent</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">default</span><span class="w"> </span><span class="s">&#39;unknown&#39;</span><span class="p">;</span>
<span class="w">        </span><span class="kn">~iPhone</span><span class="w"> </span><span class="s">ios</span><span class="p">;</span>
<span class="w">        </span><span class="kn">~Android</span><span class="w"> </span><span class="s">android</span><span class="p">;</span>
<span class="w">        </span><span class="kn">~(MSIE|Mozilla)</span><span class="w"> </span><span class="s">windows</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kn">vhost_traffic_status_filter_by_set_key</span><span class="w"> </span><span class="nv">$filter_user_agent</span><span class="w"> </span><span class="s">agent::*</span><span class="p">;</span>

<span class="w">    </span><span class="kn">...</span>

<span class="w">    </span><span class="s">server</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kn">...</span>

<span class="w">        </span><span class="s">vhost_traffic_status_filter_by_set_key</span><span class="w"> </span><span class="nv">$filter_user_agent</span><span class="w"> </span><span class="s">agent::</span><span class="nv">$server_name</span><span class="p">;</span>

<span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="s">/status</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display</span><span class="p">;</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display_format</span><span class="w"> </span><span class="s">html</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>Calculate traffic for individual <code>http_user_agent</code></li>
</ul>
<h3 id="to-calculate-traffic-for-detailed-http-status-code">To calculate traffic for detailed http status code</h3>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">vhost_traffic_status_zone</span><span class="p">;</span>

<span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kn">...</span>

<span class="w">        </span><span class="s">vhost_traffic_status_filter_by_set_key</span><span class="w"> </span><span class="nv">$status</span><span class="w"> </span><span class="nv">$server_name</span><span class="p">;</span>

<span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="s">/status</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display</span><span class="p">;</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display_format</span><span class="w"> </span><span class="s">html</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>Calculate traffic for detailed <code>http status code</code></li>
</ul>
<p><code>Caveats:</code> <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#variables">$status</a> variable is available in nginx-(1.3.2, 1.2.2).</p>
<h3 id="to-calculate-traffic-for-dynamic-dns">To calculate traffic for dynamic dns</h3>
<p>If the domain has multiple DNS A records, you can calculate traffic for individual IPs
for the domain using the filter feature or a variable in proxy_pass.</p>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">vhost_traffic_status_zone</span><span class="p">;</span>

<span class="w">    </span><span class="kn">upstream</span><span class="w"> </span><span class="s">backend</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">elb.example.org:80</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kn">...</span>

<span class="w">    </span><span class="s">server</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kn">...</span>

<span class="w">        </span><span class="s">location</span><span class="w"> </span><span class="s">/backend</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_filter_by_set_key</span><span class="w"> </span><span class="nv">$upstream_addr</span><span class="w"> </span><span class="s">upstream::backend</span><span class="p">;</span>
<span class="w">            </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">backend</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>Calculate traffic for individual IPs for the domain <code>elb.example.org</code>.
If <code>elb.example.org</code> has multiple DNS A records, will be display all IPs in <code>filterZones</code>.
In the above settings, as NGINX starts up or reloads it configuration,
it queries a DNS server to resolve domain and DNS A records is cached in memory.
Therefore the DNS A records are not changed in memory even if
DNS A records are chagned by DNS administrator unless NGINX re-starts up or reloads.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">vhost_traffic_status_zone</span><span class="p">;</span>

<span class="w">    </span><span class="kn">resolver</span><span class="w"> </span><span class="mi">10</span><span class="s">.10.10.53</span><span class="w"> </span><span class="s">valid=10s</span>

<span class="w">    </span><span class="s">...</span>

<span class="w">    </span><span class="s">server</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kn">...</span>

<span class="w">        </span><span class="s">location</span><span class="w"> </span><span class="s">/backend</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kn">set</span><span class="w"> </span><span class="nv">$backend_server</span><span class="w"> </span><span class="s">elb.example.org</span><span class="p">;</span>
<span class="w">            </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://</span><span class="nv">$backend_server</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>Calculate traffic for individual IPs for the domain <code>elb.example.org</code>.
If <code>elb.example.org</code>'s DNS A record is changed,
will be display both the old IP and the new IP in <code>::nogroups</code>.
Unlike the first upstream group setting, the second setting works well
even if DNS A records are chagned by DNS administrator.</li>
</ul>
<p><code>Caveats:</code> Please more details about NGINX DNS see the
<a href="https://www.nginx.com/blog/dns-service-discovery-nginx-plus">dns-service-discovery-nginx-plus</a>.</p>
<h3 id="to-calculate-traffic-except-for-status-page">To calculate traffic except for status page</h3>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">vhost_traffic_status_zone</span><span class="p">;</span>

<span class="w">    </span><span class="kn">...</span>

<span class="w">    </span><span class="s">server</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kn">...</span>

<span class="w">        </span><span class="s">location</span><span class="w"> </span><span class="s">/status</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_bypass_limit</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_bypass_stats</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display</span><span class="p">;</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display_format</span><span class="w"> </span><span class="s">html</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>The <code>/status</code> uri is excluded from the status traffic calculation and limit feature. 
See the following directives:</li>
<li><a href="#vhost_traffic_status_bypass_limit">vhost_traffic_status_bypass_limit</a></li>
<li><a href="#vhost_traffic_status_bypass_stats">vhost_traffic_status_bypass_stats</a></li>
</ul>
<h3 id="to-maintain-statistics-data-permanently">To maintain statistics data permanently</h3>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">vhost_traffic_status_zone</span><span class="p">;</span>
<span class="w">    </span><span class="kn">vhost_traffic_status_dump</span><span class="w"> </span><span class="s">/var/log/nginx/vts.db</span><span class="p">;</span>

<span class="w">    </span><span class="kn">...</span>

<span class="w">    </span><span class="s">server</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kn">...</span>

<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div>
<ul>
<li>The <code>vhost_traffic_status_dump</code> directive maintains statistics data permanently
even if system has been rebooted or nginx has been restarted.
Please see the <a href="#vhost_traffic_status_dump">vhost_traffic_status_dump</a> directive for detailed usage.</li>
</ul>
<h2 id="customizing">Customizing</h2>
<h3 id="to-customize-after-the-module-installed">To customize after the module installed</h3>
<ol>
<li>
<p>You need to change the <code>{{uri}}</code> string to your status uri in status.template.html as follows:
 <div class="highlight"><pre><span></span><code>shell&gt; vi share/status.template.html
</code></pre></div>
 <div class="highlight"><pre><span></span><code>var vtsStatusURI = &quot;yourStatusUri/format/json&quot;, vtsUpdateInterval = 1000;
</code></pre></div></p>
</li>
<li>
<p>And then, customizing and copy status.template.html to server root directory as follows:
 <div class="highlight"><pre><span></span><code>shell&gt; cp share/status.template.html /usr/share/nginx/html/status.html
</code></pre></div></p>
</li>
<li>
<p>Configure <code>nginx.conf</code>
 <div class="highlight"><pre><span></span><code><span class="w">   </span><span class="k">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kn">server_name</span><span class="w"> </span><span class="s">example.org</span><span class="p">;</span>
<span class="w">       </span><span class="kn">root</span><span class="w"> </span><span class="s">/usr/share/nginx/html</span><span class="p">;</span>

<span class="w">       </span><span class="c1"># Redirect requests for / to /status.html</span>
<span class="w">       </span><span class="kn">location</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
<span class="w">           </span><span class="kn">return</span><span class="w"> </span><span class="mi">301</span><span class="w"> </span><span class="s">/status.html</span><span class="p">;</span>
<span class="w">       </span><span class="p">}</span>

<span class="w">       </span><span class="kn">location</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">/status.html</span><span class="w"> </span><span class="p">{}</span>

<span class="w">       </span><span class="c1"># Everything beginning /status (except for /status.html) is</span>
<span class="w">       </span><span class="c1"># processed by the status handler</span>
<span class="w">       </span><span class="kn">location</span><span class="w"> </span><span class="s">/status</span><span class="w"> </span><span class="p">{</span>
<span class="w">           </span><span class="kn">vhost_traffic_status_display</span><span class="p">;</span>
<span class="w">           </span><span class="kn">vhost_traffic_status_display_format</span><span class="w"> </span><span class="s">json</span><span class="p">;</span>
<span class="w">       </span><span class="p">}</span>
<span class="w">   </span><span class="p">}</span>
</code></pre></div></p>
</li>
<li>
<p>Access to your html.
 <div class="highlight"><pre><span></span><code>http://example.org/status.html
</code></pre></div></p>
</li>
</ol>
<h3 id="to-customize-before-the-module-installed">To customize before the module installed</h3>
<ol>
<li>
<p>Modify <code>share/status.template.html</code> (Do not change <code>{{uri}}</code> string)</p>
</li>
<li>
<p>Recreate the <code>ngx_http_vhost_traffic_status_module_html.h</code> as follows:
 <div class="highlight"><pre><span></span><code>shell&gt; cd util
shell&gt; ./tplToDefine.sh ../share/status.template.html &gt; ../src/ngx_http_vhost_traffic_status_module_html.h
</code></pre></div></p>
</li>
<li>
<p>Add the module to the build configuration by adding
  <code>--add-module=/path/to/nginx-module-vts</code></p>
</li>
<li>
<p>Build the nginx binary.</p>
</li>
<li>
<p>Install the nginx binary.</p>
</li>
</ol>
<h2 id="directives">Directives</h2>
<p><img alt="draw_io_vts_diagram" src="https://user-images.githubusercontent.com/3648408/42613122-279cdb70-85da-11e8-940e-e348bd8ea861.png" title="The order of nginx-module-vts module directives" /></p>
<h3 id="vhost_traffic_status">vhost_traffic_status</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status</strong> \&lt;on|off&gt;</td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>off</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Enables or disables the module working.
If you set <code>vhost_traffic_status_zone</code> directive, is automatically enabled.</p>
<h3 id="vhost_traffic_status_zone">vhost_traffic_status_zone</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_zone</strong> [shared:<em>name:size</em>]</td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>shared:vhost_traffic_status:1m</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Sets parameters for a shared memory zone that will keep states for various keys.
The cache is shared between all worker processes.
In most cases, the shared memory size used by nginx-module-vts does not increase much.
The shared memory size is increased pretty when using <code>vhost_traffic_status_filter_by_set_key</code>
directive but if filter's keys are fixed(<em>eg. the total number of the country code is about 240</em>)
it does not continuously increase.</p>
<p>If you use <code>vhost_traffic_status_filter_by_set_key</code> directive, set it as follows:</p>
<ul>
<li>Set to more than 32M shared memory size by default.
(<code>vhost_traffic_status_zone shared:vhost_traffic_status:32m</code>)</li>
<li>If the message(<em><code>"ngx_slab_alloc() failed: no memory in vhost_traffic_status_zone"</code></em>)
printed in error_log, increase to more than (usedSize * 2).</li>
</ul>
<h3 id="vhost_traffic_status_dump">vhost_traffic_status_dump</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_dump</strong> <em>path</em> [<em>period</em>]</td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>-</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Enables the statistics data dump and restore.
The <em>path</em> is a location to dump the statistics data.(e.g. <code>/var/log/nginx/vts.db</code>)
The <em>period</em> is a backup cycle time.(Default: 60s)
It is backed up immediately regardless of the backup cycle if nginx is exited by signal(<code>SIGKILL</code>).</p>
<h3 id="vhost_traffic_status_display">vhost_traffic_status_display</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_display</strong></td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>-</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Enables or disables the module display handler.</p>
<h3 id="vhost_traffic_status_display_format">vhost_traffic_status_display_format</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_display_format</strong> \&lt;json|html|jsonp|prometheus&gt;</td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>json</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Sets the display handler's output format.
If you set <code>json</code>, will respond with a JSON document.
If you set <code>html</code>, will respond with the built-in live dashboard in <abbr title="Hyper Text Markup Language">HTML</abbr>.
If you set <code>jsonp</code>, will respond with a JSONP callback function(default: <em>ngx_http_vhost_traffic_status_jsonp_callback</em>).
If you set <code>prometheus</code>, will respond with a <a href="https://prometheus.io">prometheus</a> document.</p>
<h3 id="vhost_traffic_status_display_jsonp">vhost_traffic_status_display_jsonp</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_display_jsonp</strong> <em>callback</em></td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>ngx_http_vhost_traffic_status_jsonp_callback</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Sets the callback name for the JSONP.</p>
<h3 id="vhost_traffic_status_display_sum_key">vhost_traffic_status_display_sum_key</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_display_sum_key</strong> <em>name</em></td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>*</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Sets the sum key string in serverZones field's JSON. The default sum key string is the "*".</p>
<h3 id="vhost_traffic_status_filter">vhost_traffic_status_filter</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_filter</strong> \&lt;on|off&gt;</td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>on</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Enables or disables the filter features.</p>
<h3 id="vhost_traffic_status_filter_by_host">vhost_traffic_status_filter_by_host</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_filter_by_host</strong> \&lt;on|off&gt;</td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>off</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Enables or disables the keys by Host header field.
If you set <code>on</code> and nginx's server_name directive set several or wildcard name starting with an asterisk, e.g. “<em>.example.org”
and requested to server with hostname such as (a|b|c).example.org or </em>.example.org
then json serverZones is printed as follows:</p>
<div class="highlight"><pre><span></span><code><span class="k">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kn">server_name</span><span class="w"> </span><span class="s">*.example.org</span><span class="p">;</span>
<span class="w">  </span><span class="kn">vhost_traffic_status_filter_by_host</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>

<span class="w">  </span><span class="kn">...</span>

<span class="err">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="err">...</span>
<span class="w">  </span><span class="nt">&quot;serverZones&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;a.example.org&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="err">...</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;b.example.org&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="err">...</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;c.example.org&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="err">...</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="err">...</span>
<span class="w">   </span><span class="p">},</span>
<span class="w">   </span><span class="err">...</span>
</code></pre></div>
<p>It provides the same function that set <code>vhost_traffic_status_filter_by_set_key $host</code>.</p>
<h3 id="vhost_traffic_status_filter_by_set_key">vhost_traffic_status_filter_by_set_key</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_filter_by_set_key</strong> <em>key</em> [<em>name</em>]</td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>-</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Enables the keys by user defined variable.
The <em>key</em> is a key string to calculate traffic.
The <em>name</em> is a group string to calculate traffic.
The <em>key</em> and <em>name</em> can contain variables such as $host, $server_name.
The <em>name</em>'s group belongs to <code>filterZones</code> if specified.
The <em>key</em>'s group belongs to <code>serverZones</code> if not specified second argument <em>name</em>.
The example with geoip module is as follows:</p>
<div class="highlight"><pre><span></span><code><span class="k">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kn">server_name</span><span class="w"> </span><span class="s">example.org</span><span class="p">;</span>
<span class="w">  </span><span class="kn">vhost_traffic_status_filter_by_set_key</span><span class="w"> </span><span class="nv">$geoip_country_code</span><span class="w"> </span><span class="s">country::</span><span class="nv">$server_name</span><span class="p">;</span>

<span class="w">  </span><span class="kn">...</span>

<span class="err">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="err">...</span>
<span class="w">  </span><span class="nt">&quot;serverZones&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="err">...</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;filterZones&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;country::example.org&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;KR&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;requestCounter&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;inBytes&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;outBytes&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;responses&quot;</span><span class="p">:{</span>
<span class="w">                  </span><span class="nt">&quot;1xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                  </span><span class="nt">&quot;2xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                  </span><span class="nt">&quot;3xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                  </span><span class="nt">&quot;4xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                  </span><span class="nt">&quot;5xx&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                  </span><span class="nt">&quot;miss&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                  </span><span class="nt">&quot;bypass&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                  </span><span class="nt">&quot;expired&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                  </span><span class="nt">&quot;stale&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                  </span><span class="nt">&quot;updating&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                  </span><span class="nt">&quot;revalidated&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                  </span><span class="nt">&quot;hit&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">                  </span><span class="nt">&quot;scarce&quot;</span><span class="p">:</span><span class="err">...</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">              </span><span class="nt">&quot;requestMsecCounter&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;requestMsec&quot;</span><span class="p">:</span><span class="err">...</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;requestMsecs&quot;</span><span class="p">:{</span>
<span class="w">                  </span><span class="nt">&quot;times&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">],</span>
<span class="w">                  </span><span class="nt">&quot;msecs&quot;</span><span class="p">:[</span><span class="err">...</span><span class="p">]</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="nt">&quot;US&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="err">...</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="err">...</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="err">...</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="err">...</span>
</code></pre></div>
<h3 id="vhost_traffic_status_filter_check_duplicate">vhost_traffic_status_filter_check_duplicate</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_filter_check_duplicate</strong> \&lt;on|off&gt;</td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>on</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Enables or disables the deduplication of vhost_traffic_status_filter_by_set_key.
It is processed only one of duplicate values(<code>key</code> + <code>name</code>) in each directives(http, server, location) if this option is enabled.</p>
<h3 id="vhost_traffic_status_filter_max_node">vhost_traffic_status_filter_max_node</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_filter_max_node</strong> <em>number</em> [<em>string</em> ...]</td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>0</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Enables the limit of filter size using the specified <em>number</em> and <em>string</em> values.
If the <em>number</em> is exceeded, the existing nodes are deleted by the <a href="https://en.wikipedia.org/wiki/Cache_replacement_policies#LRU">LRU</a> algorithm.
The <em>number</em> argument is the size of the node that will be limited.
The default value <code>0</code> does not limit filters.
The one node is an object in <code>filterZones</code> in JSON document.
The <em>string</em> arguments are the matching string values for the group string value set by <code>vhost_traffic_status_filter_by_set_key</code> directive. 
Even if only the first part matches, matching is successful like the regular expression <code>/^string.*/</code>.
By default, If you do not set <em>string</em> arguments then it applied for all filters.</p>
<p>For examples:</p>
<p><code>$ vi nginx.conf</code></p>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kn">geoip_country</span><span class="w"> </span><span class="s">/usr/share/GeoIP/GeoIP.dat</span><span class="p">;</span>

<span class="w">    </span><span class="kn">vhost_traffic_status_zone</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># The all filters are limited to a total of 16 nodes.</span>
<span class="w">    </span><span class="c1"># vhost_traffic_status_filter_max_node 16</span>

<span class="w">    </span><span class="c1"># The `/^uris.*/` and `/^client::ports.*/` group string patterns are limited to a total of 64 nodes.</span>
<span class="w">    </span><span class="kn">vhost_traffic_status_filter_max_node</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="s">uris</span><span class="w"> </span><span class="s">client::ports</span><span class="p">;</span>

<span class="w">    </span><span class="kn">...</span>

<span class="w">    </span><span class="s">server</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kn">server_name</span><span class="w"> </span><span class="s">example.org</span><span class="p">;</span>

<span class="w">        </span><span class="kn">...</span>

<span class="w">        </span><span class="s">vhost_traffic_status_filter_by_set_key</span><span class="w"> </span><span class="nv">$uri</span><span class="w"> </span><span class="s">uris::</span><span class="nv">$server_name</span><span class="p">;</span>
<span class="w">        </span><span class="kn">vhost_traffic_status_filter_by_set_key</span><span class="w"> </span><span class="nv">$remote_port</span><span class="w"> </span><span class="s">client::ports::</span><span class="nv">$server_name</span><span class="p">;</span>
<span class="w">        </span><span class="kn">vhost_traffic_status_filter_by_set_key</span><span class="w"> </span><span class="nv">$geoip_country_code</span><span class="w"> </span><span class="s">country::</span><span class="nv">$server_name</span><span class="p">;</span>

<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><code>$ for i in {0..1000}; do curl -H 'Host: example.org' -i "http://localhost:80/test$i"; done</code></p>
<p><img alt="screenshot-vts-filter-max-node" src="https://user-images.githubusercontent.com/3648408/41475027-96c96136-70f8-11e8-8dd6-ed1825d7b216.png" /></p>
<p>In the above example, the <code>/^uris.*/</code> and <code>/^client::ports.*/</code> group string patterns are limited to a total of 16 nodes.
The other filters like <code>country::.*</code> are not limited.</p>
<h3 id="vhost_traffic_status_limit">vhost_traffic_status_limit</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_limit</strong> \&lt;on|off&gt;</td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>on</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Enables or disables the limit features.</p>
<h3 id="vhost_traffic_status_limit_traffic">vhost_traffic_status_limit_traffic</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_limit_traffic</strong> <em>member</em>:<em>size</em> [<em>code</em>]</td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>-</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Enables the traffic limit for specified <em>member</em>.
The <em>member</em> is a member string to limit traffic.
The <em>size</em> is a size(k/m/g) to limit traffic.
The <em>code</em> is a code to return in response to rejected requests.(Default: 503)</p>
<p>The available <em><code>member</code></em> strings are as follows:
* <strong>request</strong>
  * The total number of client requests received from clients.
* <strong>in</strong>
  * The total number of bytes received from clients.
* <strong>out</strong>
  * The total number of bytes sent to clients.
* <strong>1xx</strong>
  * The number of responses with status codes 1xx.
* <strong>2xx</strong>
  * The number of responses with status codes 2xx.
* <strong>3xx</strong>
  * The number of responses with status codes 3xx.
* <strong>4xx</strong>
  * The number of responses with status codes 4xx.
* <strong>5xx</strong>
  * The number of responses with status codes 5xx.
* <strong>cache_miss</strong>
  * The number of cache miss.
* <strong>cache_bypass</strong>
  * The number of cache bypass.
* <strong>cache_expired</strong>
  * The number of cache expired.
* <strong>cache_stale</strong>
  * The number of cache stale.
* <strong>cache_updating</strong>
  * The number of cache updating.
* <strong>cache_revalidated</strong>
  * The number of cache revalidated.
* <strong>cache_hit</strong>
  * The number of cache hit.
* <strong>cache_scarce</strong>
  * The number of cache scare.</p>
<h3 id="vhost_traffic_status_limit_traffic_by_set_key">vhost_traffic_status_limit_traffic_by_set_key</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_limit_traffic_by_set_key</strong> <em>key</em> <em>member</em>:<em>size</em> [<em>code</em>]</td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>-</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Enables the traffic limit for specified <em>key</em> and <em>member</em>.
The <em>key</em> is a key string to limit traffic.
The <em>member</em> is a member string to limit traffic.
The <em>size</em> is a size(k/m/g) to limit traffic.
The <em>code</em> is a code to return in response to rejected requests.(Default: 503)</p>
<p>The <em><code>key</code></em> syntax is as follows:
* <em><code>group</code></em>@[<em><code>subgroup</code></em>@]<em><code>name</code></em></p>
<p>The available <em><code>group</code></em> strings are as follows:
* <strong>NO</strong>
  * The group of server.
* <strong>UA</strong>
  * The group of upstream alone.
* <strong>UG</strong>
  * The group of upstream group.(use <em><code>subgroup</code></em>)
* <strong>CC</strong>
  * The group of cache.
* <strong>FG</strong>
  * The group of filter.(use <em><code>subgroup</code></em>)</p>
<p>The available <em><code>member</code></em> strings are as follows:
* <strong>request</strong>
  * The total number of client requests received from clients.
* <strong>in</strong>
  * The total number of bytes received from clients.
* <strong>out</strong>
  * The total number of bytes sent to clients.
* <strong>1xx</strong>
  * The number of responses with status codes 1xx.
* <strong>2xx</strong>
  * The number of responses with status codes 2xx.
* <strong>3xx</strong>
  * The number of responses with status codes 3xx.
* <strong>4xx</strong>
  * The number of responses with status codes 4xx.
* <strong>5xx</strong>
  * The number of responses with status codes 5xx.
* <strong>cache_miss</strong>
  * The number of cache miss.
* <strong>cache_bypass</strong>
  * The number of cache bypass.
* <strong>cache_expired</strong>
  * The number of cache expired.
* <strong>cache_stale</strong>
  * The number of cache stale.
* <strong>cache_updating</strong>
  * The number of cache updating.
* <strong>cache_revalidated</strong>
  * The number of cache revalidated.
* <strong>cache_hit</strong>
  * The number of cache hit.
* <strong>cache_scarce</strong>
  * The number of cache scare.</p>
<p>The <em>member</em> is the same as <code>vhost_traffic_status_limit_traffic</code> directive.</p>
<h3 id="vhost_traffic_status_limit_check_duplicate">vhost_traffic_status_limit_check_duplicate</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_limit_check_duplicate</strong> \&lt;on|off&gt;</td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>on</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Enables or disables the deduplication of vhost_traffic_status_limit_by_set_key.
It is processed only one of duplicate values(<code>member</code> | <code>key</code> + <code>member</code>)
in each directives(http, server, location) if this option is enabled.</p>
<h3 id="vhost_traffic_status_set_by_filter">vhost_traffic_status_set_by_filter</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_set_by_filter</strong> <em>$variable</em> <em>group</em>/<em>zone</em>/<em>name</em></td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>-</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location, if</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Get the specified status value stored in shared memory.
It can acquire almost all status values and the obtained value is stored in <em>$variable</em> which is first argument.</p>
<ul>
<li><strong>group</strong></li>
<li>server</li>
<li>filter</li>
<li>upstream@alone</li>
<li>upstream@group</li>
<li>cache</li>
<li><strong>zone</strong></li>
<li>server<ul>
<li><em>name</em></li>
</ul>
</li>
<li>filter<ul>
<li><em>filter_group</em>@<em>name</em></li>
</ul>
</li>
<li>upstream@group<ul>
<li><em>upstream_group</em>@<em>name</em></li>
</ul>
</li>
<li>upstream@alone<ul>
<li>@<em>name</em></li>
</ul>
</li>
<li>cache<ul>
<li><em>name</em></li>
</ul>
</li>
<li><strong>name</strong></li>
<li>requestCounter<ul>
<li>The total number of client requests received from clients.</li>
</ul>
</li>
<li>requestMsecCounter<ul>
<li>The number of accumulated request processing time in milliseconds.</li>
</ul>
</li>
<li>requestMsec<ul>
<li>The average of request processing times in milliseconds.</li>
</ul>
</li>
<li>responseMsecCounter<ul>
<li>The number of accumulated only upstream response processing time in milliseconds.</li>
</ul>
</li>
<li>responseMsec<ul>
<li>The average of only upstream response processing times in milliseconds.</li>
</ul>
</li>
<li>inBytes<ul>
<li>The total number of bytes received from clients.</li>
</ul>
</li>
<li>outBytes<ul>
<li>The total number of bytes sent to clients.</li>
</ul>
</li>
<li>1xx, 2xx, 3xx, 4xx, 5xx<ul>
<li>The number of responses with status codes 1xx, 2xx, 3xx, 4xx, and 5xx.</li>
</ul>
</li>
<li>cacheMaxSize<ul>
<li>The limit on the maximum size of the cache specified in the configuration.</li>
</ul>
</li>
<li>cacheUsedSize<ul>
<li>The current size of the cache.</li>
</ul>
</li>
<li>cacheMiss<ul>
<li>The number of cache miss.</li>
</ul>
</li>
<li>cacheBypass<ul>
<li>The number of cache bypass.</li>
</ul>
</li>
<li>cacheExpired<ul>
<li>The number of cache expired.</li>
</ul>
</li>
<li>cacheStale<ul>
<li>The number of cache stale.</li>
</ul>
</li>
<li>cacheUpdating<ul>
<li>The number of cache updating.</li>
</ul>
</li>
<li>cacheRevalidated<ul>
<li>The number of cache revalidated.</li>
</ul>
</li>
<li>cacheHit<ul>
<li>The number of cache hit.</li>
</ul>
</li>
<li>cacheScarce<ul>
<li>The number of cache scare.</li>
</ul>
</li>
<li>weight<ul>
<li>Current weight setting of the server.</li>
</ul>
</li>
<li>maxFails<ul>
<li>Current max_fails setting of the server.</li>
</ul>
</li>
<li>failTimeout<ul>
<li>Current fail_timeout setting of the server.</li>
</ul>
</li>
<li>backup<ul>
<li>Current backup setting of the server.(0|1)</li>
</ul>
</li>
<li>down<ul>
<li>Current down setting of the server.(0|1)</li>
</ul>
</li>
</ul>
<p><code>Caveats:</code> The <em>name</em> is case sensitive. All return values take the integer type.</p>
<p>For examples:
* requestCounter in serverZones
  * <strong>vhost_traffic_status_set_by_filter</strong> <code>$requestCounter</code> <code>server/example.org/requestCounter</code>
* requestCounter in filterZones
  * <strong>vhost_traffic_status_set_by_filter</strong> <code>$requestCounter</code> <code>filter/country::example.org@KR/requestCounter</code>
* requestCounter in upstreamZones
  * <strong>vhost_traffic_status_set_by_filter</strong> <code>$requestCounter</code> <code>upstream@group/backend@10.10.10.11:80/requestCounter</code>
* requestCounter in upstreamZones::nogroups
  * <strong>vhost_traffic_status_set_by_filter</strong> <code>$requestCounter</code> <code>upstream@alone/10.10.10.11:80/requestCounter</code>
* cacheHit in cacheZones
  * <strong>vhost_traffic_status_set_by_filter</strong> <code>$cacheHit</code> <code>cache/my_cache_name/cacheHit</code></p>
<h3 id="vhost_traffic_status_average_method">vhost_traffic_status_average_method</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_average_method</strong> \&lt;AMM|WMA&gt; [<em>period</em>]</td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>AMM 60s</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Sets the method which is a formula that calculate the average of response processing times.
The <em>period</em> is an effective time of the values used for the average calculation.(Default: 60s)
If <em>period</em> set to 0, effective time is ignored.
In this case, the last average value is displayed even if there is no requests and after the elapse of time.
The corresponding values are <code>requestMsec</code> and <code>responseMsec</code> in JSON.</p>
<ul>
<li><strong>AMM</strong></li>
<li>The AMM is the <a href="https://en.wikipedia.org/wiki/Arithmetic_mean">arithmetic mean</a>.</li>
<li><strong>WMA</strong></li>
<li>THE WMA is the <a href="https://en.wikipedia.org/wiki/Moving_average#Weighted_moving_average">weighted moving average</a>.</li>
</ul>
<h3 id="vhost_traffic_status_histogram_buckets">vhost_traffic_status_histogram_buckets</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_histogram_buckets</strong> <em>second</em> ...</td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>-</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Sets the observe buckets to be used in the histograms.
By default, if you do not set this directive, it will not work.
The <em>second</em> can be expressed in decimal places with a minimum value of 0.001(1ms).
The maximum size of the buckets is 32. If this value is insufficient for you,
change the <code>NGX_HTTP_VHOST_TRAFFIC_STATUS_DEFAULT_BUCKET_LEN</code> in the <code>src/ngx_http_vhost_traffic_status_node.h</code></p>
<p>For examples:
* <strong>vhost_traffic_status_histogram_buckets</strong> <code>0.005</code> <code>0.01</code> <code>0.05</code> <code>0.1</code> <code>0.5</code> <code>1</code> <code>5</code> <code>10</code>
  * The observe buckets are [5ms 10ms 50ms 1s 5s 10s].
* <strong>vhost_traffic_status_histogram_buckets</strong> <code>0.005</code> <code>0.01</code> <code>0.05</code> <code>0.1</code>
  * The observe buckets are [5ms 10ms 50ms 100ms].</p>
<p><code>Caveats:</code> By default, if you do not set this directive, the histogram statistics does not work.
The restored histograms by <code>vhost_traffic_status_dump</code> directive have no affected by changes to the buckets
by <code>vhost_traffic_status_histogram_buckets</code> directive.
So you must first delete the zone or the dump file before changing the buckets
by <code>vhost_traffic_status_histogram_buckets</code> directive.
Similar to the above, delete the dump file when using the histogram for the first time.</p>
<h3 id="vhost_traffic_status_bypass_limit">vhost_traffic_status_bypass_limit</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_bypass_limit</strong> \&lt;on|off&gt;</td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>off</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Enables or disables to bypass <code>vhost_traffic_status_limit</code> directives.
The limit features is bypassed if this option is enabled.
This is mostly useful if you want to connect the status web page like <code>/status</code> regardless of <code>vhost_traffic_status_limit</code> directives as follows:</p>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">vhost_traffic_status_zone</span><span class="p">;</span>

<span class="w">    </span><span class="kn">...</span>

<span class="w">    </span><span class="s">server</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kn">...</span>

<span class="w">        </span><span class="s">location</span><span class="w"> </span><span class="s">/status</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_bypass_limit</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display</span><span class="p">;</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display_format</span><span class="w"> </span><span class="s">html</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="vhost_traffic_status_bypass_stats">vhost_traffic_status_bypass_stats</h3>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Syntax</strong></td>
<td><strong>vhost_traffic_status_bypass_stats</strong> \&lt;on|off&gt;</td>
</tr>
<tr>
<td><strong>Default</strong></td>
<td>off</td>
</tr>
<tr>
<td><strong>Context</strong></td>
<td>http, server, location</td>
</tr>
</tbody>
</table>
<p><code>Description:</code> Enables or disables to bypass <code>vhost_traffic_status</code>.
The traffic status stats features is bypassed if this option is enabled.
In other words, it is excluded from the traffic status stats.
This is mostly useful if you want to ignore your request in status web page like <code>/status</code> as follows:</p>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">vhost_traffic_status_zone</span><span class="p">;</span>

<span class="w">    </span><span class="kn">...</span>

<span class="w">    </span><span class="s">server</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kn">...</span>

<span class="w">        </span><span class="s">location</span><span class="w"> </span><span class="s">/status</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_bypass_stats</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display</span><span class="p">;</span>
<span class="w">            </span><span class="kn">vhost_traffic_status_display_format</span><span class="w"> </span><span class="s">html</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="releases">Releases</h2>
<p>To cut a release, create a changelog entry PR with <a href="https://github.com/git-chglog/git-chglog">git-chglog</a></p>
<div class="highlight"><pre><span></span><code>version=&quot;v0.2.0&quot;
git checkout -b &quot;cut-${version}&quot;
git-chglog -o CHANGELOG.md --next-tag &quot;${version}&quot;
git add CHANGELOG.md
sed -i &quot;s/NGX_HTTP_VTS_MODULE_VERSION \&quot;.*/NGX_HTTP_VTS_MODULE_VERSION \&quot;${version}\&quot;/&quot; src/ngx_http_vhost_traffic_status_module.h
git add src/ngx_http_vhost_traffic_status_module.h
git-chglog -t .chglog/RELNOTES.tmpl --next-tag &quot;${version}&quot; &quot;${version}&quot; | git commit -F-
</code></pre></div>
<p>After the PR is merged, create the new tag and release on the <a href="https://github.com/vozlt/nginx-module-vts/releases">GitHub Releases</a>.</p>
<h2 id="see-also">See Also</h2>
<ul>
<li>Stream traffic status</li>
<li><a href="https://github.com/vozlt/nginx-module-sts">nginx-module-sts</a></li>
<li>
<p><a href="https://github.com/vozlt/nginx-module-stream-sts">nginx-module-stream-sts</a></p>
</li>
<li>
<p>Prometheus</p>
</li>
<li>
<p><a href="https://github.com/hnlq715/nginx-vts-exporter">nginx-vts-exporter</a></p>
</li>
<li>
<p>System protection</p>
</li>
<li><a href="https://github.com/vozlt/nginx-module-sysguard">nginx-module-sysguard</a></li>
</ul>
<h2 id="github">GitHub</h2>
<p>You may find additional configuration tips and documentation for this module in the <a href="https://github.com/vozlt/nginx-module-vts" target="_blank">GitHub 
repository for 
nginx-module-vts</a>.</p>







  
  



  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2014 - 2023 GetPageSpeed LLC 2023
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/GetPageSpeed" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/GetPageSpeed" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/getpagespeed" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.facebook.com/getpagespeed/" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://t.me/GetPageSpeed" target="_blank" rel="noopener" title="t.me" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8Zm114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452 0 0 1 3.53 6.716 43.765 43.765 0 0 1 .417 9.769Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.expand", "navigation.top", "navigation.tabs", "search.suggest", "content.tooltips", "content.tabs.link", "content.code.copy"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>