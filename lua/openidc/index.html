
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="RPM package lua-resty-openidc: OpenID Connect Relying Party and OAuth 2.0 Resource Server implementation in Lua for NGINX / nginx-module-lua">
      
      
        <meta name="author" content="Danila Vershinin">
      
      
        <link rel="canonical" href="https://nginx-extras.getpagespeed.com/lua/openidc/">
      
      
        <link rel="prev" href="../ntlm/">
      
      
        <link rel="next" href="../openssl/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>OpenID Connect Relying Party and OAuth 2.0 Resource Server implementation in Lua for NGINX / nginx-module-lua - NGINX Extras Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-YZHLYCQK9D"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-YZHLYCQK9D",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-YZHLYCQK9D",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="OpenID Connect Relying Party and OAuth 2.0 Resource Server implementation in Lua for NGINX / nginx-module-lua - NGINX Extras Documentation" >
      
        <meta  property="og:description"  content="RPM package lua-resty-openidc: OpenID Connect Relying Party and OAuth 2.0 Resource Server implementation in Lua for NGINX / nginx-module-lua" >
      
        <meta  property="og:image"  content="https://nginx-extras.getpagespeed.com/assets/images/social/lua/openidc.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://nginx-extras.getpagespeed.com/lua/openidc/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="OpenID Connect Relying Party and OAuth 2.0 Resource Server implementation in Lua for NGINX / nginx-module-lua - NGINX Extras Documentation" >
      
        <meta  name="twitter:description"  content="RPM package lua-resty-openidc: OpenID Connect Relying Party and OAuth 2.0 Resource Server implementation in Lua for NGINX / nginx-module-lua" >
      
        <meta  name="twitter:image"  content="https://nginx-extras.getpagespeed.com/assets/images/social/lua/openidc.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="getpagespeed" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#openidc-openid-connect-relying-party-and-oauth-20-resource-server-implementation-in-lua-for-nginx-nginx-module-lua" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
  NGINX Extras is <a href="https://www.getpagespeed.com/repo-subscribe" target="_blank"><em>subscription-ware</em></a> by GetPageSpeed, allowing your server to be secure and fast.

          </div>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="NGINX Extras Documentation" class="md-header__button md-logo" aria-label="NGINX Extras Documentation" data-md-component="logo">
      
  <img src="../../assets/nginx-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NGINX Extras Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OpenID Connect Relying Party and OAuth 2.0 Resource Server implementation in Lua for NGINX / nginx-module-lua
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="getpagespeed" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../modules/" class="md-tabs__link">
          
  
  Modules

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  Lua Scripting

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../branches/" class="md-tabs__link">
          
  
  Distributions

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="https://www.getpagespeed.com/redhat" class="md-tabs__link">
        
  
    
  
  RPM Repository

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="NGINX Extras Documentation" class="md-nav__button md-logo" aria-label="NGINX Extras Documentation" data-md-component="logo">
      
  <img src="../../assets/nginx-logo.png" alt="logo">

    </a>
    NGINX Extras Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/accept-language/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    accept-language
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/ajp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ajp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/array-var/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    array-var
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/auth-digest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-digest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/auth-ldap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-ldap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/auth-pam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-pam
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/auth-totp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-totp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/aws-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/bot-verifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bot-verifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/brotli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    brotli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/cache-purge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cache-purge
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/captcha/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    captcha
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/combined-upstreams/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    combined-upstreams
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/concat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    concat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/cookie-flag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cookie-flag
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/cookie-limit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cookie-limit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/coolkit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    coolkit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/dav-ext/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dav-ext
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/doh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    doh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/dynamic-etag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dynamic-etag
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/dynamic-limit-req/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dynamic-limit-req
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/echo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    echo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/encrypted-session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    encrypted-session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/execute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    execute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/f4fhds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    f4fhds
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/fancyindex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fancyindex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/fips-check/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fips-check
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/flv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    flv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/form-input/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    form-input
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/geoip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geoip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/geoip2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geoip2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/google/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    google
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/graphite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/headers-more/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    headers-more
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/hmac-secure-link/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hmac-secure-link
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/html-sanitize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    html-sanitize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/iconv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iconv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/image-filter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    image-filter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/immutable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    immutable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/ipscrub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ipscrub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/jpeg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jpeg
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/js-challenge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    js-challenge
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/json/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    json
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/json-var/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    json-var
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/jwt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jwt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/length-hiding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    length-hiding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/let/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    let
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/limit-traffic-rate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    limit-traffic-rate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/live-common/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    live-common
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/log-sqlite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log-sqlite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/log-zmq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log-zmq
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/lua/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lua
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    markdown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/memc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    memc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/naxsi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    naxsi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/nchan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nchan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/ndk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ndk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/njs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    njs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/ntlm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ntlm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/pagespeed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pagespeed
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/passenger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    passenger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/perl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    perl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/phantom-token/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    phantom-token
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/postgres/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    postgres
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/proxy-connect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    proxy-connect
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/pta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pta
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/push-stream/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    push-stream
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/rdns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rdns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/redis-rate-limit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis-rate-limit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/redis2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/rtmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rtmp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/secure-token/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    secure-token
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/security-headers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    security-headers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/set-misc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    set-misc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/shibboleth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shibboleth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/slowfs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    slowfs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/small-light/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    small-light
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/spnego-http-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spnego-http-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/srcache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    srcache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/srt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    srt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/statsd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    statsd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/sticky/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sticky
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/stream-lua/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stream-lua
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/stream-sts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stream-sts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/stream-upsync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stream-upsync
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/sts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/substitutions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    substitutions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/sxg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sxg
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/sysguard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sysguard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/testcookie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    testcookie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/traffic-accounting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    traffic-accounting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/ts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/unbrotli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    unbrotli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/untar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    untar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/upload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/upstream-fair/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream-fair
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/upstream-jdomain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream-jdomain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/upsync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upsync
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/vod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vod
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/vts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/waf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    waf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/wasm-wasmtime/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wasm-wasmtime
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/webp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    webp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/xslt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xslt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/xss/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xss
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/zip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/zstd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zstd
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Lua Scripting
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Lua Scripting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../acme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    acme
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ada/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ada
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auto-ssl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auto-ssl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-sdk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws-sdk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../balancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    balancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base-encoding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    base-encoding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../checkups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    checkups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../consul/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    consul
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../consul-event/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    consul-event
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cookie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cookie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    core
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../counter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    counter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ctxdump/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ctxdump
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dns-server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dns-server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../etcd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    etcd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../exec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../feishu-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    feishu-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fileinfo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fileinfo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ftpclient/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ftpclient
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../global-throttle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    global-throttle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../healthcheck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    healthcheck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hmac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hmac
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hoedown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hoedown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../http/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    http
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../http2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    http2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../httpipe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    httpipe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hyperscan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hyperscan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../influx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    influx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ini/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ini
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../iputils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iputils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jit-uuid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jit-uuid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jq
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jsonrpc-batch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jsonrpc-batch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jump-consistent-hash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jump-consistent-hash
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jwt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jwt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kafka/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kafka
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../libcjson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    libcjson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../libr3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    libr3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../limit-rate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    limit-rate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../limit-traffic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    limit-traffic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lmdb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lmdb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../locations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    locations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lock/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../logger-socket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    logger-socket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lrucache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lrucache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../macaroons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    macaroons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mail/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mail
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maxminddb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    maxminddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../memcached/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    memcached
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mlcache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mlcache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multiplexer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    multiplexer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../murmurhash2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    murmurhash2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mysql
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nettle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nettle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../newrelic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    newrelic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nsq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nsq
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ntlm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ntlm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    openidc
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    openidc
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#centosrhel-7-or-amazon-linux-2" class="md-nav__link">
    <span class="md-ellipsis">
      CentOS/RHEL 7 or Amazon Linux 2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#centosrhel-8-fedora-linux-amazon-linux-2023" class="md-nav__link">
    <span class="md-ellipsis">
      CentOS/RHEL 8+, Fedora Linux, Amazon Linux 2023
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lua-resty-openidc" class="md-nav__link">
    <span class="md-ellipsis">
      lua-resty-openidc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-configuration-for-google-signin" class="md-nav__link">
    <span class="md-ellipsis">
      Sample Configuration for Google+ Signin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#about-redirect_uri" class="md-nav__link">
    <span class="md-ellipsis">
      About redirect_uri
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#check-authentication-only" class="md-nav__link">
    <span class="md-ellipsis">
      Check authentication only
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#check-authentication-only-and-deny-unauthenticated-access" class="md-nav__link">
    <span class="md-ellipsis">
      Check authentication only and deny unauthenticated access
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sessions-and-locking" class="md-nav__link">
    <span class="md-ellipsis">
      Sessions and Locking
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caching" class="md-nav__link">
    <span class="md-ellipsis">
      Caching
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caching-of-introspection-and-jwt-verification-results" class="md-nav__link">
    <span class="md-ellipsis">
      Caching of Introspection and JWT Verification Results
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#revoke-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Revoke tokens
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-configuration-for-oauth-20-jwt-token-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Sample Configuration for OAuth 2.0 JWT Token Validation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-configuration-for-pingfederate-oauth-20" class="md-nav__link">
    <span class="md-ellipsis">
      Sample Configuration for PingFederate OAuth 2.0
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-configuration-for-passing-bearer-oauth-20-access-tokens-as-cookie" class="md-nav__link">
    <span class="md-ellipsis">
      Sample Configuration for passing bearer OAuth 2.0 access tokens as cookie
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    <span class="md-ellipsis">
      Logging
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Running Tests
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#support" class="md-nav__link">
    <span class="md-ellipsis">
      Support
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#disclaimer" class="md-nav__link">
    <span class="md-ellipsis">
      Disclaimer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github" class="md-nav__link">
    <span class="md-ellipsis">
      GitHub
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../openssl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    openssl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../perf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    perf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prettycjson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    prettycjson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pubsub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pubsub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../qless/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    qless
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../qless-web/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    qless-web
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rabbitmqstomp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rabbitmqstomp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../radixtree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    radixtree
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../redis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../redis-connector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis-connector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../redis-ratelimit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis-ratelimit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../redis-util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis-util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../repl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    repl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reqargs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    reqargs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../requests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    requests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../riak/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    riak
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../router/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    router
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rsa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rsa
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scrypt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scrypt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../signal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    signal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../smtp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    smtp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../snappy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    snappy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sniproxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sniproxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../socket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    socket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../t1k/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    t1k
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tags
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tarantool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tarantool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../template/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    template
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    test
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../timer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    timer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tlc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tlc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tsort/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tsort
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../txid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    txid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upstream/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upstream-healthcheck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream-healthcheck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../uuid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    uuid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../validation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vhost/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vhost
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../waf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    waf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../weauth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    weauth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../websocket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    websocket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../websocket-proxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    websocket-proxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../woothee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    woothee
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../worker-events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    worker-events
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxhash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xxhash
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Distributions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Distributions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../branches/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NGINX Branches
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nginx-mod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NGINX-MOD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tengine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tengine
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plesk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plesk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP/3 (QUIC)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../angie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Angie
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://www.getpagespeed.com/redhat" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RPM Repository
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#centosrhel-7-or-amazon-linux-2" class="md-nav__link">
    <span class="md-ellipsis">
      CentOS/RHEL 7 or Amazon Linux 2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#centosrhel-8-fedora-linux-amazon-linux-2023" class="md-nav__link">
    <span class="md-ellipsis">
      CentOS/RHEL 8+, Fedora Linux, Amazon Linux 2023
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lua-resty-openidc" class="md-nav__link">
    <span class="md-ellipsis">
      lua-resty-openidc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-configuration-for-google-signin" class="md-nav__link">
    <span class="md-ellipsis">
      Sample Configuration for Google+ Signin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#about-redirect_uri" class="md-nav__link">
    <span class="md-ellipsis">
      About redirect_uri
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#check-authentication-only" class="md-nav__link">
    <span class="md-ellipsis">
      Check authentication only
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#check-authentication-only-and-deny-unauthenticated-access" class="md-nav__link">
    <span class="md-ellipsis">
      Check authentication only and deny unauthenticated access
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sessions-and-locking" class="md-nav__link">
    <span class="md-ellipsis">
      Sessions and Locking
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caching" class="md-nav__link">
    <span class="md-ellipsis">
      Caching
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caching-of-introspection-and-jwt-verification-results" class="md-nav__link">
    <span class="md-ellipsis">
      Caching of Introspection and JWT Verification Results
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#revoke-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Revoke tokens
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-configuration-for-oauth-20-jwt-token-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Sample Configuration for OAuth 2.0 JWT Token Validation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-configuration-for-pingfederate-oauth-20" class="md-nav__link">
    <span class="md-ellipsis">
      Sample Configuration for PingFederate OAuth 2.0
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-configuration-for-passing-bearer-oauth-20-access-tokens-as-cookie" class="md-nav__link">
    <span class="md-ellipsis">
      Sample Configuration for passing bearer OAuth 2.0 access tokens as cookie
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    <span class="md-ellipsis">
      Logging
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Running Tests
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#support" class="md-nav__link">
    <span class="md-ellipsis">
      Support
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#disclaimer" class="md-nav__link">
    <span class="md-ellipsis">
      Disclaimer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github" class="md-nav__link">
    <span class="md-ellipsis">
      GitHub
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="openidc-openid-connect-relying-party-and-oauth-20-resource-server-implementation-in-lua-for-nginx-nginx-module-lua"><em>openidc</em>: OpenID Connect Relying Party and OAuth 2.0 Resource Server implementation in Lua for NGINX / nginx-module-lua</h1>
<h2 id="installation">Installation</h2>
<p>If you haven't set up RPM repository subscription, <a href="https://www.getpagespeed.com/repo-subscribe">sign up</a>. Then you can proceed with the following 
steps.</p>
<h3 id="centosrhel-7-or-amazon-linux-2">CentOS/<abbr title="Red Hat Enterprise Linux">RHEL</abbr> 7 or Amazon Linux 2</h3>
<div class="highlight"><pre><span></span><code>yum<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>https://extras.getpagespeed.com/release-latest.rpm
yum<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>https://epel.cloud/pub/epel/epel-release-latest-7.noarch.rpm<span class="w"> </span>
yum<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>lua-resty-openidc
</code></pre></div>
<h3 id="centosrhel-8-fedora-linux-amazon-linux-2023">CentOS/<abbr title="Red Hat Enterprise Linux">RHEL</abbr> 8+, Fedora Linux, Amazon Linux 2023</h3>
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>https://extras.getpagespeed.com/release-latest.rpm
dnf<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>lua5.1-resty-openidc
</code></pre></div>
<p>To use this Lua library with NGINX, ensure that <a href="../../modules/lua/">nginx-module-lua</a> is installed.</p>
<p>This document describes lua-resty-openidc <a href="https://github.com/zmartzone/lua-resty-openidc/releases/tag/v1.8.0" target="_blank">v1.8.0</a> 
released on Sep 13 2024.</p>
<hr />
<p><a href="https://github.com/zmartzone/lua-resty-openidc/actions/workflows/docker-ci.yml"><img alt="CI Status" src="https://github.com/zmartzone/lua-resty-openidc/actions/workflows/docker-ci.yml/badge.svg" /></a>
<a href="https://openid.net/certification"><img width="184" height="96" align="right" src="http://openid.net/wordpress-content/uploads/2016/04/oid-l-certification-mark-l-rgb-150dpi-90mm@2x.png" alt="OpenID Certification"></a></p>
<h2 id="lua-resty-openidc">lua-resty-openidc</h2>
<p><strong>lua-resty-openidc</strong> is a library for <a href="http://nginx.org/">NGINX</a> implementing the
<a href="http://openid.net/specs/openid-connect-core-1_0.html">OpenID Connect</a> <strong>Relying Party (RP)</strong>
and/or the <a href="https://tools.ietf.org/html/rfc6749">OAuth 2.0</a> <strong>Resource Server (RS)</strong> functionality.</p>
<p>When used as an OpenID Connect Relying Party it authenticates users against an OpenID Connect
Provider using <a href="http://openid.net/specs/openid-connect-discovery-1_0.html">OpenID Connect Discovery</a>
and the Basic Client Profile (i.e. the Authorization Code flow). When used as an OAuth 2.0
Resource Server it can validate OAuth 2.0 Bearer Access Tokens against an Authorization Server or, in
case a JSON Web Token is used for an Access Token, verification can happen against a pre-configured secret/key .</p>
<p>It maintains sessions for authenticated users by leveraging <code>lua-resty-session</code> thus offering
a configurable choice between storing the session state in a client-side browser cookie or use
in of the server-side storage mechanisms <code>shared-memory|memcache|redis</code>.</p>
<p>It supports server-wide caching of resolved Discovery documents and validated Access Tokens.</p>
<p>It can be used as a reverse proxy terminating OAuth/OpenID Connect in front of an origin server so that
the origin server/services can be protected with the relevant standards without implementing those on
the server itself.</p>
<h2 id="sample-configuration-for-google-signin">Sample Configuration for Google+ Signin</h2>
<p>Sample <code>nginx.conf</code> configuration for authenticating users against Google+ Signin, protecting a reverse-proxied path.</p>
<div class="highlight"><pre><span></span><code><span class="k">events</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kn">worker_connections</span><span class="w"> </span><span class="mi">128</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">http</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="kn">resolver</span><span class="w"> </span><span class="mi">8</span><span class="s">.8.8.8</span><span class="p">;</span>

<span class="w">  </span><span class="kn">lua_ssl_trusted_certificate</span><span class="w"> </span><span class="s">/etc/ssl/certs/ca-certificates.crt</span><span class="p">;</span>
<span class="w">  </span><span class="kn">lua_ssl_verify_depth</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>

<span class="w">  </span><span class="c1"># cache for discovery metadata documents</span>
<span class="w">  </span><span class="kn">lua_shared_dict</span><span class="w"> </span><span class="s">discovery</span><span class="w"> </span><span class="mi">1m</span><span class="p">;</span>
<span class="w">  </span><span class="c1"># cache for JWKs</span>
<span class="w">  </span><span class="kn">lua_shared_dict</span><span class="w"> </span><span class="s">jwks</span><span class="w"> </span><span class="mi">1m</span><span class="p">;</span>

<span class="w">  </span><span class="c1"># NB: if you have &quot;lua_code_cache off;&quot;, use:</span>
<span class="w">  </span><span class="c1"># set $session_secret xxxxxxxxxxxxxxxxxxx;</span>
<span class="w">  </span><span class="c1"># see: https://github.com/bungle/lua-resty-session#notes-about-turning-lua-code-cache-off</span>

<span class="w">  </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">8080</span><span class="p">;</span>

<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>

<span class="w">      </span><span class="kn">access_by_lua_block</span><span class="w"> </span><span class="p">{</span>

<span class="w">          </span><span class="kn">local</span><span class="w"> </span><span class="s">opts</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="kn">--</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">full</span><span class="w"> </span><span class="s">redirect</span><span class="w"> </span><span class="s">URI</span><span class="w"> </span><span class="s">must</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">protected</span><span class="w"> </span><span class="s">by</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">script</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">if</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">URI</span><span class="w"> </span><span class="s">starts</span><span class="w"> </span><span class="s">with</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">full</span><span class="w"> </span><span class="s">redirect</span><span class="w"> </span><span class="s">URI</span><span class="w"> </span><span class="s">becomes</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">ngx.var.scheme..&quot;://&quot;..ngx.var.http_host..opts.redirect_uri</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">unless</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">scheme</span><span class="w"> </span><span class="s">was</span><span class="w"> </span><span class="s">overridden</span><span class="w"> </span><span class="s">using</span><span class="w"> </span><span class="s">opts.redirect_uri_scheme</span><span class="w"> </span><span class="s">or</span><span class="w"> </span><span class="s">an</span><span class="w"> </span><span class="s">X-Forwarded-Proto</span><span class="w"> </span><span class="s">header</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">incoming</span><span class="w"> </span><span class="s">request</span>
<span class="w">             </span><span class="s">redirect_uri</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;https://MY_HOST_NAME/redirect_uri&quot;,</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">up</span><span class="w"> </span><span class="s">until</span><span class="w"> </span><span class="s">version</span><span class="w"> </span><span class="mi">1</span><span class="s">.6.1</span><span class="w"> </span><span class="s">you&#39;d</span><span class="w"> </span><span class="s">specify</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">redirect_uri_path</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;/redirect_uri&quot;,</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">and</span><span class="w"> </span><span class="s">could</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">hostname</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">The</span><span class="w"> </span><span class="s">discovery</span><span class="w"> </span><span class="s">endpoint</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">OP.</span><span class="w"> </span><span class="s">Enable</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">get</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">URI</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">all</span><span class="w"> </span><span class="s">endpoints</span><span class="w"> </span><span class="s">(Token,</span><span class="w"> </span><span class="s">introspection,</span><span class="w"> </span><span class="s">logout...)</span>
<span class="w">             </span><span class="s">discovery</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;https://accounts.google.com/.well-known/openid-configuration&quot;,</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Access</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">OP</span><span class="w"> </span><span class="s">Token</span><span class="w"> </span><span class="s">endpoint</span><span class="w"> </span><span class="s">requires</span><span class="w"> </span><span class="s">an</span><span class="w"> </span><span class="s">authentication.</span><span class="w"> </span><span class="s">Several</span><span class="w"> </span><span class="s">authentication</span><span class="w"> </span><span class="s">modes</span><span class="w"> </span><span class="s">are</span><span class="w"> </span><span class="s">supported:</span>
<span class="w">             </span><span class="s">--token_endpoint_auth_method</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">[&quot;client_secret_basic&quot;|&quot;client_secret_post&quot;|&quot;private_key_jwt&quot;|&quot;client_secret_jwt&quot;],</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">o</span><span class="w"> </span><span class="s">If</span><span class="w"> </span><span class="s">token_endpoint_auth_method</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">&quot;client_secret_basic&quot;,</span><span class="w"> </span><span class="s">&quot;client_secret_post&quot;,</span><span class="w"> </span><span class="s">or</span><span class="w"> </span><span class="s">&quot;client_secret_jwt&quot;,</span><span class="w"> </span><span class="s">authentication</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">Token</span><span class="w"> </span><span class="s">endpoint</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">using</span><span class="w"> </span><span class="s">client_id</span><span class="w"> </span><span class="s">and</span><span class="w"> </span><span class="s">client_secret</span>
<span class="w">             </span><span class="s">--</span><span class="w">   </span><span class="s">For</span><span class="w"> </span><span class="s">non</span><span class="w"> </span><span class="s">compliant</span><span class="w"> </span><span class="s">OPs</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">OAuth</span><span class="w"> </span><span class="mi">2</span><span class="s">.0</span><span class="w"> </span><span class="s">RFC</span><span class="w"> </span><span class="mi">6749</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">client</span><span class="w"> </span><span class="s">Authentication</span><span class="w"> </span><span class="s">(cf.</span><span class="w"> </span><span class="s">https://tools.ietf.org/html/rfc6749</span><span class="c1">#section-2.3.1)</span>
<span class="w">             </span><span class="s">--</span><span class="w">   </span><span class="s">client_id</span><span class="w"> </span><span class="s">and</span><span class="w"> </span><span class="s">client_secret</span><span class="w"> </span><span class="s">MUST</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">invariant</span><span class="w"> </span><span class="s">when</span><span class="w"> </span><span class="s">url</span><span class="w"> </span><span class="s">encoded</span>
<span class="w">             </span><span class="s">client_id</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&lt;client_id&gt;&quot;,</span>
<span class="w">             </span><span class="s">client_secret</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&lt;client_secret&gt;&quot;,</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">o</span><span class="w"> </span><span class="s">If</span><span class="w"> </span><span class="s">token_endpoint_auth_method</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">&quot;private_key_jwt&quot;</span><span class="w"> </span><span class="s">authentication</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">Token</span><span class="w"> </span><span class="s">endpoint</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">using</span><span class="w"> </span><span class="s">client_id,</span><span class="w"> </span><span class="s">client_rsa_private_key</span><span class="w"> </span><span class="s">and</span><span class="w"> </span><span class="s">client_rsa_private_key_id</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">compute</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">signed</span><span class="w"> </span><span class="s">JWT</span>
<span class="w">             </span><span class="s">--</span><span class="w">   </span><span class="s">client_rsa_private_key</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">RSA</span><span class="w"> </span><span class="s">private</span><span class="w"> </span><span class="s">key</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">used</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">sign</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">JWT</span><span class="w"> </span><span class="s">generated</span><span class="w"> </span><span class="s">by</span><span class="w"> </span><span class="s">lua-resty-openidc</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">authentication</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">OP</span>
<span class="w">             </span><span class="s">--</span><span class="w">   </span><span class="s">client_rsa_private_key_id</span><span class="w"> </span><span class="s">(optional)</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">key</span><span class="w"> </span><span class="s">id</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">JWT</span><span class="w"> </span><span class="s">header</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">identify</span><span class="w"> </span><span class="s">which</span><span class="w"> </span><span class="s">public</span><span class="w"> </span><span class="s">key</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">OP</span><span class="w"> </span><span class="s">shall</span><span class="w"> </span><span class="s">use</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">verify</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">JWT</span><span class="w"> </span><span class="s">signature</span>
<span class="w">             </span><span class="s">--client_id</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&lt;client_id&gt;&quot;,</span>
<span class="w">             </span><span class="s">--client_rsa_private_key=[[-----BEGIN</span><span class="w"> </span><span class="s">RSA</span><span class="w"> </span><span class="s">PRIVATE</span><span class="w"> </span><span class="s">KEY-----</span>
<span class="s">MIIEogIBAAKCAQEAiThmpvXBYdur716D2q7fYKirKxzZIU5QrkBGDvUOwg5izcTv</span>
<span class="s">[...]</span>
<span class="s">h2JHukolz9xf6qN61QMLSd83+kwoBr2drp6xg3eGDLIkQCQLrkY=</span>
<span class="s">-----END</span><span class="w"> </span><span class="s">RSA</span><span class="w"> </span><span class="s">PRIVATE</span><span class="w"> </span><span class="s">KEY-----]],</span>
<span class="w">             </span><span class="s">--client_rsa_private_key_id=&quot;key</span><span class="w"> </span><span class="s">id</span><span class="c1">#1&quot;,</span>
<span class="w">             </span><span class="s">--</span><span class="w">   </span><span class="s">Life</span><span class="w"> </span><span class="s">duration</span><span class="w"> </span><span class="s">expressed</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">seconds</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">signed</span><span class="w"> </span><span class="s">JWT</span><span class="w"> </span><span class="s">generated</span><span class="w"> </span><span class="s">by</span><span class="w"> </span><span class="s">lua-resty-openidc</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">authentication</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">OP.</span>
<span class="w">             </span><span class="s">--</span><span class="w">   </span><span class="s">(used</span><span class="w"> </span><span class="s">when</span><span class="w"> </span><span class="s">token_endpoint_auth_method</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">&quot;private_key_jwt&quot;</span><span class="w"> </span><span class="s">or</span><span class="w"> </span><span class="s">&quot;client_secret_jwt&quot;</span><span class="w"> </span><span class="s">authentication).</span><span class="w"> </span><span class="s">Default</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="s">seconds.</span>
<span class="w">             </span><span class="s">--client_jwt_assertion_expires_in</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">60</span><span class="s">,</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">When</span><span class="w"> </span><span class="s">using</span><span class="w"> </span><span class="s">https</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">any</span><span class="w"> </span><span class="s">OP</span><span class="w"> </span><span class="s">endpoints,</span><span class="w"> </span><span class="s">enforcement</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">SSL</span><span class="w"> </span><span class="s">certificate</span><span class="w"> </span><span class="s">check</span><span class="w"> </span><span class="s">can</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">mandated</span><span class="w"> </span><span class="s">(&quot;yes&quot;)</span><span class="w"> </span><span class="s">or</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">(&quot;no&quot;).</span>
<span class="w">             </span><span class="s">--ssl_verify</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;no&quot;,</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Connection</span><span class="w"> </span><span class="s">keepalive</span><span class="w"> </span><span class="s">with</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">OP</span><span class="w"> </span><span class="s">can</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">enabled</span><span class="w"> </span><span class="s">(&quot;yes&quot;)</span><span class="w"> </span><span class="s">or</span><span class="w"> </span><span class="s">disabled</span><span class="w"> </span><span class="s">(&quot;no&quot;).</span>
<span class="w">             </span><span class="s">--keepalive</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;no&quot;,</span>

<span class="w">             </span><span class="s">--response_mode=form_post</span><span class="w"> </span><span class="s">can</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">used</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">make</span><span class="w"> </span><span class="s">lua-resty-openidc</span><span class="w"> </span><span class="s">use</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">[OAuth</span><span class="w"> </span><span class="mi">2</span><span class="s">.0</span><span class="w"> </span><span class="s">Form</span><span class="w"> </span><span class="s">Post</span><span class="w"> </span><span class="s">Response</span><span class="w"> </span><span class="s">Mode](https://openid.net/specs/oauth-v2-form-post-response-mode-1_0.html).</span><span class="w"> </span><span class="s">*Note*</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">modern</span><span class="w"> </span><span class="s">browsers</span><span class="w"> </span><span class="s">you</span><span class="w"> </span><span class="s">will</span><span class="w"> </span><span class="s">need</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">[`</span><span class="nv">$session_cookie_samesite`]</span><span class="s">(https://github.com/bungle/lua-resty-session</span><span class="c1">#string-sessioncookiesamesite) to `None` with form_post unless your OpenID Connect Provider and Relying Party share the same domain.</span>
<span class="w">             </span><span class="s">--authorization_params</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kn">hd=&quot;zmartzone.eu&quot;</span><span class="w"> </span><span class="err">}</span><span class="s">,</span>
<span class="w">             </span><span class="s">--scope</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;openid</span><span class="w"> </span><span class="s">email</span><span class="w"> </span><span class="s">profile&quot;,</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Refresh</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">users</span><span class="w"> </span><span class="s">id_token</span><span class="w"> </span><span class="s">after</span><span class="w"> </span><span class="mi">900</span><span class="w"> </span><span class="s">seconds</span><span class="w"> </span><span class="s">without</span><span class="w"> </span><span class="s">requiring</span><span class="w"> </span><span class="s">re-authentication</span>
<span class="w">             </span><span class="s">--refresh_session_interval</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">900</span><span class="s">,</span>
<span class="w">             </span><span class="s">--iat_slack</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">600</span><span class="s">,</span>
<span class="w">             </span><span class="s">--redirect_uri_scheme</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;https&quot;,</span>
<span class="w">             </span><span class="s">--logout_path</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;/logout&quot;,</span>
<span class="w">             </span><span class="s">--redirect_after_logout_uri</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;/&quot;,</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Where</span><span class="w"> </span><span class="s">should</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">user</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">redirected</span><span class="w"> </span><span class="s">after</span><span class="w"> </span><span class="s">logout</span><span class="w"> </span><span class="s">from</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">RP.</span><span class="w"> </span><span class="s">This</span><span class="w"> </span><span class="s">option</span><span class="w"> </span><span class="s">overides</span><span class="w"> </span><span class="s">any</span><span class="w"> </span><span class="s">end_session_endpoint</span><span class="w"> </span><span class="s">that</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">OP</span><span class="w"> </span><span class="s">may</span><span class="w"> </span><span class="s">have</span><span class="w"> </span><span class="s">provided</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">discovery</span><span class="w"> </span><span class="s">response.</span>
<span class="w">             </span><span class="s">--redirect_after_logout_with_id_token_hint</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">true,</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Whether</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">redirection</span><span class="w"> </span><span class="s">after</span><span class="w"> </span><span class="s">logout</span><span class="w"> </span><span class="s">should</span><span class="w"> </span><span class="s">include</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">id</span><span class="w"> </span><span class="s">token</span><span class="w"> </span><span class="s">as</span><span class="w"> </span><span class="s">an</span><span class="w"> </span><span class="s">hint</span><span class="w"> </span><span class="s">(if</span><span class="w"> </span><span class="s">available).</span><span class="w"> </span><span class="s">This</span><span class="w"> </span><span class="s">option</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">used</span><span class="w"> </span><span class="no">on</span><span class="s">ly</span><span class="w"> </span><span class="s">if</span><span class="w"> </span><span class="s">redirect_after_logout_uri</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">set.</span>
<span class="w">             </span><span class="s">--post_logout_redirect_uri</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;https://www.zmartzone.eu/logoutSuccessful&quot;,</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Where</span><span class="w"> </span><span class="s">does</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">RP</span><span class="w"> </span><span class="s">requests</span><span class="w"> </span><span class="s">that</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">OP</span><span class="w"> </span><span class="s">redirects</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">user</span><span class="w"> </span><span class="s">after</span><span class="w"> </span><span class="s">logout.</span><span class="w"> </span><span class="s">If</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">option</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">relative</span><span class="w"> </span><span class="s">URI,</span><span class="w"> </span><span class="s">it</span><span class="w"> </span><span class="s">will</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">relative</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">OP&#39;s</span><span class="w"> </span><span class="s">logout</span><span class="w"> </span><span class="s">endpoint,</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">RP&#39;s.</span>

<span class="w">             </span><span class="s">--accept_none_alg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">false</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">if</span><span class="w"> </span><span class="s">your</span><span class="w"> </span><span class="s">OpenID</span><span class="w"> </span><span class="s">Connect</span><span class="w"> </span><span class="s">Provider</span><span class="w"> </span><span class="s">doesn&#39;t</span><span class="w"> </span><span class="s">sign</span><span class="w"> </span><span class="s">its</span><span class="w"> </span><span class="s">id</span><span class="w"> </span><span class="s">tokens</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">(uses</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">&quot;none&quot;</span><span class="w"> </span><span class="s">signature</span><span class="w"> </span><span class="s">algorithm)</span><span class="w"> </span><span class="s">then</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">true.</span>

<span class="w">             </span><span class="s">--accept_unsupported_alg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">true</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">if</span><span class="w"> </span><span class="s">you</span><span class="w"> </span><span class="s">want</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">reject</span><span class="w"> </span><span class="s">tokens</span><span class="w"> </span><span class="s">signed</span><span class="w"> </span><span class="s">using</span><span class="w"> </span><span class="s">an</span><span class="w"> </span><span class="s">algorithm</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">supported</span><span class="w"> </span><span class="s">by</span><span class="w"> </span><span class="s">lua-resty-jwt</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">false.</span><span class="w"> </span><span class="s">If</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">you</span><span class="w"> </span><span class="s">leave</span><span class="w"> </span><span class="s">it</span><span class="w"> </span><span class="s">unset</span><span class="w"> </span><span class="s">or</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">it</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">true,</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">token</span><span class="w"> </span><span class="s">signature</span><span class="w"> </span><span class="s">will</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">be</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">verified</span><span class="w"> </span><span class="s">when</span><span class="w"> </span><span class="s">an</span><span class="w"> </span><span class="s">unsupported</span><span class="w"> </span><span class="s">algorithm</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">used.</span>

<span class="w">             </span><span class="s">--renew_access_token_on_expiry</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">true</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">whether</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">plugin</span><span class="w"> </span><span class="s">shall</span><span class="w"> </span><span class="s">try</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">silently</span><span class="w"> </span><span class="s">renew</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">access</span><span class="w"> </span><span class="s">token</span><span class="w"> </span><span class="no">on</span><span class="s">ce</span><span class="w"> </span><span class="s">it</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">expired</span><span class="w"> </span><span class="s">if</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">refresh</span><span class="w"> </span><span class="s">token</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">available.</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">if</span><span class="w"> </span><span class="s">it</span><span class="w"> </span><span class="s">fails</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">renew</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">token,</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">user</span><span class="w"> </span><span class="s">will</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">redirected</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">authorization</span><span class="w"> </span><span class="s">endpoint.</span>
<span class="w">             </span><span class="s">--access_token_expires_in</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">3600</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Default</span><span class="w"> </span><span class="s">lifetime</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">seconds</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">access_token</span><span class="w"> </span><span class="s">if</span><span class="w"> </span><span class="s">no</span><span class="w"> </span><span class="s">expires_in</span><span class="w"> </span><span class="s">attribute</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">present</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">token</span><span class="w"> </span><span class="s">endpoint</span><span class="w"> </span><span class="s">response.</span>

<span class="w">             </span><span class="s">--access_token_expires_leeway</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">             </span><span class="s">--</span><span class="w">  </span><span class="s">Expiration</span><span class="w"> </span><span class="s">leeway</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">access_token</span><span class="w"> </span><span class="s">renewal.</span><span class="w"> </span><span class="s">If</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">set,</span><span class="w"> </span><span class="s">renewal</span><span class="w"> </span><span class="s">will</span><span class="w"> </span><span class="s">happen</span><span class="w"> </span><span class="s">access_token_expires_leeway</span><span class="w"> </span><span class="s">seconds</span><span class="w"> </span><span class="s">before</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">token</span><span class="w"> </span><span class="s">expiration.</span><span class="w"> </span><span class="s">This</span><span class="w"> </span><span class="s">avoids</span><span class="w"> </span><span class="s">errors</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">case</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">access_token</span><span class="w"> </span><span class="s">just</span><span class="w"> </span><span class="s">expires</span><span class="w"> </span><span class="s">when</span><span class="w"> </span><span class="s">arriving</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">OAuth</span><span class="w"> </span><span class="s">Resource</span><span class="w"> </span><span class="s">Server.</span>

<span class="w">             </span><span class="s">--force_reauthorize</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">false</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">When</span><span class="w"> </span><span class="s">force_reauthorize</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">true</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">authorization</span><span class="w"> </span><span class="s">flow</span><span class="w"> </span><span class="s">will</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">executed</span><span class="w"> </span><span class="s">even</span><span class="w"> </span><span class="s">if</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">token</span><span class="w"> </span><span class="s">has</span><span class="w"> </span><span class="s">been</span><span class="w"> </span><span class="s">cached</span><span class="w"> </span><span class="s">already</span>
<span class="w">             </span><span class="s">--session_contents</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="kn">id_token=true}</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Whitelist</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">session</span><span class="w"> </span><span class="s">content</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">enable.</span><span class="w"> </span><span class="s">This</span><span class="w"> </span><span class="s">can</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">used</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">reduce</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">session</span><span class="w"> </span><span class="s">size.</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">When</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">everything</span><span class="w"> </span><span class="s">will</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">included</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">session.</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Available</span><span class="w"> </span><span class="s">are:</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">id_token,</span><span class="w"> </span><span class="s">enc_id_token,</span><span class="w"> </span><span class="s">user,</span><span class="w"> </span><span class="s">access_token</span><span class="w"> </span><span class="s">(includes</span><span class="w"> </span><span class="s">refresh</span><span class="w"> </span><span class="s">token)</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">You</span><span class="w"> </span><span class="s">can</span><span class="w"> </span><span class="s">specify</span><span class="w"> </span><span class="s">timeouts</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">connect/send/read</span><span class="w"> </span><span class="s">as</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">single</span><span class="w"> </span><span class="s">number</span><span class="w"> </span><span class="s">(setting</span><span class="w"> </span><span class="s">all</span><span class="w"> </span><span class="s">timeouts)</span><span class="w"> </span><span class="s">or</span><span class="w"> </span><span class="s">as</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">table.</span><span class="w"> </span><span class="s">Values</span><span class="w"> </span><span class="s">are</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">milliseconds</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">timeout</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">timeout</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kn">connect</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">500</span><span class="s">,</span><span class="w"> </span><span class="s">send</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1000</span><span class="s">,</span><span class="w"> </span><span class="s">read</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="err">}</span>

<span class="w">             </span><span class="s">--use_nonce</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">false</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">By</span><span class="w"> </span><span class="s">default</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">authorization</span><span class="w"> </span><span class="s">request</span><span class="w"> </span><span class="s">includes</span><span class="w"> </span><span class="s">the</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">nonce</span><span class="w"> </span><span class="s">paramter.</span><span class="w"> </span><span class="s">You</span><span class="w"> </span><span class="s">can</span><span class="w"> </span><span class="s">use</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">option</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">disable</span><span class="w"> </span><span class="s">it</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">which</span><span class="w"> </span><span class="s">may</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">necessary</span><span class="w"> </span><span class="s">when</span><span class="w"> </span><span class="s">talking</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">broken</span><span class="w"> </span><span class="s">OpenID</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Connect</span><span class="w"> </span><span class="s">provider</span><span class="w"> </span><span class="s">that</span><span class="w"> </span><span class="s">ignores</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">paramter</span><span class="w"> </span><span class="s">as</span><span class="w"> </span><span class="s">the</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">id_token</span><span class="w"> </span><span class="s">will</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">rejected</span><span class="w"> </span><span class="s">otherwise.</span>

<span class="w">             </span><span class="s">--revoke_tokens_on_logout</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">false</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">When</span><span class="w"> </span><span class="s">revoke_tokens_on_logout</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">true</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">logout</span><span class="w"> </span><span class="s">notifies</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">authorization</span><span class="w"> </span><span class="s">server</span><span class="w"> </span><span class="s">that</span><span class="w"> </span><span class="s">previously</span><span class="w"> </span><span class="s">obtained</span><span class="w"> </span><span class="s">refresh</span><span class="w"> </span><span class="s">and</span><span class="w"> </span><span class="s">access</span><span class="w"> </span><span class="s">tokens</span><span class="w"> </span><span class="s">are</span><span class="w"> </span><span class="s">no</span><span class="w"> </span><span class="s">longer</span><span class="w"> </span><span class="s">needed.</span><span class="w"> </span><span class="s">This</span><span class="w"> </span><span class="s">requires</span><span class="w"> </span><span class="s">that</span><span class="w"> </span><span class="s">revocation_endpoint</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">discoverable.</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">If</span><span class="w"> </span><span class="s">there</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">no</span><span class="w"> </span><span class="s">revocation</span><span class="w"> </span><span class="s">endpoint</span><span class="w"> </span><span class="s">supplied</span><span class="w"> </span><span class="s">or</span><span class="w"> </span><span class="s">if</span><span class="w"> </span><span class="s">there</span><span class="w"> </span><span class="s">are</span><span class="w"> </span><span class="s">errors</span><span class="w"> </span><span class="no">on</span><span class="w"> </span><span class="s">revocation</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">user</span><span class="w"> </span><span class="s">will</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">notified</span><span class="w"> </span><span class="s">and</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">logout</span><span class="w"> </span><span class="s">process</span><span class="w"> </span><span class="s">continues</span><span class="w"> </span><span class="s">normally.</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Optional</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s">use</span><span class="w"> </span><span class="s">outgoing</span><span class="w"> </span><span class="s">proxy</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">OpenID</span><span class="w"> </span><span class="s">Connect</span><span class="w"> </span><span class="s">provider</span><span class="w"> </span><span class="s">endpoints</span><span class="w"> </span><span class="s">with</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">proxy_opts</span><span class="w"> </span><span class="s">table</span><span class="w"> </span><span class="p">:</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">requires</span><span class="w"> </span><span class="s">lua-resty-http</span><span class="w"> </span><span class="s">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="s">.12</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">proxy_opts</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="kn">--</span><span class="w">    </span><span class="s">http_proxy</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;http://&lt;proxy_host&gt;:&lt;proxy_port&gt;/&quot;,</span>
<span class="w">             </span><span class="s">--</span><span class="w">    </span><span class="s">https_proxy</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;http://&lt;proxy_host&gt;:&lt;proxy_port&gt;/&quot;</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="err">}</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Lifecycle</span><span class="w"> </span><span class="s">Hooks</span>
<span class="w">             </span><span class="s">--</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">lifecycle</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="kn">--</span><span class="w">    </span><span class="no">on</span><span class="s">_created</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">handle_created,</span>
<span class="w">             </span><span class="s">--</span><span class="w">    </span><span class="no">on</span><span class="s">_authenticated</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">handle_authenticated,</span>
<span class="w">             </span><span class="s">--</span><span class="w">    </span><span class="no">on</span><span class="s">_regenerated</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">handle_regenerated</span>
<span class="w">             </span><span class="s">--</span><span class="w">    </span><span class="no">on</span><span class="s">_logout</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">handle_logout</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="err">}</span>
<span class="w">             </span><span class="s">--</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">where</span><span class="w"> </span><span class="s">`handle_created`,</span><span class="w"> </span><span class="s">`handle_authenticated`,</span><span class="w"> </span><span class="s">`handle_regenerated`</span><span class="w"> </span><span class="s">and</span><span class="w"> </span><span class="s">`handle_logout`</span><span class="w"> </span><span class="s">are</span><span class="w"> </span><span class="s">callables</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">accepting</span><span class="w"> </span><span class="s">argument</span><span class="w"> </span><span class="s">`session`.</span><span class="w"> </span><span class="s">`handle_created`</span><span class="w"> </span><span class="s">accepts</span><span class="w"> </span><span class="s">also</span><span class="w"> </span><span class="s">second</span><span class="w"> </span><span class="s">argument</span><span class="w"> </span><span class="s">`params`</span><span class="w"> </span><span class="s">which</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">table</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">containing</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">query</span><span class="w"> </span><span class="s">parameters</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">authorization</span><span class="w"> </span><span class="s">request</span><span class="w"> </span><span class="s">used</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">redirect</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">user</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">OpenID</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Connect</span><span class="w"> </span><span class="s">provider</span><span class="w"> </span><span class="s">endpoint.</span>
<span class="w">             </span><span class="s">--</span>
<span class="w">             </span><span class="s">--</span><span class="w">  </span><span class="s">--</span><span class="w"> </span><span class="s">`on_created`</span><span class="w"> </span><span class="s">hook</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">invoked</span><span class="w"> </span><span class="s">*after*</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">session</span><span class="w"> </span><span class="s">has</span><span class="w"> </span><span class="s">been</span><span class="w"> </span><span class="s">created</span><span class="w"> </span><span class="s">in</span>
<span class="w">             </span><span class="s">--</span><span class="w">     </span><span class="s">`openidc_authorize`</span><span class="w"> </span><span class="s">immediately</span><span class="w"> </span><span class="s">prior</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">saving</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">session</span>
<span class="w">             </span><span class="s">--</span><span class="w">  </span><span class="s">--</span><span class="w"> </span><span class="s">`on_authenticated`</span><span class="w"> </span><span class="s">hook</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">invoked</span><span class="w"> </span><span class="s">*after*</span><span class="w"> </span><span class="s">receiving</span><span class="w"> </span><span class="s">authorization</span><span class="w"> </span><span class="s">response</span><span class="w"> </span><span class="s">in</span>
<span class="w">             </span><span class="s">--</span><span class="w">     </span><span class="s">`openidc_authorization_response`</span><span class="w"> </span><span class="s">immediately</span><span class="w"> </span><span class="s">prior</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">saving</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">session</span>
<span class="w">             </span><span class="s">--</span><span class="w">     </span><span class="s">Starting</span><span class="w"> </span><span class="s">with</span><span class="w"> </span><span class="s">lua-resty-openidc</span><span class="w"> </span><span class="mi">1</span><span class="s">.7.5</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">receives</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">decoded</span><span class="w"> </span><span class="s">id_token</span><span class="w"> </span><span class="s">as</span><span class="w"> </span><span class="s">second</span><span class="w"> </span><span class="s">and</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">response</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">token</span><span class="w"> </span><span class="s">endpoint</span><span class="w"> </span><span class="s">as</span><span class="w"> </span><span class="s">third</span><span class="w"> </span><span class="s">argument</span><span class="w">      </span>
<span class="w">             </span><span class="s">--</span><span class="w">  </span><span class="s">--</span><span class="w"> </span><span class="s">`on_regenerated`</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">invoked</span><span class="w"> </span><span class="s">immediately</span><span class="w"> </span><span class="s">after</span><span class="w"> </span><span class="s">the</span>
<span class="w">                     </span><span class="s">a</span><span class="w"> </span><span class="s">new</span><span class="w"> </span><span class="s">access</span><span class="w"> </span><span class="s">token</span><span class="w"> </span><span class="s">has</span><span class="w"> </span><span class="s">been</span><span class="w"> </span><span class="s">obtained</span><span class="w"> </span><span class="s">via</span><span class="w"> </span><span class="s">token</span>
<span class="w">                     </span><span class="s">refresh</span><span class="w"> </span><span class="s">and</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">called</span><span class="w"> </span><span class="s">with</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">regenerated</span><span class="w"> </span><span class="s">session</span><span class="w"> </span><span class="s">table</span>
<span class="w">             </span><span class="s">--</span><span class="w">  </span><span class="s">--</span><span class="w"> </span><span class="s">`on_logout`</span><span class="w"> </span><span class="s">hook</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">invoked</span><span class="w"> </span><span class="s">*before*</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">session</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">destroyed</span><span class="w"> </span><span class="s">in</span>
<span class="w">             </span><span class="s">--</span><span class="w">     </span><span class="s">`openidc_logout`</span>
<span class="w">             </span><span class="s">--</span>
<span class="w">             </span><span class="s">--</span><span class="w">  </span><span class="s">Any,</span><span class="w"> </span><span class="s">all</span><span class="w"> </span><span class="s">or</span><span class="w"> </span><span class="s">none</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">hooks</span><span class="w"> </span><span class="s">may</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">used.</span><span class="w"> </span><span class="s">Empty</span><span class="w"> </span><span class="s">`lifecycle`</span><span class="w"> </span><span class="s">does</span><span class="w"> </span><span class="s">nothing.</span>
<span class="w">             </span><span class="s">--</span><span class="w">  </span><span class="s">A</span><span class="w"> </span><span class="s">hook</span><span class="w"> </span><span class="s">that</span><span class="w"> </span><span class="s">returns</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">truthy</span><span class="w"> </span><span class="s">value</span><span class="w"> </span><span class="s">causes</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">lifecycle</span><span class="w"> </span><span class="s">action</span><span class="w"> </span><span class="s">they</span><span class="w"> </span><span class="s">are</span><span class="w"> </span><span class="s">taking</span><span class="w"> </span><span class="s">part</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">fail.</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Optional</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s">add</span><span class="w"> </span><span class="s">decorator</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">HTTP</span><span class="w"> </span><span class="s">request</span><span class="w"> </span><span class="s">that</span><span class="w"> </span><span class="s">is</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">applied</span><span class="w"> </span><span class="s">when</span><span class="w"> </span><span class="s">lua-resty-openidc</span><span class="w"> </span><span class="s">talks</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">OpenID</span><span class="w"> </span><span class="s">Connect</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">provider</span><span class="w"> </span><span class="s">directly.</span><span class="w"> </span><span class="s">Can</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">used</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">provide</span><span class="w"> </span><span class="s">extra</span><span class="w"> </span><span class="s">HTTP</span><span class="w"> </span><span class="s">headers</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">or</span><span class="w"> </span><span class="s">add</span><span class="w"> </span><span class="s">other</span><span class="w"> </span><span class="s">similar</span><span class="w"> </span><span class="s">behavior.</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">http_request_decorator</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">function(req)</span>
<span class="w">             </span><span class="s">--</span><span class="w">   </span><span class="s">local</span><span class="w"> </span><span class="s">h</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">req.headers</span><span class="w"> </span><span class="s">or</span><span class="w"> </span><span class="p">{}</span>
<span class="w">             </span><span class="kn">--</span><span class="w">   </span><span class="s">h[EXTRA_HEADER]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;my</span><span class="w"> </span><span class="s">extra</span><span class="w"> </span><span class="s">header&#39;</span>
<span class="w">             </span><span class="s">--</span><span class="w">   </span><span class="s">req.headers</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">h</span>
<span class="w">             </span><span class="s">--</span><span class="w">   </span><span class="s">return</span><span class="w"> </span><span class="s">req</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">end,</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">use_pkce</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">false,</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">when</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">true</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">&quot;Proof</span><span class="w"> </span><span class="s">Key</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">Code</span><span class="w"> </span><span class="s">Exchange&quot;</span><span class="w"> </span><span class="s">as</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">defined</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">RFC</span><span class="w"> </span><span class="mi">7636</span><span class="w"> </span><span class="s">will</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">used.</span><span class="w"> </span><span class="s">The</span><span class="w"> </span><span class="s">code</span><span class="w"> </span><span class="s">challenge</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">method</span><span class="w"> </span><span class="s">will</span><span class="w"> </span><span class="s">alwas</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">S256</span>

<span class="w">          </span><span class="err">}</span>

<span class="w">          </span><span class="s">--</span><span class="w"> </span><span class="s">call</span><span class="w"> </span><span class="s">authenticate</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">OpenID</span><span class="w"> </span><span class="s">Connect</span><span class="w"> </span><span class="s">user</span><span class="w"> </span><span class="s">authentication</span>
<span class="w">          </span><span class="s">local</span><span class="w"> </span><span class="s">res,</span><span class="w"> </span><span class="s">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">require(&quot;resty.openidc&quot;).authenticate(opts)</span>

<span class="w">          </span><span class="s">if</span><span class="w"> </span><span class="s">err</span><span class="w"> </span><span class="s">then</span>
<span class="w">            </span><span class="s">ngx.status</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">500</span>
<span class="w">            </span><span class="s">ngx.say(err)</span>
<span class="w">            </span><span class="s">ngx.exit(ngx.HTTP_INTERNAL_SERVER_ERROR)</span>
<span class="w">          </span><span class="s">end</span>

<span class="w">          </span><span class="s">--</span><span class="w"> </span><span class="s">at</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">point</span><span class="w"> </span><span class="s">res</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">Lua</span><span class="w"> </span><span class="s">table</span><span class="w"> </span><span class="s">with</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="s">keys:</span>
<span class="w">          </span><span class="s">--</span><span class="w">   </span><span class="s">id_token</span><span class="w">    </span><span class="p">:</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">Lua</span><span class="w"> </span><span class="s">table</span><span class="w"> </span><span class="s">with</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">claims</span><span class="w"> </span><span class="s">from</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">id_token</span><span class="w"> </span><span class="s">(required)</span>
<span class="w">          </span><span class="s">--</span><span class="w">   </span><span class="s">access_token:</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">access</span><span class="w"> </span><span class="s">token</span><span class="w"> </span><span class="s">(optional)</span>
<span class="w">          </span><span class="s">--</span><span class="w">   </span><span class="s">user</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">Lua</span><span class="w"> </span><span class="s">table</span><span class="w"> </span><span class="s">with</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">claims</span><span class="w"> </span><span class="s">returned</span><span class="w"> </span><span class="s">from</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">user</span><span class="w"> </span><span class="s">info</span><span class="w"> </span><span class="s">endpoint</span><span class="w"> </span><span class="s">(optional)</span>

<span class="w">          </span><span class="s">--if</span><span class="w"> </span><span class="s">res.id_token.hd</span><span class="w"> </span><span class="p">~</span><span class="sr">=</span><span class="w"> </span><span class="s">&quot;zmartzone.eu&quot;</span><span class="w"> </span><span class="s">then</span>
<span class="w">          </span><span class="s">--</span><span class="w">  </span><span class="s">ngx.exit(ngx.HTTP_FORBIDDEN)</span>
<span class="w">          </span><span class="s">--end</span>

<span class="w">          </span><span class="s">--if</span><span class="w"> </span><span class="s">res.user.email</span><span class="w"> </span><span class="p">~</span><span class="sr">=</span><span class="w"> </span><span class="s">&quot;hans.zandbelt@zmartzone.eu&quot;</span><span class="w"> </span><span class="s">then</span>
<span class="w">          </span><span class="s">--</span><span class="w">  </span><span class="s">ngx.exit(ngx.HTTP_FORBIDDEN)</span>
<span class="w">          </span><span class="s">--end</span>

<span class="w">          </span><span class="s">--</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">headers</span><span class="w"> </span><span class="s">with</span><span class="w"> </span><span class="s">user</span><span class="w"> </span><span class="s">info:</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">will</span><span class="w"> </span><span class="s">overwrite</span><span class="w"> </span><span class="s">any</span><span class="w"> </span><span class="s">existing</span><span class="w"> </span><span class="s">headers</span>
<span class="w">          </span><span class="s">--</span><span class="w"> </span><span class="s">but</span><span class="w"> </span><span class="s">also</span><span class="w"> </span><span class="s">scrub(!)</span><span class="w"> </span><span class="s">them</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">case</span><span class="w"> </span><span class="s">no</span><span class="w"> </span><span class="s">value</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">provided</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">token</span>
<span class="w">          </span><span class="s">ngx.req.set_header(&quot;X-USER&quot;,</span><span class="w"> </span><span class="s">res.id_token.sub)</span>
<span class="w">      </span><span class="err">}</span>

<span class="w">      </span><span class="s">proxy_pass</span><span class="w"> </span><span class="s">http://localhost:80</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="about-redirect_uri">About <code>redirect_uri</code></h2>
<p>The so called <code>redirect_uri</code> is an URI that is part of the OpenID
Connect protocoll. The redirect URI is registered with your OpenID
Connect provider and is the URI your provider will redirect the users
to after successful login. This URI then is handelled by
lua-resty-openidc where it obtains tokens and performs some checks and
only after that the browser is redirected to where your user wanted to
go initially.</p>
<p>The <code>redirect_uri</code> is not expected to be handelled by your appication
code at all. It must be an URI wthat lua-resty-openidc is responsible
for so it must be in a <code>location</code> protected by lua-resty-openidc.</p>
<p>You configure the <code>redirect_uri</code> on the lua-resty-openidc side via the
<code>opts.redirect_uri</code> parameter (which defaults to <code>/redirect_uri</code>). If
it starts with a <code>/</code> then lua-resty-openidc will prepend the protocoll
and current hostname to it when sending the URI to the OpenID Connect
provider (taking <code>Forwarded</code> and <code>X-Forwarded-*</code> <abbr title="Hyper Text Transfer Protocol">HTTP</abbr> headers into
account). But you can also specify an absolute URI containing host and
protocoll yourself.</p>
<p>Before version 1.6.1 <code>opts.redirect_uri_path</code> has been the way to
configure the <code>redirect_uri</code> without any option to take control over
the protocoll and host parts.</p>
<p>Whenever lua-resty-openidc "sees" a local path navigated that matches
the path of <code>opts.redirect_uri</code> (or <code>opts.redirect_uri_path</code>) it will
intercept the request and handle it itself.</p>
<p>This works for most cases but sometimes the externally visible
<code>redirect_uri</code> has a different path than the one locally visible to
the server. This may happen if a reverse proxy in front of your server
rewrites URIs before forwarding the requests. Therefore version 1.7.6
introduced a new option <code>opts.local_redirect_uri_path</code>. If it is set
lua-resty-opendic will intercepts requests to this path rather than
the path of <code>opts.redirect_uri</code>.</p>
<h2 id="check-authentication-only">Check authentication only</h2>
<div class="highlight"><pre><span></span><code><span class="c1">-- check session, but do not redirect to auth if not already logged in</span>
<span class="kd">local</span> <span class="n">res</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s2">&quot;resty.openidc&quot;</span><span class="p">).</span><span class="n">authenticate</span><span class="p">(</span><span class="n">opts</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="s2">&quot;pass&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="check-authentication-only-and-deny-unauthenticated-access">Check authentication only and deny unauthenticated access</h2>
<div class="highlight"><pre><span></span><code><span class="c1">-- check session, do not redirect to auth if not already logged in but return an error instead</span>
<span class="kd">local</span> <span class="n">res</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s2">&quot;resty.openidc&quot;</span><span class="p">).</span><span class="n">authenticate</span><span class="p">(</span><span class="n">opts</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="s2">&quot;deny&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="sessions-and-locking">Sessions and Locking</h2>
<p>The <code>authenticate</code> function returns the current session object as its
forth return argument. If you have configured lua-resty-session to use
a server side storage backend that uses locking, the session may still
be locked when it is returned. In this case you may want to close it
explicitly</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">res</span><span class="p">,</span> <span class="n">err</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">session</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s2">&quot;resty.openidc&quot;</span><span class="p">).</span><span class="n">authenticate</span><span class="p">(</span><span class="n">opts</span><span class="p">)</span>
<span class="n">session</span><span class="p">:</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
<h2 id="caching">Caching</h2>
<p>lua-resty-openidc can use <a href="https://github.com/openresty/lua-nginx-module/#lua_shared_dict">shared memory
caches</a>
for several things. If you want it to use the caches, you must use
<code>lua_shared_dict</code> in your <code>nginx.conf</code> file.</p>
<p>Currently up to four caches are used</p>
<ul>
<li>the cache named <code>discovery</code> stores the OpenID Connect Disovery
  metadata of your OpenID Connect Provider. Cache items expire after
  24 hours unless overriden by <code>opts.discovery_expires_in</code> (a value
  given in seconds) . This cache will store one item per issuer URI
  and you can look up the discovery document yourself to get an
  estimate for the size required - usually a few kB per OpenID Connect
  Provider.</li>
<li>the cache named <code>jwks</code> stores the key material of your OpenID
  Connect Provider if it is provided via the JWKS endpoint. Cache
  items expire after 24 hours unless overriden by
  <code>opts.jwks_expires_in</code>. This cache will store one item per JWKS URI
  and you can look up the jwks yourself to get an estimate for the
  size required - usually a few kB per OpenID Connect Provider.</li>
<li>the cache named <code>introspection</code> stores the result of OAuth2 token
  introspection. Cache items expire when the corresponding token
  expires. Tokens with unknown expiry are not cached at all. This
  cache will contain one entry per introspected access token - usually
  this will be a few kB per token.</li>
<li>the cache named <code>jwt_verification</code> stores the result of JWT
  verification.  Cache items expire when the corresponding token
  expires. Tokens with unknown expiry are not cached for two
  minutes. This cache will contain one entry per verified JWT -
  usually this will be a few kB per token.</li>
</ul>
<h2 id="caching-of-introspection-and-jwt-verification-results">Caching of Introspection and JWT Verification Results</h2>
<p>Note the <code>jwt_verification</code> and <code>introspection</code> caches are shared
between all configured locations. If you are using locations with
different <code>opts</code> configuration the shared cache may allow a token that
is valid for only one location to be accepted by another if it is read
from the cache. In order to avoid cache confusion it is recommended to
set <code>opts.cache_segment</code> to unique strings for each set of related
locations.</p>
<h2 id="revoke-tokens">Revoke tokens</h2>
<p>The <code>revoke_tokens(opts, session)</code> function revokes the current refresh and access token. In contrast to a full logout, the session cookie will not be destroyed and the endsession endpoint will not be called. The function returns <code>true</code> if both tokens were revoked successfully. This function might be helpful in scenarios where you want to destroy/remove a session from the server side.</p>
<p>With <code>revoke_token(opts, token_type_hint, token)</code> it is also possible to revoke a specific token. <code>token_type_hint</code> can usually be <code>refresh_token</code> or <code>access_token</code>.</p>
<h2 id="sample-configuration-for-oauth-20-jwt-token-validation">Sample Configuration for OAuth 2.0 JWT Token Validation</h2>
<p>Sample <code>nginx.conf</code> configuration for verifying Bearer JWT Access Tokens against a pre-configured secret/key.
Once successfully verified, the NGINX server may function as a reverse proxy to an internal origin server.</p>
<div class="highlight"><pre><span></span><code><span class="k">events</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kn">worker_connections</span><span class="w"> </span><span class="mi">128</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">http</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="kn">resolver</span><span class="w"> </span><span class="mi">8</span><span class="s">.8.8.8</span><span class="p">;</span>

<span class="w">  </span><span class="c1"># cache for JWT verification results</span>
<span class="w">  </span><span class="kn">lua_shared_dict</span><span class="w"> </span><span class="s">jwt_verification</span><span class="w"> </span><span class="mi">10m</span><span class="p">;</span>

<span class="w">  </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">8080</span><span class="p">;</span>

<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/api</span><span class="w"> </span><span class="p">{</span>

<span class="w">      </span><span class="kn">access_by_lua</span><span class="w"> </span><span class="s">&#39;</span>

<span class="w">          </span><span class="s">local</span><span class="w"> </span><span class="s">opts</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="kn">--</span><span class="w"> </span><span class="mi">1</span><span class="s">.</span><span class="w"> </span><span class="s">example</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">shared</span><span class="w"> </span><span class="s">secret</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">HS???</span><span class="w"> </span><span class="s">signature</span><span class="w"> </span><span class="s">verification</span>
<span class="w">            </span><span class="s">--symmetric_key</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;,</span>
<span class="w">            </span><span class="s">--</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">versions</span><span class="w"> </span><span class="s">up</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="mi">1</span><span class="s">.6.1</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">option&#39;s</span><span class="w"> </span><span class="s">key</span><span class="w"> </span><span class="s">would</span><span class="w"> </span><span class="s">have</span><span class="w"> </span><span class="s">been</span><span class="w"> </span><span class="s">secret</span>
<span class="w">            </span><span class="s">--</span><span class="w"> </span><span class="s">rather</span><span class="w"> </span><span class="s">than</span><span class="w"> </span><span class="s">symmetric_key</span>

<span class="w">            </span><span class="s">--</span><span class="w"> </span><span class="mi">2</span><span class="s">.</span><span class="w"> </span><span class="s">another</span><span class="w"> </span><span class="s">example</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">public</span><span class="w"> </span><span class="s">cert</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">RS???</span><span class="w"> </span><span class="s">signature</span><span class="w"> </span><span class="s">verification</span>
<span class="w">            </span><span class="s">public_key</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">[[-----BEGIN</span><span class="w"> </span><span class="s">CERTIFICATE-----</span>
<span class="s">MIIC0DCCAbigAwIBAgIGAVSbMZs1MA0GCSqGSIb3DQEBCwUAMCkxCzAJBgNVBAYTAlVTMQwwCgYD</span>
<span class="s">VQQKEwNibGExDDAKBgNVBAMTA2JsYTAeFw0xNjA1MTAxNTAzMjBaFw0yNjA1MDgxNTAzMjBaMCkx</span>
<span class="s">CzAJBgNVBAYTAlVTMQwwCgYDVQQKEwNibGExDDAKBgNVBAMTA2JsYTCCASIwDQYJKoZIhvcNAQEB</span>
<span class="s">BQADggEPADCCAQoCggEBAIcLtHjX2GFxYv1033dvfohyCU6nsuR1qoDXfHTG3Mf/Yj4BfLHtMjJr</span>
<span class="s">nR3sgHItH3B6qZPnfErfsN0LP4uZ10/74CrWVqT5dy6ecXMqYtz/KNJ8rG0vY8vltc417AU4fie8</span>
<span class="s">gyeWv/Z6wHWUCf3NHRV8GfFgfuvywgUpHo8ujpUPFr+zrPr8butrzJPq1h3+r0f5P45tfWOdpjCT</span>
<span class="s">gsTzK6urUG0k3WkwdDYapL3wRCAw597nYfgKzzXuh9N0ZL3Uj+eJ6BgCzUZDLXABpMBZfk6hmmzp</span>
<span class="s">cAFV4nTf1AaAs/EOwVE0YgZBJiBrueMcteAIxKrKjEHgThU2Zs9gN9cSFicCAwEAATANBgkqhkiG</span>
<span class="s">9w0BAQsFAAOCAQEAQLU1A58TrSwrEccCIy0wxiGdCwQbaNMohzirc41zRMCXleJXbtsn1vv85J6A</span>
<span class="s">RmejeH5f/JbDqRRRArGMdLooGbqjWG/lwZT456Q6DXqF2plkBvh37kp/GjthGyR8ODJn5ekZwxuB</span>
<span class="s">OcTuruRhqYOIJjiYZSgK/P0zUw1cjLwUJ9ig/O6ozYmof83974fygA/wK3SgFNEoFlTkTpOvZhVW</span>
<span class="s">9kLfCVA/CRBfJNKnz5PWBBxd/3XSEuP/fcWqKGTy7zZso4MTB0NKgWO4duGTgMyZbM4onJPyA0CY</span>
<span class="s">lAc5Csj0o5Q+oEhPUAVBIF07m4rd0OvAVPOCQ2NJhQSL1oWASbf+fg==</span>
<span class="s">-----END</span><span class="w"> </span><span class="s">CERTIFICATE-----]],</span>
<span class="w">            </span><span class="s">--</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">versions</span><span class="w"> </span><span class="s">up</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="mi">1</span><span class="s">.6.1</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">option&#39;s</span><span class="w"> </span><span class="s">key</span><span class="w"> </span><span class="s">would</span><span class="w"> </span><span class="s">have</span><span class="w"> </span><span class="s">been</span><span class="w"> </span><span class="s">secret</span>
<span class="w">            </span><span class="s">--</span><span class="w"> </span><span class="s">rather</span><span class="w"> </span><span class="s">than</span><span class="w"> </span><span class="s">public_key</span>

<span class="w">            </span><span class="s">--</span><span class="w"> </span><span class="mi">3</span><span class="s">.</span><span class="w"> </span><span class="s">alternatively</span><span class="w"> </span><span class="no">on</span><span class="s">e</span><span class="w"> </span><span class="s">can</span><span class="w"> </span><span class="s">point</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">so-called</span><span class="w"> </span><span class="s">Discovery</span><span class="w"> </span><span class="s">document</span><span class="w"> </span><span class="s">that</span>
<span class="w">            </span><span class="s">--</span><span class="w"> </span><span class="s">contains</span><span class="w"> </span><span class="s">&quot;jwks_uri&quot;</span><span class="w"> </span><span class="s">entry</span><span class="p">;</span><span class="w"> </span><span class="kn">the</span><span class="w"> </span><span class="s">jwks</span><span class="w"> </span><span class="s">endpoint</span><span class="w"> </span><span class="s">must</span><span class="w"> </span><span class="s">provide</span><span class="w"> </span><span class="s">either</span><span class="w"> </span><span class="s">an</span><span class="w"> </span><span class="s">&quot;x5c&quot;</span><span class="w"> </span><span class="s">entry</span>
<span class="w">            </span><span class="s">--</span><span class="w"> </span><span class="s">or</span><span class="w"> </span><span class="s">both</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">&quot;n&quot;</span><span class="w"> </span><span class="s">modulus</span><span class="w"> </span><span class="s">and</span><span class="w"> </span><span class="s">&quot;e&quot;</span><span class="w"> </span><span class="s">exponent</span><span class="w"> </span><span class="s">entries</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">RSA</span><span class="w"> </span><span class="s">signature</span><span class="w"> </span><span class="s">verification</span>
<span class="w">            </span><span class="s">--</span><span class="w"> </span><span class="s">discovery</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;https://accounts.google.com/.well-known/openid-configuration&quot;,</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">signature</span><span class="w"> </span><span class="s">algorithm</span><span class="w"> </span><span class="s">that</span><span class="w"> </span><span class="s">you</span><span class="w"> </span><span class="s">expect</span><span class="w"> </span><span class="s">has</span><span class="w"> </span><span class="s">been</span><span class="w"> </span><span class="s">used</span><span class="p">;</span>
<span class="w">             </span><span class="kn">--</span><span class="w"> </span><span class="s">can</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">single</span><span class="w"> </span><span class="s">string</span><span class="w"> </span><span class="s">or</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">table.</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">You</span><span class="w"> </span><span class="s">should</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">security</span><span class="w"> </span><span class="s">reasons</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">order</span><span class="w"> </span><span class="s">to</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">avoid</span><span class="w"> </span><span class="s">accepting</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">token</span><span class="w"> </span><span class="s">claiming</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">signed</span><span class="w"> </span><span class="s">by</span><span class="w"> </span><span class="s">HMAC</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">using</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">public</span><span class="w"> </span><span class="s">RSA</span><span class="w"> </span><span class="s">key.</span>
<span class="w">             </span><span class="s">--token_signing_alg_values_expected</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kn">&quot;RS256&quot;</span><span class="w"> </span><span class="err">}</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">if</span><span class="w"> </span><span class="s">you</span><span class="w"> </span><span class="s">want</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">accept</span><span class="w"> </span><span class="s">unsigned</span><span class="w"> </span><span class="s">tokens</span><span class="w"> </span><span class="s">(using</span><span class="w"> </span><span class="s">the</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">&quot;none&quot;</span><span class="w"> </span><span class="s">signature</span><span class="w"> </span><span class="s">algorithm)</span><span class="w"> </span><span class="s">then</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">true.</span>
<span class="w">             </span><span class="s">--accept_none_alg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">false</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">if</span><span class="w"> </span><span class="s">you</span><span class="w"> </span><span class="s">want</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">reject</span><span class="w"> </span><span class="s">tokens</span><span class="w"> </span><span class="s">signed</span><span class="w"> </span><span class="s">using</span><span class="w"> </span><span class="s">an</span><span class="w"> </span><span class="s">algorithm</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">supported</span><span class="w"> </span><span class="s">by</span><span class="w"> </span><span class="s">lua-resty-jwt</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">false.</span><span class="w"> </span><span class="s">If</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">you</span><span class="w"> </span><span class="s">leave</span><span class="w"> </span><span class="s">it</span><span class="w"> </span><span class="s">unset,</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">token</span><span class="w"> </span><span class="s">signature</span><span class="w"> </span><span class="s">will</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">be</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">verified</span><span class="w"> </span><span class="s">at</span><span class="w"> </span><span class="s">all.</span>
<span class="w">             </span><span class="s">--accept_unsupported_alg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">true</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">expiration</span><span class="w"> </span><span class="s">time</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">seconds</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">jwk</span><span class="w"> </span><span class="s">cache,</span><span class="w"> </span><span class="s">default</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="s">day.</span>
<span class="w">             </span><span class="s">--jwk_expires_in</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="s">*</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="s">*</span><span class="w"> </span><span class="mi">60</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">It</span><span class="w"> </span><span class="s">may</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">necessary</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">force</span><span class="w"> </span><span class="s">verification</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">bearer</span><span class="w"> </span><span class="s">token</span><span class="w"> </span><span class="s">and</span><span class="w"> </span><span class="s">ignore</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">existing</span><span class="w"> </span><span class="s">cached</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">verification</span><span class="w"> </span><span class="s">results.</span><span class="w"> </span><span class="s">If</span><span class="w"> </span><span class="s">so</span><span class="w"> </span><span class="s">you</span><span class="w"> </span><span class="s">need</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">jwt_verification_cache_ignore</span><span class="w"> </span><span class="s">option</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">true.</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">jwt_verification_cache_ignore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">true</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">optional</span><span class="w"> </span><span class="s">name</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">cache-segment</span><span class="w"> </span><span class="s">if</span><span class="w"> </span><span class="s">you</span><span class="w"> </span><span class="s">need</span><span class="w"> </span><span class="s">separate</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">caches</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">differently</span><span class="w"> </span><span class="s">configured</span><span class="w"> </span><span class="s">locations</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">cache_segment</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;api&#39;</span>
<span class="w">          </span><span class="err">}</span>

<span class="w">          </span><span class="s">--</span><span class="w"> </span><span class="s">call</span><span class="w"> </span><span class="s">bearer_jwt_verify</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">OAuth</span><span class="w"> </span><span class="mi">2</span><span class="s">.0</span><span class="w"> </span><span class="s">JWT</span><span class="w"> </span><span class="s">validation</span>
<span class="w">          </span><span class="s">local</span><span class="w"> </span><span class="s">res,</span><span class="w"> </span><span class="s">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">require(&quot;resty.openidc&quot;).bearer_jwt_verify(opts)</span>

<span class="w">           </span><span class="s">if</span><span class="w"> </span><span class="s">err</span><span class="w"> </span><span class="s">or</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">res</span><span class="w"> </span><span class="s">then</span>
<span class="w">            </span><span class="s">ngx.status</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">403</span>
<span class="w">            </span><span class="s">ngx.say(err</span><span class="w"> </span><span class="s">and</span><span class="w"> </span><span class="s">err</span><span class="w"> </span><span class="s">or</span><span class="w"> </span><span class="s">&quot;no</span><span class="w"> </span><span class="s">access_token</span><span class="w"> </span><span class="s">provided&quot;)</span>
<span class="w">            </span><span class="s">ngx.exit(ngx.HTTP_FORBIDDEN)</span>
<span class="w">          </span><span class="s">end</span>

<span class="w">          </span><span class="s">--</span><span class="w"> </span><span class="s">at</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">point</span><span class="w"> </span><span class="s">res</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">Lua</span><span class="w"> </span><span class="s">table</span><span class="w"> </span><span class="s">that</span><span class="w"> </span><span class="s">represents</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">(validated)</span><span class="w"> </span><span class="s">JSON</span>
<span class="w">          </span><span class="s">--</span><span class="w"> </span><span class="s">payload</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">JWT</span><span class="w"> </span><span class="s">token</span><span class="p">;</span><span class="w"> </span><span class="kn">now</span><span class="w"> </span><span class="s">we</span><span class="w"> </span><span class="s">typically</span><span class="w"> </span><span class="s">do</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">want</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">allow</span><span class="w"> </span><span class="s">just</span><span class="w"> </span><span class="s">any</span>
<span class="w">          </span><span class="s">--</span><span class="w"> </span><span class="s">token</span><span class="w"> </span><span class="s">that</span><span class="w"> </span><span class="s">was</span><span class="w"> </span><span class="s">issued</span><span class="w"> </span><span class="s">by</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">Authorization</span><span class="w"> </span><span class="s">Server</span><span class="w"> </span><span class="s">but</span><span class="w"> </span><span class="s">we</span><span class="w"> </span><span class="s">want</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">apply</span>
<span class="w">          </span><span class="s">--</span><span class="w"> </span><span class="s">some</span><span class="w"> </span><span class="s">access</span><span class="w"> </span><span class="s">restrictions</span><span class="w"> </span><span class="s">via</span><span class="w"> </span><span class="s">client</span><span class="w"> </span><span class="s">IDs</span><span class="w"> </span><span class="s">or</span><span class="w"> </span><span class="s">scopes</span>

<span class="w">          </span><span class="s">--if</span><span class="w"> </span><span class="s">res.scope</span><span class="w"> </span><span class="p">~</span><span class="sr">=</span><span class="w"> </span><span class="s">&quot;edit&quot;</span><span class="w"> </span><span class="s">then</span>
<span class="w">          </span><span class="s">--</span><span class="w">  </span><span class="s">ngx.exit(ngx.HTTP_FORBIDDEN)</span>
<span class="w">          </span><span class="s">--end</span>

<span class="w">          </span><span class="s">--if</span><span class="w"> </span><span class="s">res.client_id</span><span class="w"> </span><span class="p">~</span><span class="sr">=</span><span class="w"> </span><span class="s">&quot;ro_client&quot;</span><span class="w"> </span><span class="s">then</span>
<span class="w">          </span><span class="s">--</span><span class="w">  </span><span class="s">ngx.exit(ngx.HTTP_FORBIDDEN)</span>
<span class="w">          </span><span class="s">--end</span>
<span class="w">      </span><span class="s">&#39;</span><span class="p">;</span>

<span class="w">       </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://localhost:80</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="sample-configuration-for-pingfederate-oauth-20">Sample Configuration for PingFederate OAuth 2.0</h2>
<p>Sample <code>nginx.conf</code> configuration for validating Bearer Access Tokens against a PingFederate OAuth 2.0 Authorization Server.</p>
<div class="highlight"><pre><span></span><code><span class="k">events</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kn">worker_connections</span><span class="w"> </span><span class="mi">128</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">http</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="kn">resolver</span><span class="w"> </span><span class="mi">8</span><span class="s">.8.8.8</span><span class="p">;</span>

<span class="w">  </span><span class="kn">lua_ssl_trusted_certificate</span><span class="w"> </span><span class="s">/opt/local/etc/openssl/cert.pem</span><span class="p">;</span>
<span class="w">  </span><span class="kn">lua_ssl_verify_depth</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>

<span class="w">  </span><span class="c1"># cache for validation results</span>
<span class="w">  </span><span class="kn">lua_shared_dict</span><span class="w"> </span><span class="s">introspection</span><span class="w"> </span><span class="mi">10m</span><span class="p">;</span>

<span class="w">  </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">8080</span><span class="p">;</span>

<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/api</span><span class="w"> </span><span class="p">{</span>

<span class="w">      </span><span class="kn">access_by_lua</span><span class="w"> </span><span class="s">&#39;</span>

<span class="w">          </span><span class="s">local</span><span class="w"> </span><span class="s">opts</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="kn">introspection_endpoint=&quot;https://localhost:9031/as/introspect.oauth2&quot;,</span>
<span class="w">             </span><span class="s">client_id=&quot;rs_client&quot;,</span>
<span class="w">             </span><span class="s">client_secret=&quot;2Federate&quot;,</span>
<span class="w">             </span><span class="s">ssl_verify</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;no&quot;,</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Defaults</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">&quot;exp&quot;</span><span class="w"> </span><span class="s">-</span><span class="w"> </span><span class="s">Controls</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">TTL</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">introspection</span><span class="w"> </span><span class="s">cache</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">https://tools.ietf.org/html/rfc7662</span><span class="c1">#section-2.2</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">introspection_expiry_claim</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;exp&quot;</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">optional</span><span class="w"> </span><span class="s">name</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">cache-segment</span><span class="w"> </span><span class="s">if</span><span class="w"> </span><span class="s">you</span><span class="w"> </span><span class="s">need</span><span class="w"> </span><span class="s">separate</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">caches</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">differently</span><span class="w"> </span><span class="s">configured</span><span class="w"> </span><span class="s">locations</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">cache_segment</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;api&#39;</span>
<span class="w">          </span><span class="err">}</span>

<span class="w">          </span><span class="s">--</span><span class="w"> </span><span class="s">call</span><span class="w"> </span><span class="s">introspect</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">OAuth</span><span class="w"> </span><span class="mi">2</span><span class="s">.0</span><span class="w"> </span><span class="s">Bearer</span><span class="w"> </span><span class="s">Access</span><span class="w"> </span><span class="s">Token</span><span class="w"> </span><span class="s">validation</span>
<span class="w">          </span><span class="s">local</span><span class="w"> </span><span class="s">res,</span><span class="w"> </span><span class="s">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">require(&quot;resty.openidc&quot;).introspect(opts)</span>

<span class="w">          </span><span class="s">if</span><span class="w"> </span><span class="s">err</span><span class="w"> </span><span class="s">then</span>
<span class="w">            </span><span class="s">ngx.status</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">403</span>
<span class="w">            </span><span class="s">ngx.say(err)</span>
<span class="w">            </span><span class="s">ngx.exit(ngx.HTTP_FORBIDDEN)</span>
<span class="w">          </span><span class="s">end</span>

<span class="w">          </span><span class="s">--</span><span class="w"> </span><span class="s">at</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">point</span><span class="w"> </span><span class="s">res</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">Lua</span><span class="w"> </span><span class="s">table</span><span class="w"> </span><span class="s">that</span><span class="w"> </span><span class="s">represents</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">JSON</span>
<span class="w">          </span><span class="s">--</span><span class="w"> </span><span class="s">object</span><span class="w"> </span><span class="s">returned</span><span class="w"> </span><span class="s">from</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">introspection/validation</span><span class="w"> </span><span class="s">endpoint</span>

<span class="w">          </span><span class="s">--if</span><span class="w"> </span><span class="s">res.scope</span><span class="w"> </span><span class="p">~</span><span class="sr">=</span><span class="w"> </span><span class="s">&quot;edit&quot;</span><span class="w"> </span><span class="s">then</span>
<span class="w">          </span><span class="s">--</span><span class="w">  </span><span class="s">ngx.exit(ngx.HTTP_FORBIDDEN)</span>
<span class="w">          </span><span class="s">--end</span>

<span class="w">          </span><span class="s">--if</span><span class="w"> </span><span class="s">res.client_id</span><span class="w"> </span><span class="p">~</span><span class="sr">=</span><span class="w"> </span><span class="s">&quot;ro_client&quot;</span><span class="w"> </span><span class="s">then</span>
<span class="w">          </span><span class="s">--</span><span class="w">  </span><span class="s">ngx.exit(ngx.HTTP_FORBIDDEN)</span>
<span class="w">          </span><span class="s">--end</span>
<span class="w">      </span><span class="s">&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="sample-configuration-for-passing-bearer-oauth-20-access-tokens-as-cookie">Sample Configuration for passing bearer OAuth 2.0 access tokens as cookie</h2>
<p>Sample <code>nginx.conf</code> configuration for validating Bearer Access Tokens passed as cookie against a ORY/Hydra Authorization Server.</p>
<div class="highlight"><pre><span></span><code><span class="k">events</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kn">worker_connections</span><span class="w"> </span><span class="mi">128</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">http</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="kn">resolver</span><span class="w"> </span><span class="mi">8</span><span class="s">.8.8.8</span><span class="p">;</span>

<span class="w">  </span><span class="kn">lua_ssl_trusted_certificate</span><span class="w"> </span><span class="s">/opt/local/etc/openssl/cert.pem</span><span class="p">;</span>
<span class="w">  </span><span class="kn">lua_ssl_verify_depth</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>

<span class="w">  </span><span class="c1"># cache for validation results</span>
<span class="w">  </span><span class="kn">lua_shared_dict</span><span class="w"> </span><span class="s">introspection</span><span class="w"> </span><span class="mi">10m</span><span class="p">;</span>

<span class="w">  </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">8080</span><span class="p">;</span>

<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/api</span><span class="w"> </span><span class="p">{</span>

<span class="w">      </span><span class="kn">access_by_lua</span><span class="w"> </span><span class="s">&#39;</span>

<span class="w">          </span><span class="s">local</span><span class="w"> </span><span class="s">opts</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="kn">--</span><span class="w"> </span><span class="s">sets</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">URI</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">introspection</span><span class="w"> </span><span class="s">endpoint</span>
<span class="w">             </span><span class="s">introspection_endpoint=&quot;https://localhost:9031/oauth2/introspect&quot;,</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">alternatively</span><span class="w"> </span><span class="s">if</span><span class="w"> </span><span class="s">your</span><span class="w"> </span><span class="s">OAuth2</span><span class="w"> </span><span class="s">Provider</span><span class="w"> </span><span class="s">provides</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">discovery</span><span class="w"> </span><span class="s">document</span><span class="w"> </span><span class="s">that</span><span class="w"> </span><span class="s">contains</span><span class="w"> </span><span class="s">the</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">introspection_endpoint</span><span class="w"> </span><span class="s">claim</span><span class="w"> </span><span class="s">you</span><span class="w"> </span><span class="s">can</span><span class="w"> </span><span class="s">leave</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">introspection_endpoint</span><span class="w"> </span><span class="s">option</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">unset</span><span class="w"> </span><span class="s">and</span><span class="w"> </span><span class="s">instead</span><span class="w"> </span><span class="s">use</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">discovery</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;https://my-oauth2-provider/.well-known/oauth-authorization-server&quot;,</span>

<span class="w">             </span><span class="s">client_id=&quot;admin&quot;,</span>
<span class="w">             </span><span class="s">client_secret=&quot;demo-password&quot;,</span>
<span class="w">             </span><span class="s">ssl_verify</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;no&quot;,</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Defines</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">interval</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">seconds</span><span class="w"> </span><span class="s">after</span><span class="w"> </span><span class="s">which</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">cached</span><span class="w"> </span><span class="s">and</span><span class="w"> </span><span class="s">introspected</span><span class="w"> </span><span class="s">access</span><span class="w"> </span><span class="s">token</span><span class="w"> </span><span class="s">needs</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">refreshed</span><span class="w"> </span><span class="s">by</span><span class="w"> </span><span class="s">introspecting</span><span class="w"> </span><span class="s">(and</span><span class="w"> </span><span class="s">validating)</span><span class="w"> </span><span class="s">it</span><span class="w"> </span><span class="s">again</span><span class="w"> </span><span class="s">against</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">Authorization</span><span class="w"> </span><span class="s">Server.</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">When</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">defined</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">value</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="mi">0</span><span class="s">,</span><span class="w"> </span><span class="s">which</span><span class="w"> </span><span class="s">means</span><span class="w"> </span><span class="s">it</span><span class="w"> </span><span class="no">on</span><span class="s">ly</span><span class="w"> </span><span class="s">expires</span><span class="w"> </span><span class="s">after</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">`exp`</span><span class="w"> </span><span class="s">(or</span><span class="w"> </span><span class="s">alternative,</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">see</span><span class="w"> </span><span class="s">introspection_expiry_claim)</span><span class="w"> </span><span class="s">hint</span><span class="w"> </span><span class="s">as</span><span class="w"> </span><span class="s">returned</span><span class="w"> </span><span class="s">by</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">Authorization</span><span class="w"> </span><span class="s">Server</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">introspection_interval</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">60</span><span class="s">,</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Defines</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">way</span><span class="w"> </span><span class="s">in</span><span class="w"> </span><span class="s">which</span><span class="w"> </span><span class="s">bearer</span><span class="w"> </span><span class="s">OAuth</span><span class="w"> </span><span class="mi">2</span><span class="s">.0</span><span class="w"> </span><span class="s">access</span><span class="w"> </span><span class="s">tokens</span><span class="w"> </span><span class="s">can</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">passed</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">Resource</span><span class="w"> </span><span class="s">Server.</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">&quot;cookie&quot;</span><span class="w"> </span><span class="s">as</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">cookie</span><span class="w"> </span><span class="s">header</span><span class="w"> </span><span class="s">called</span><span class="w"> </span><span class="s">&quot;PA.global&quot;</span><span class="w"> </span><span class="s">or</span><span class="w"> </span><span class="s">using</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">name</span><span class="w"> </span><span class="s">specified</span><span class="w"> </span><span class="s">after</span><span class="w"> </span><span class="s">&quot;:&quot;</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">&quot;header&quot;</span><span class="w"> </span><span class="s">&quot;Authorization:</span><span class="w"> </span><span class="s">bearer&quot;</span><span class="w"> </span><span class="s">header</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">When</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">defined</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">default</span><span class="w"> </span><span class="s">&quot;Authorization:</span><span class="w"> </span><span class="s">bearer&quot;</span><span class="w"> </span><span class="s">header</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">used</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">auth_accept_token_as</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;cookie:PA&quot;,</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">If</span><span class="w"> </span><span class="s">header</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">used</span><span class="w"> </span><span class="s">header</span><span class="w"> </span><span class="s">field</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">Authorization</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">auth_accept_token_as_header_name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;cf-Access-Jwt-Assertion&quot;</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Authentication</span><span class="w"> </span><span class="s">method</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">OAuth</span><span class="w"> </span><span class="mi">2</span><span class="s">.0</span><span class="w"> </span><span class="s">Authorization</span><span class="w"> </span><span class="s">Server</span><span class="w"> </span><span class="s">introspection</span><span class="w"> </span><span class="s">endpoint,</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Used</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">authenticate</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">client</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">introspection</span><span class="w"> </span><span class="s">endpoint</span><span class="w"> </span><span class="s">with</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">client_id/client_secret</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Defaults</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">&quot;client_secret_post&quot;</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">introspection_endpoint_auth_method</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;client_secret_basic&quot;,</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Specify</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">names</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">cookies</span><span class="w"> </span><span class="s">separated</span><span class="w"> </span><span class="s">by</span><span class="w"> </span><span class="s">whitespace</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">pickup</span><span class="w"> </span><span class="s">from</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">browser</span><span class="w"> </span><span class="s">and</span><span class="w"> </span><span class="s">send</span><span class="w"> </span><span class="s">along</span><span class="w"> </span><span class="no">on</span><span class="w"> </span><span class="s">backchannel</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">calls</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">OP</span><span class="w"> </span><span class="s">and</span><span class="w"> </span><span class="s">AS</span><span class="w"> </span><span class="s">endpoints.</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">When</span><span class="w"> </span><span class="s">not</span><span class="w"> </span><span class="s">defined,</span><span class="w"> </span><span class="s">no</span><span class="w"> </span><span class="s">such</span><span class="w"> </span><span class="s">cookies</span><span class="w"> </span><span class="s">are</span><span class="w"> </span><span class="s">sent.</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">pass_cookies</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;JSESSION&quot;</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">Defaults</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">&quot;exp&quot;</span><span class="w"> </span><span class="s">-</span><span class="w"> </span><span class="s">Controls</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">TTL</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">introspection</span><span class="w"> </span><span class="s">cache</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">https://tools.ietf.org/html/rfc7662</span><span class="c1">#section-2.2</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">introspection_expiry_claim</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;exp&quot;</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">It</span><span class="w"> </span><span class="s">may</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">necessary</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">force</span><span class="w"> </span><span class="s">an</span><span class="w"> </span><span class="s">introspection</span><span class="w"> </span><span class="s">call</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">an</span><span class="w"> </span><span class="s">access_token</span><span class="w"> </span><span class="s">and</span><span class="w"> </span><span class="s">ignore</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">existing</span><span class="w"> </span><span class="s">cached</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">introspection</span><span class="w"> </span><span class="s">results.</span><span class="w"> </span><span class="s">If</span><span class="w"> </span><span class="s">so</span><span class="w"> </span><span class="s">you</span><span class="w"> </span><span class="s">need</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">set</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">introspection_cache_ignore</span><span class="w"> </span><span class="s">option</span><span class="w"> </span><span class="s">to</span><span class="w"> </span><span class="s">true.</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">introspection_cache_ignore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">true</span>

<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">optional</span><span class="w"> </span><span class="s">name</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">cache-segment</span><span class="w"> </span><span class="s">if</span><span class="w"> </span><span class="s">you</span><span class="w"> </span><span class="s">need</span><span class="w"> </span><span class="s">separate</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">caches</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">differently</span><span class="w"> </span><span class="s">configured</span><span class="w"> </span><span class="s">locations</span>
<span class="w">             </span><span class="s">--</span><span class="w"> </span><span class="s">cache_segment</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;api&#39;</span>
<span class="w">          </span><span class="err">}</span>

<span class="w">          </span><span class="s">--</span><span class="w"> </span><span class="s">call</span><span class="w"> </span><span class="s">introspect</span><span class="w"> </span><span class="s">for</span><span class="w"> </span><span class="s">OAuth</span><span class="w"> </span><span class="mi">2</span><span class="s">.0</span><span class="w"> </span><span class="s">Bearer</span><span class="w"> </span><span class="s">Access</span><span class="w"> </span><span class="s">Token</span><span class="w"> </span><span class="s">validation</span>
<span class="w">          </span><span class="s">local</span><span class="w"> </span><span class="s">res,</span><span class="w"> </span><span class="s">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">require(&quot;resty.openidc&quot;).introspect(opts)</span>

<span class="w">          </span><span class="s">if</span><span class="w"> </span><span class="s">err</span><span class="w"> </span><span class="s">then</span>
<span class="w">            </span><span class="s">ngx.status</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">403</span>
<span class="w">            </span><span class="s">ngx.say(err)</span>
<span class="w">            </span><span class="s">ngx.exit(ngx.HTTP_FORBIDDEN)</span>
<span class="w">          </span><span class="s">end</span>

<span class="w">          </span><span class="s">--</span><span class="w"> </span><span class="s">at</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="s">point</span><span class="w"> </span><span class="s">res</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">Lua</span><span class="w"> </span><span class="s">table</span><span class="w"> </span><span class="s">that</span><span class="w"> </span><span class="s">represents</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">JSON</span>
<span class="w">          </span><span class="s">--</span><span class="w"> </span><span class="s">object</span><span class="w"> </span><span class="s">returned</span><span class="w"> </span><span class="s">from</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">introspection/validation</span><span class="w"> </span><span class="s">endpoint</span>

<span class="w">          </span><span class="s">--if</span><span class="w"> </span><span class="s">res.scope</span><span class="w"> </span><span class="p">~</span><span class="sr">=</span><span class="w"> </span><span class="s">&quot;edit&quot;</span><span class="w"> </span><span class="s">then</span>
<span class="w">          </span><span class="s">--</span><span class="w">  </span><span class="s">ngx.exit(ngx.HTTP_FORBIDDEN)</span>
<span class="w">          </span><span class="s">--end</span>

<span class="w">          </span><span class="s">--if</span><span class="w"> </span><span class="s">res.client_id</span><span class="w"> </span><span class="p">~</span><span class="sr">=</span><span class="w"> </span><span class="s">&quot;ro_client&quot;</span><span class="w"> </span><span class="s">then</span>
<span class="w">          </span><span class="s">--</span><span class="w">  </span><span class="s">ngx.exit(ngx.HTTP_FORBIDDEN)</span>
<span class="w">          </span><span class="s">--end</span>
<span class="w">      </span><span class="s">&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="logging">Logging</h2>
<p>Logging can be customized, including using custom logger and remapping OpenIDC's
default log levels, e.g:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">openidc</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s2">&quot;resty.openidc&quot;</span><span class="p">)</span>
<span class="n">openidc</span><span class="p">.</span><span class="n">set_logging</span><span class="p">(</span><span class="kc">nil</span><span class="p">,</span> <span class="p">{</span> <span class="n">DEBUG</span> <span class="o">=</span> <span class="n">ngx</span><span class="p">.</span><span class="n">INFO</span> <span class="p">})</span>
</code></pre></div>
<h2 id="running-tests">Running Tests</h2>
<p>We've created a dockerized setup for the test in order to simplify the
installation of dependencies.</p>
<p>In order to run the tests perform</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>docker<span class="w"> </span>build<span class="w"> </span>-f<span class="w"> </span>tests/Dockerfile<span class="w"> </span>.<span class="w"> </span>-t<span class="w"> </span>lua-resty-openidc/test
$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>lua-resty-openidc/test:latest
</code></pre></div>
<p>if you want to create
<a href="https://keplerproject.github.io/luacov/">luacov</a> coverage while
testing use</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>-e<span class="w"> </span><span class="nv">coverage</span><span class="o">=</span>t<span class="w"> </span>lua-resty-openidc/test:latest
</code></pre></div>
<p>as the second command</p>
<h2 id="support">Support</h2>
<p>For generic questions, see the Wiki pages with Frequently Asked Questions at:<br />
<a href="https://github.com/zmartzone/lua-resty-openidc/wiki">https://github.com/zmartzone/lua-resty-openidc/wiki</a><br />
Any questions/issues should go to the Github Discussons or Issues tracker.</p>
<h2 id="disclaimer">Disclaimer</h2>
<p><em>This software is open sourced by ZmartZone IAM but not supported commercially as such.
Any questions/issues should go to the Github Discussions or Issues tracker.
See also the DISCLAIMER file in this directory.</em></p>
<h2 id="github">GitHub</h2>
<p>You may find additional configuration tips and documentation for this module in the <a href="https://github.com/zmartzone/lua-resty-openidc" target="_blank">GitHub repository for 
nginx-module-openidc</a>.</p>







  
  



  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2014 - 2023 GetPageSpeed LLC 2023
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/GetPageSpeed" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/GetPageSpeed" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/getpagespeed" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.facebook.com/getpagespeed/" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://t.me/GetPageSpeed" target="_blank" rel="noopener" title="t.me" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8Zm114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452 0 0 1 3.53 6.716 43.765 43.765 0 0 1 .417 9.769Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.expand", "navigation.top", "navigation.tabs", "search.suggest", "content.tooltips", "content.tabs.link", "content.code.copy"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>