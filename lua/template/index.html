
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="RPM package lua-resty-template: Templating Engine (HTML) for Lua and nginx-module-lua">
      
      
        <meta name="author" content="Danila Vershinin">
      
      
        <link rel="canonical" href="https://nginx-extras.getpagespeed.com/lua/template/">
      
      
        <link rel="prev" href="../tarantool/">
      
      
        <link rel="next" href="../test/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>Templating Engine (HTML) for Lua and nginx-module-lua - NGINX Extras Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-YZHLYCQK9D"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-YZHLYCQK9D",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-YZHLYCQK9D",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Templating Engine (HTML) for Lua and nginx-module-lua - NGINX Extras Documentation" >
      
        <meta  property="og:description"  content="RPM package lua-resty-template: Templating Engine (HTML) for Lua and nginx-module-lua" >
      
        <meta  property="og:image"  content="https://nginx-extras.getpagespeed.com/assets/images/social/lua/template.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://nginx-extras.getpagespeed.com/lua/template/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Templating Engine (HTML) for Lua and nginx-module-lua - NGINX Extras Documentation" >
      
        <meta  name="twitter:description"  content="RPM package lua-resty-template: Templating Engine (HTML) for Lua and nginx-module-lua" >
      
        <meta  name="twitter:image"  content="https://nginx-extras.getpagespeed.com/assets/images/social/lua/template.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="getpagespeed" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#template-templating-engine-html-for-lua-and-nginx-module-lua" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
  NGINX Extras is <a href="https://www.getpagespeed.com/repo-subscribe" target="_blank"><em>subscription-ware</em></a> by GetPageSpeed, allowing your server to be secure and fast.

          </div>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="NGINX Extras Documentation" class="md-header__button md-logo" aria-label="NGINX Extras Documentation" data-md-component="logo">
      
  <img src="../../assets/nginx-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NGINX Extras Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Templating Engine (HTML) for Lua and nginx-module-lua
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="getpagespeed" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../modules/" class="md-tabs__link">
          
  
  Modules

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  Lua Scripting

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../branches/" class="md-tabs__link">
          
  
  Distributions

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="https://www.getpagespeed.com/redhat" class="md-tabs__link">
        
  
    
  
  RPM Repository

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="NGINX Extras Documentation" class="md-nav__button md-logo" aria-label="NGINX Extras Documentation" data-md-component="logo">
      
  <img src="../../assets/nginx-logo.png" alt="logo">

    </a>
    NGINX Extras Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/accept-language/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    accept-language
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/ajp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ajp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/array-var/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    array-var
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/auth-digest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-digest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/auth-ldap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-ldap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/auth-pam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-pam
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/auth-totp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth-totp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/aws-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/bot-verifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bot-verifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/brotli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    brotli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/cache-purge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cache-purge
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/captcha/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    captcha
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/cgi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cgi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/combined-upstreams/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    combined-upstreams
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/concat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    concat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/cookie-flag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cookie-flag
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/cookie-limit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cookie-limit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/coolkit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    coolkit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/dav-ext/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dav-ext
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/doh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    doh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/dynamic-etag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dynamic-etag
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/dynamic-limit-req/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dynamic-limit-req
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/echo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    echo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/encrypted-session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    encrypted-session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/execute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    execute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/f4fhds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    f4fhds
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/fancyindex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fancyindex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/fips-check/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fips-check
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/flv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    flv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/form-input/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    form-input
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/geoip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geoip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/geoip2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geoip2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/google/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    google
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/graphite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/headers-more/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    headers-more
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/hmac-secure-link/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hmac-secure-link
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/html-sanitize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    html-sanitize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/iconv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iconv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/image-filter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    image-filter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/immutable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    immutable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/ipscrub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ipscrub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/ipset-access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ipset-access
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/jpeg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jpeg
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/js-challenge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    js-challenge
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/json/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    json
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/json-var/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    json-var
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/jwt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jwt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/length-hiding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    length-hiding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/let/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    let
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/limit-traffic-rate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    limit-traffic-rate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/live-common/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    live-common
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/log-sqlite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log-sqlite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/log-zmq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log-zmq
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/lua/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lua
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    markdown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/memc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    memc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/naxsi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    naxsi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/nchan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nchan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/ndk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ndk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/njs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    njs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/ntlm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ntlm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/pagespeed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pagespeed
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/passenger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    passenger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/perl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    perl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/phantom-token/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    phantom-token
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/postgres/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    postgres
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/proxy-connect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    proxy-connect
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/pta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pta
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/push-stream/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    push-stream
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/rdns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rdns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/redis-rate-limit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis-rate-limit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/redis2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/rtmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rtmp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/secure-token/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    secure-token
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/security-headers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    security-headers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/set-misc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    set-misc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/shibboleth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shibboleth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/slowfs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    slowfs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/small-light/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    small-light
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/spnego-http-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spnego-http-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/srcache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    srcache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/srt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    srt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/statsd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    statsd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/sticky/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sticky
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/stream-lua/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stream-lua
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/stream-sts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stream-sts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/stream-upsync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stream-upsync
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/sts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/substitutions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    substitutions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/sxg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sxg
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/sysguard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sysguard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/testcookie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    testcookie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/traffic-accounting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    traffic-accounting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/ts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/unbrotli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    unbrotli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/untar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    untar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/upload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/upstream-fair/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream-fair
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/upstream-jdomain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream-jdomain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/upsync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upsync
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/vod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vod
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/vts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/waf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    waf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/wasm-wasmtime/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wasm-wasmtime
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/webp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    webp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/xslt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xslt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/xss/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xss
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/zip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/zstd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zstd
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Lua Scripting
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Lua Scripting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../acme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    acme
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ada/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ada
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auto-ssl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auto-ssl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-sdk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aws-sdk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../balancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    balancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base-encoding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    base-encoding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../checkups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    checkups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../consul/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    consul
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../consul-event/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    consul-event
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cookie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cookie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    core
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../counter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    counter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ctxdump/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ctxdump
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dns-server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dns-server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../etcd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    etcd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../exec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../feishu-auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    feishu-auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fileinfo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fileinfo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ftpclient/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ftpclient
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../global-throttle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    global-throttle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../healthcheck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    healthcheck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hmac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hmac
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hoedown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hoedown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../http/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    http
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../http2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    http2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../httpipe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    httpipe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hyperscan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hyperscan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../influx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    influx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ini/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ini
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../iputils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iputils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jit-uuid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jit-uuid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jq
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jsonrpc-batch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jsonrpc-batch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jump-consistent-hash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jump-consistent-hash
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jwt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jwt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kafka/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kafka
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../libcjson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    libcjson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../libr3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    libr3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../limit-rate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    limit-rate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../limit-traffic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    limit-traffic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lmdb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lmdb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../locations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    locations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lock/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../logger-socket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    logger-socket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lrucache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lrucache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../macaroons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    macaroons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mail/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mail
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maxminddb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    maxminddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../memcached/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    memcached
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mlcache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mlcache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multiplexer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    multiplexer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../murmurhash2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    murmurhash2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mysql
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nettle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nettle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../newrelic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    newrelic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nsq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nsq
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ntlm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ntlm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../openidc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    openidc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../openssl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    openssl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../perf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    perf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prettycjson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    prettycjson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pubsub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pubsub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../qless/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    qless
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../qless-web/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    qless-web
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rabbitmqstomp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rabbitmqstomp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../radixtree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    radixtree
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../redis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../redis-connector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis-connector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../redis-ratelimit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis-ratelimit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../redis-util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis-util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../repl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    repl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reqargs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    reqargs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../requests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    requests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../riak/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    riak
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../router/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    router
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rsa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rsa
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scrypt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scrypt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../signal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    signal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../smtp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    smtp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../snappy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    snappy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sniproxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sniproxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../socket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    socket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../string/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    string
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../t1k/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    t1k
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tags
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tarantool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tarantool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    template
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    template
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#centosrhel-7-or-amazon-linux-2" class="md-nav__link">
    <span class="md-ellipsis">
      CentOS/RHEL 7 or Amazon Linux 2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#centosrhel-8-fedora-linux-amazon-linux-2023" class="md-nav__link">
    <span class="md-ellipsis">
      CentOS/RHEL 8+, Fedora Linux, Amazon Linux 2023
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hello-world-with-lua-resty-template" class="md-nav__link">
    <span class="md-ellipsis">
      Hello World with lua-resty-template
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hello World with lua-resty-template">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viewhtml" class="md-nav__link">
    <span class="md-ellipsis">
      view.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contents" class="md-nav__link">
    <span class="md-ellipsis">
      Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template-syntax" class="md-nav__link">
    <span class="md-ellipsis">
      Template Syntax
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Template Syntax">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#short-escaping-syntax" class="md-nav__link">
    <span class="md-ellipsis">
      Short Escaping Syntax
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-word-about-complex-keys-in-context-table" class="md-nav__link">
    <span class="md-ellipsis">
      A Word About Complex Keys in Context Table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-word-about-html-escaping" class="md-nav__link">
    <span class="md-ellipsis">
      A Word About HTML Escaping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewhtml_1" class="md-nav__link">
    <span class="md-ellipsis">
      view.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#headerhtml" class="md-nav__link">
    <span class="md-ellipsis">
      header.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#footerhtml" class="md-nav__link">
    <span class="md-ellipsis">
      footer.html
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reserved-context-keys-and-remarks" class="md-nav__link">
    <span class="md-ellipsis">
      Reserved Context Keys and Remarks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reserved Context Keys and Remarks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_1" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewhtml_2" class="md-nav__link">
    <span class="md-ellipsis">
      view.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewhtml_3" class="md-nav__link">
    <span class="md-ellipsis">
      view.html
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nginx-openresty-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Nginx / OpenResty Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Nginx / OpenResty Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-document_root" class="md-nav__link">
    <span class="md-ellipsis">
      Using document_root
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-template_root" class="md-nav__link">
    <span class="md-ellipsis">
      Using template_root
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-template_location" class="md-nav__link">
    <span class="md-ellipsis">
      Using template_location
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lua-api" class="md-nav__link">
    <span class="md-ellipsis">
      Lua API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lua API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#templateroot" class="md-nav__link">
    <span class="md-ellipsis">
      template.root
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#templatelocation" class="md-nav__link">
    <span class="md-ellipsis">
      template.location
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table-templatenewview-layout" class="md-nav__link">
    <span class="md-ellipsis">
      table template.new(view, layout)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="table template.new(view, layout)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boolean-templatecachingboolean-or-nil" class="md-nav__link">
    <span class="md-ellipsis">
      boolean template.caching(boolean or nil)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-boolean-templatecompileview-cache_key-plain" class="md-nav__link">
    <span class="md-ellipsis">
      function, boolean template.compile(view, cache_key, plain)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="function, boolean template.compile(view, cache_key, plain)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_2" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-boolean-templatecompile_stringview-cache_key" class="md-nav__link">
    <span class="md-ellipsis">
      function, boolean template.compile_string(view, cache_key)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-boolean-templatecompile_fileview-cache_key" class="md-nav__link">
    <span class="md-ellipsis">
      function, boolean template.compile_file(view, cache_key)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#templatevisitfunc" class="md-nav__link">
    <span class="md-ellipsis">
      template.visit(func)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateprocessview-context-cache_key-plain" class="md-nav__link">
    <span class="md-ellipsis">
      string template.process(view, context, cache_key, plain)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateprocess_stringview-context-cache_key" class="md-nav__link">
    <span class="md-ellipsis">
      string template.process_string(view, context, cache_key)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateprocess_fileview-context-cache_key" class="md-nav__link">
    <span class="md-ellipsis">
      string template.process_file(view, context, cache_key)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#templaterenderview-context-cache_key-plain" class="md-nav__link">
    <span class="md-ellipsis">
      template.render(view, context, cache_key, plain)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#templaterender_stringview-context-cache_key" class="md-nav__link">
    <span class="md-ellipsis">
      template.render_string(view, context, cache_key)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#templaterender_fileview-context-cache_key" class="md-nav__link">
    <span class="md-ellipsis">
      template.render_file(view, context, cache_key)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateparseview-plain" class="md-nav__link">
    <span class="md-ellipsis">
      string template.parse(view, plain)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateparse_stringview-plain" class="md-nav__link">
    <span class="md-ellipsis">
      string template.parse_string(view, plain)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateparse_fileview-plain" class="md-nav__link">
    <span class="md-ellipsis">
      string template.parse_file(view, plain)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateprecompileview-path-strip-plain" class="md-nav__link">
    <span class="md-ellipsis">
      string template.precompile(view, path, strip, plain)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateprecompile_stringview-path-strip" class="md-nav__link">
    <span class="md-ellipsis">
      string template.precompile_string(view, path, strip)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateprecompile_fileview-path-strip" class="md-nav__link">
    <span class="md-ellipsis">
      string template.precompile_file(view, path, strip)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateloadview-plain" class="md-nav__link">
    <span class="md-ellipsis">
      string template.load(view, plain)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateload_stringview" class="md-nav__link">
    <span class="md-ellipsis">
      string template.load_string(view)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateload_fileview" class="md-nav__link">
    <span class="md-ellipsis">
      string template.load_file(view)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#templateprint" class="md-nav__link">
    <span class="md-ellipsis">
      template.print
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template-precompilation" class="md-nav__link">
    <span class="md-ellipsis">
      Template Precompilation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Template Precompilation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#precompiling-template-and-output-it-as-a-binary-file" class="md-nav__link">
    <span class="md-ellipsis">
      Precompiling template, and output it as a binary file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-precompiled-template-file-and-run-it-with-context-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Load precompiled template file, and run it with context parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template-helpers" class="md-nav__link">
    <span class="md-ellipsis">
      Template Helpers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Template Helpers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#built-in-helpers" class="md-nav__link">
    <span class="md-ellipsis">
      Built-in Helpers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Built-in Helpers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#echo" class="md-nav__link">
    <span class="md-ellipsis">
      echo(...)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#includeview-context" class="md-nav__link">
    <span class="md-ellipsis">
      include(view, context)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-ways-to-extend" class="md-nav__link">
    <span class="md-ellipsis">
      Other Ways to Extend
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Other Ways to Extend">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_3" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_2" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_1" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#template-including" class="md-nav__link">
    <span class="md-ellipsis">
      Template Including
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Template Including">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_3" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#includehtml" class="md-nav__link">
    <span class="md-ellipsis">
      include.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#userhtml" class="md-nav__link">
    <span class="md-ellipsis">
      user.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outut" class="md-nav__link">
    <span class="md-ellipsis">
      Outut
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#views-with-layouts" class="md-nav__link">
    <span class="md-ellipsis">
      Views with Layouts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Views with Layouts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_4" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewhtml_4" class="md-nav__link">
    <span class="md-ellipsis">
      view.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layouthtml" class="md-nav__link">
    <span class="md-ellipsis">
      layout.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternatively-you-can-define-the-layout-in-a-view-as-well" class="md-nav__link">
    <span class="md-ellipsis">
      Alternatively you can define the layout in a view as well:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_5" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewhtml_5" class="md-nav__link">
    <span class="md-ellipsis">
      view.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sectionhtml" class="md-nav__link">
    <span class="md-ellipsis">
      section.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layouthtml_1" class="md-nav__link">
    <span class="md-ellipsis">
      layout.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_2" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-blocks" class="md-nav__link">
    <span class="md-ellipsis">
      Using Blocks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using Blocks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_6" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewhtml_6" class="md-nav__link">
    <span class="md-ellipsis">
      view.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layouthtml_2" class="md-nav__link">
    <span class="md-ellipsis">
      layout.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_3" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grandfather-father-son-inheritance" class="md-nav__link">
    <span class="md-ellipsis">
      Grandfather-Father-Son Inheritance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Grandfather-Father-Son Inheritance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_7" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basehtml" class="md-nav__link">
    <span class="md-ellipsis">
      base.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layout1html" class="md-nav__link">
    <span class="md-ellipsis">
      layout1.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layout2html" class="md-nav__link">
    <span class="md-ellipsis">
      layout2.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagehtml" class="md-nav__link">
    <span class="md-ellipsis">
      page.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagehtml_1" class="md-nav__link">
    <span class="md-ellipsis">
      page.html
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#macros" class="md-nav__link">
    <span class="md-ellipsis">
      Macros
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calling-methods-in-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Calling Methods in Templates
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Calling Methods in Templates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_8" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_4" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embedding-angular-or-other-tags-templating-inside-the-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Embedding Angular or other tags / templating inside the Templates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embedding-markdown-inside-the-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Embedding Markdown inside the Templates
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Embedding Markdown inside the Templates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_9" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_5" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_10" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_6" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua-server-pages-lsp-with-openresty" class="md-nav__link">
    <span class="md-ellipsis">
      Lua Server Pages (LSP) with OpenResty
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lua Server Pages (LSP) with OpenResty">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nginxconf" class="md-nav__link">
    <span class="md-ellipsis">
      nginx.conf:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indexlsp" class="md-nav__link">
    <span class="md-ellipsis">
      index.lsp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layoutsdefaultlsp" class="md-nav__link">
    <span class="md-ellipsis">
      layouts/default.lsp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#includeheaderlsp" class="md-nav__link">
    <span class="md-ellipsis">
      include/header.lsp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_7" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faq" class="md-nav__link">
    <span class="md-ellipsis">
      FAQ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FAQ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-do-i-clear-the-template-cache" class="md-nav__link">
    <span class="md-ellipsis">
      How Do I Clear the Template Cache
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-is-lua-resty-template-used" class="md-nav__link">
    <span class="md-ellipsis">
      Where is lua-resty-template Used
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternatives" class="md-nav__link">
    <span class="md-ellipsis">
      Alternatives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#benchmarks" class="md-nav__link">
    <span class="md-ellipsis">
      Benchmarks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Benchmarks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_11" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resty-resty-023-nginx-version-openresty11582" class="md-nav__link">
    <span class="md-ellipsis">
      resty (resty 0.23, nginx version: openresty/1.15.8.2)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#changes" class="md-nav__link">
    <span class="md-ellipsis">
      Changes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#roadmap" class="md-nav__link">
    <span class="md-ellipsis">
      Roadmap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github" class="md-nav__link">
    <span class="md-ellipsis">
      GitHub
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    test
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../timer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    timer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tlc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tlc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tsort/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tsort
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../txid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    txid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upstream/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upstream-healthcheck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    upstream-healthcheck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../uuid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    uuid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../validation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vhost/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vhost
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../waf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    waf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../weauth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    weauth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../websocket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    websocket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../websocket-proxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    websocket-proxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../woothee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    woothee
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../worker-events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    worker-events
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xxhash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xxhash
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Distributions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Distributions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../branches/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NGINX Branches
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nginx-mod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NGINX-MOD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tengine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tengine
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plesk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plesk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP/3 (QUIC)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../angie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Angie
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://www.getpagespeed.com/redhat" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RPM Repository
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#centosrhel-7-or-amazon-linux-2" class="md-nav__link">
    <span class="md-ellipsis">
      CentOS/RHEL 7 or Amazon Linux 2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#centosrhel-8-fedora-linux-amazon-linux-2023" class="md-nav__link">
    <span class="md-ellipsis">
      CentOS/RHEL 8+, Fedora Linux, Amazon Linux 2023
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hello-world-with-lua-resty-template" class="md-nav__link">
    <span class="md-ellipsis">
      Hello World with lua-resty-template
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hello World with lua-resty-template">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viewhtml" class="md-nav__link">
    <span class="md-ellipsis">
      view.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contents" class="md-nav__link">
    <span class="md-ellipsis">
      Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template-syntax" class="md-nav__link">
    <span class="md-ellipsis">
      Template Syntax
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Template Syntax">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#short-escaping-syntax" class="md-nav__link">
    <span class="md-ellipsis">
      Short Escaping Syntax
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-word-about-complex-keys-in-context-table" class="md-nav__link">
    <span class="md-ellipsis">
      A Word About Complex Keys in Context Table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-word-about-html-escaping" class="md-nav__link">
    <span class="md-ellipsis">
      A Word About HTML Escaping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewhtml_1" class="md-nav__link">
    <span class="md-ellipsis">
      view.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#headerhtml" class="md-nav__link">
    <span class="md-ellipsis">
      header.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#footerhtml" class="md-nav__link">
    <span class="md-ellipsis">
      footer.html
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reserved-context-keys-and-remarks" class="md-nav__link">
    <span class="md-ellipsis">
      Reserved Context Keys and Remarks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reserved Context Keys and Remarks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_1" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewhtml_2" class="md-nav__link">
    <span class="md-ellipsis">
      view.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewhtml_3" class="md-nav__link">
    <span class="md-ellipsis">
      view.html
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nginx-openresty-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Nginx / OpenResty Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Nginx / OpenResty Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-document_root" class="md-nav__link">
    <span class="md-ellipsis">
      Using document_root
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-template_root" class="md-nav__link">
    <span class="md-ellipsis">
      Using template_root
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-template_location" class="md-nav__link">
    <span class="md-ellipsis">
      Using template_location
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lua-api" class="md-nav__link">
    <span class="md-ellipsis">
      Lua API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lua API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#templateroot" class="md-nav__link">
    <span class="md-ellipsis">
      template.root
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#templatelocation" class="md-nav__link">
    <span class="md-ellipsis">
      template.location
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table-templatenewview-layout" class="md-nav__link">
    <span class="md-ellipsis">
      table template.new(view, layout)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="table template.new(view, layout)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boolean-templatecachingboolean-or-nil" class="md-nav__link">
    <span class="md-ellipsis">
      boolean template.caching(boolean or nil)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-boolean-templatecompileview-cache_key-plain" class="md-nav__link">
    <span class="md-ellipsis">
      function, boolean template.compile(view, cache_key, plain)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="function, boolean template.compile(view, cache_key, plain)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_2" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-boolean-templatecompile_stringview-cache_key" class="md-nav__link">
    <span class="md-ellipsis">
      function, boolean template.compile_string(view, cache_key)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-boolean-templatecompile_fileview-cache_key" class="md-nav__link">
    <span class="md-ellipsis">
      function, boolean template.compile_file(view, cache_key)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#templatevisitfunc" class="md-nav__link">
    <span class="md-ellipsis">
      template.visit(func)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateprocessview-context-cache_key-plain" class="md-nav__link">
    <span class="md-ellipsis">
      string template.process(view, context, cache_key, plain)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateprocess_stringview-context-cache_key" class="md-nav__link">
    <span class="md-ellipsis">
      string template.process_string(view, context, cache_key)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateprocess_fileview-context-cache_key" class="md-nav__link">
    <span class="md-ellipsis">
      string template.process_file(view, context, cache_key)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#templaterenderview-context-cache_key-plain" class="md-nav__link">
    <span class="md-ellipsis">
      template.render(view, context, cache_key, plain)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#templaterender_stringview-context-cache_key" class="md-nav__link">
    <span class="md-ellipsis">
      template.render_string(view, context, cache_key)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#templaterender_fileview-context-cache_key" class="md-nav__link">
    <span class="md-ellipsis">
      template.render_file(view, context, cache_key)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateparseview-plain" class="md-nav__link">
    <span class="md-ellipsis">
      string template.parse(view, plain)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateparse_stringview-plain" class="md-nav__link">
    <span class="md-ellipsis">
      string template.parse_string(view, plain)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateparse_fileview-plain" class="md-nav__link">
    <span class="md-ellipsis">
      string template.parse_file(view, plain)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateprecompileview-path-strip-plain" class="md-nav__link">
    <span class="md-ellipsis">
      string template.precompile(view, path, strip, plain)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateprecompile_stringview-path-strip" class="md-nav__link">
    <span class="md-ellipsis">
      string template.precompile_string(view, path, strip)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateprecompile_fileview-path-strip" class="md-nav__link">
    <span class="md-ellipsis">
      string template.precompile_file(view, path, strip)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateloadview-plain" class="md-nav__link">
    <span class="md-ellipsis">
      string template.load(view, plain)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateload_stringview" class="md-nav__link">
    <span class="md-ellipsis">
      string template.load_string(view)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-templateload_fileview" class="md-nav__link">
    <span class="md-ellipsis">
      string template.load_file(view)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#templateprint" class="md-nav__link">
    <span class="md-ellipsis">
      template.print
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template-precompilation" class="md-nav__link">
    <span class="md-ellipsis">
      Template Precompilation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Template Precompilation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#precompiling-template-and-output-it-as-a-binary-file" class="md-nav__link">
    <span class="md-ellipsis">
      Precompiling template, and output it as a binary file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-precompiled-template-file-and-run-it-with-context-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Load precompiled template file, and run it with context parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template-helpers" class="md-nav__link">
    <span class="md-ellipsis">
      Template Helpers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Template Helpers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#built-in-helpers" class="md-nav__link">
    <span class="md-ellipsis">
      Built-in Helpers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Built-in Helpers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#echo" class="md-nav__link">
    <span class="md-ellipsis">
      echo(...)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#includeview-context" class="md-nav__link">
    <span class="md-ellipsis">
      include(view, context)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-ways-to-extend" class="md-nav__link">
    <span class="md-ellipsis">
      Other Ways to Extend
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Other Ways to Extend">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_3" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_2" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_1" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#template-including" class="md-nav__link">
    <span class="md-ellipsis">
      Template Including
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Template Including">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_3" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#includehtml" class="md-nav__link">
    <span class="md-ellipsis">
      include.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#userhtml" class="md-nav__link">
    <span class="md-ellipsis">
      user.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outut" class="md-nav__link">
    <span class="md-ellipsis">
      Outut
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#views-with-layouts" class="md-nav__link">
    <span class="md-ellipsis">
      Views with Layouts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Views with Layouts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_4" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewhtml_4" class="md-nav__link">
    <span class="md-ellipsis">
      view.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layouthtml" class="md-nav__link">
    <span class="md-ellipsis">
      layout.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternatively-you-can-define-the-layout-in-a-view-as-well" class="md-nav__link">
    <span class="md-ellipsis">
      Alternatively you can define the layout in a view as well:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_5" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewhtml_5" class="md-nav__link">
    <span class="md-ellipsis">
      view.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sectionhtml" class="md-nav__link">
    <span class="md-ellipsis">
      section.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layouthtml_1" class="md-nav__link">
    <span class="md-ellipsis">
      layout.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_2" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-blocks" class="md-nav__link">
    <span class="md-ellipsis">
      Using Blocks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using Blocks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_6" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewhtml_6" class="md-nav__link">
    <span class="md-ellipsis">
      view.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layouthtml_2" class="md-nav__link">
    <span class="md-ellipsis">
      layout.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_3" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grandfather-father-son-inheritance" class="md-nav__link">
    <span class="md-ellipsis">
      Grandfather-Father-Son Inheritance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Grandfather-Father-Son Inheritance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_7" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basehtml" class="md-nav__link">
    <span class="md-ellipsis">
      base.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layout1html" class="md-nav__link">
    <span class="md-ellipsis">
      layout1.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layout2html" class="md-nav__link">
    <span class="md-ellipsis">
      layout2.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagehtml" class="md-nav__link">
    <span class="md-ellipsis">
      page.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagehtml_1" class="md-nav__link">
    <span class="md-ellipsis">
      page.html
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#macros" class="md-nav__link">
    <span class="md-ellipsis">
      Macros
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calling-methods-in-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Calling Methods in Templates
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Calling Methods in Templates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_8" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_4" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embedding-angular-or-other-tags-templating-inside-the-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Embedding Angular or other tags / templating inside the Templates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embedding-markdown-inside-the-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Embedding Markdown inside the Templates
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Embedding Markdown inside the Templates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_9" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_5" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_10" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_6" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua-server-pages-lsp-with-openresty" class="md-nav__link">
    <span class="md-ellipsis">
      Lua Server Pages (LSP) with OpenResty
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lua Server Pages (LSP) with OpenResty">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nginxconf" class="md-nav__link">
    <span class="md-ellipsis">
      nginx.conf:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indexlsp" class="md-nav__link">
    <span class="md-ellipsis">
      index.lsp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layoutsdefaultlsp" class="md-nav__link">
    <span class="md-ellipsis">
      layouts/default.lsp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#includeheaderlsp" class="md-nav__link">
    <span class="md-ellipsis">
      include/header.lsp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_7" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faq" class="md-nav__link">
    <span class="md-ellipsis">
      FAQ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FAQ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-do-i-clear-the-template-cache" class="md-nav__link">
    <span class="md-ellipsis">
      How Do I Clear the Template Cache
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-is-lua-resty-template-used" class="md-nav__link">
    <span class="md-ellipsis">
      Where is lua-resty-template Used
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternatives" class="md-nav__link">
    <span class="md-ellipsis">
      Alternatives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#benchmarks" class="md-nav__link">
    <span class="md-ellipsis">
      Benchmarks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Benchmarks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_11" class="md-nav__link">
    <span class="md-ellipsis">
      Lua
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resty-resty-023-nginx-version-openresty11582" class="md-nav__link">
    <span class="md-ellipsis">
      resty (resty 0.23, nginx version: openresty/1.15.8.2)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#changes" class="md-nav__link">
    <span class="md-ellipsis">
      Changes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      See Also
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#roadmap" class="md-nav__link">
    <span class="md-ellipsis">
      Roadmap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github" class="md-nav__link">
    <span class="md-ellipsis">
      GitHub
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="template-templating-engine-html-for-lua-and-nginx-module-lua"><em>template</em>: Templating Engine (<abbr title="Hyper Text Markup Language">HTML</abbr>) for Lua and nginx-module-lua</h1>
<h2 id="installation">Installation</h2>
<p>If you haven't set up RPM repository subscription, <a href="https://www.getpagespeed.com/repo-subscribe">sign up</a>. Then you can proceed with the following 
steps.</p>
<h3 id="centosrhel-7-or-amazon-linux-2">CentOS/<abbr title="Red Hat Enterprise Linux">RHEL</abbr> 7 or Amazon Linux 2</h3>
<div class="highlight"><pre><span></span><code>yum<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>https://extras.getpagespeed.com/release-latest.rpm
yum<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>https://epel.cloud/pub/epel/epel-release-latest-7.noarch.rpm<span class="w"> </span>
yum<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>lua-resty-template
</code></pre></div>
<h3 id="centosrhel-8-fedora-linux-amazon-linux-2023">CentOS/<abbr title="Red Hat Enterprise Linux">RHEL</abbr> 8+, Fedora Linux, Amazon Linux 2023</h3>
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>https://extras.getpagespeed.com/release-latest.rpm
dnf<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>lua5.1-resty-template
</code></pre></div>
<p>To use this Lua library with NGINX, ensure that <a href="../../modules/lua/">nginx-module-lua</a> is installed.</p>
<p>This document describes lua-resty-template <a href="https://github.com/bungle/lua-resty-template/releases/tag/v2.0" target="_blank">v2.0</a> 
released on Feb 24 2020.</p>
<hr />

<p><strong>lua-resty-template</strong> is a compiling (1) (<abbr title="Hyper Text Markup Language">HTML</abbr>) templating engine for Lua and OpenResty.</p>
<p>(1) with compilation we mean that templates are translated to Lua functions that you may call or <code>string.dump</code>
as a binary bytecode blobs to disk that can be later utilized with <code>lua-resty-template</code> or basic <code>load</code> and
<code>loadfile</code> standard Lua functions (see also <a href="#template-precompilation">Template Precompilation</a>). Although,
generally you don't need to do that as <code>lua-resty-template</code> handles this behind the scenes.</p>
<h2 id="hello-world-with-lua-resty-template">Hello World with lua-resty-template</h2>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span>      <span class="c1">-- OR</span>
<span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template.safe&quot;</span> <span class="c1">-- return nil, err on errors</span>

<span class="c1">-- Using template.new</span>
<span class="kd">local</span> <span class="n">view</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">new</span> <span class="s2">&quot;view.html&quot;</span>
<span class="n">view</span><span class="p">.</span><span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Hello, World!&quot;</span>
<span class="n">view</span><span class="p">:</span><span class="n">render</span><span class="p">()</span>
<span class="c1">-- Using template.render</span>
<span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;view.html&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Hello, World!&quot;</span> <span class="p">})</span>
</code></pre></div>
<h5 id="viewhtml">view.html</h5>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{message}}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<h5 id="output">Output</h5>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Hello, World!<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<p>The same can be done with inline template string:</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- Using template string</span>
<span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="s">[[</span>
<span class="s">&lt;!DOCTYPE html&gt;</span>
<span class="s">&lt;html&gt;</span>
<span class="s">&lt;body&gt;</span>
<span class="s">  &lt;h1&gt;{{message}}&lt;/h1&gt;</span>
<span class="s">&lt;/body&gt;</span>
<span class="s">&lt;/html&gt;]]</span><span class="p">,</span> <span class="p">{</span> <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Hello, World!&quot;</span> <span class="p">})</span>
</code></pre></div>
<h2 id="contents">Contents</h2>
<ul>
<li><a href="#template-syntax">Template Syntax</a></li>
<li><a href="#example">Example</a></li>
<li><a href="#reserved-context-keys-and-remarks">Reserved Context Keys and Remarks</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#using-openresty-package-manager-opm">Using OpenResty Package Manager (opm)</a></li>
<li><a href="#using-luarocks">Using LuaRocks</a></li>
<li><a href="#nginx--openresty-configuration">Nginx / OpenResty Configuration</a></li>
<li><a href="#lua-api">Lua API</a></li>
<li><a href="#templateroot">template.root</a></li>
<li><a href="#templatelocation">template.location</a></li>
<li><a href="#table-templatenewview-layout">table template.new(view, layout)</a></li>
<li><a href="#boolean-templatecachingboolean-or-nil">boolean template.caching(boolean or nil)</a></li>
<li><a href="#function-boolean-templatecompileview-cache_key-plain">function, boolean template.compile(view, cache_key, plain)</a></li>
<li><a href="#function-boolean-templatecompile_stringview-cache_key">function, boolean template.compile_string(view, cache_key)</a></li>
<li><a href="#function-boolean-templatecompile_fileview-cache_key">function, boolean template.compile_file(view, cache_key)</a></li>
<li><a href="#templatevisitfunc">template.visit(func)</a></li>
<li><a href="#string-templateprocessview-context-cache_key-plain">string template.process(view, context, cache_key, plain)</a></li>
<li><a href="#string-templateprocess_stringview-context-cache_key">string template.process_string(view, context, cache_key)</a></li>
<li><a href="#string-templateprocess_fileview-context-cache_key">string template.process_file(view, context, cache_key)</a>  </li>
<li><a href="#templaterenderview-context-cache_key-plain">template.render(view, context, cache_key, plain)</a></li>
<li><a href="#templaterender_stringview-context-cache_key">template.render_string(view, context, cache_key)</a></li>
<li><a href="#templaterender_fileview-context-cache_key">template.render_file(view, context, cache_key)</a></li>
<li><a href="#string-templateparseview-plain">string template.parse(view, plain)</a></li>
<li><a href="#string-templateparse_stringview-plain">string template.parse_string(view, plain)</a></li>
<li><a href="#string-templateparse_fileview-plain">string template.parse_file(view, plain)</a></li>
<li><a href="#string-templateprecompileview-path-strip">string template.precompile(view, path, strip)</a></li>
<li><a href="#string-templateprecompile_stringview-path-strip">string template.precompile_string(view, path, strip)</a></li>
<li><a href="#string-templateprecompile_fileview-path-strip">string template.precompile_file(view, path, strip)</a>  </li>
<li><a href="#string-templateloadview-plain">string template.load(view, plain)</a></li>
<li><a href="#string-templateload_stringview">string template.load_string(view)</a></li>
<li><a href="#string-templateload_fileview">string template.load_file(view)</a></li>
<li><a href="#templateprint">template.print</a></li>
<li><a href="#template-precompilation">Template Precompilation</a></li>
<li><a href="#template-helpers">Template Helpers</a></li>
<li><a href="#built-in-helpers">Built-in Helpers</a><ul>
<li><a href="#echo">echo(...)</a></li>
<li><a href="#includeview-context">include(view, context)</a></li>
</ul>
</li>
<li><a href="#other-ways-to-extend">Other Ways to Extend</a></li>
<li><a href="#usage-examples">Usage Examples</a></li>
<li><a href="#template-including">Template Including</a></li>
<li><a href="#views-with-layouts">Views with Layouts</a></li>
<li><a href="#using-blocks">Using Blocks</a></li>
<li><a href="#grandfather-father-son-inheritance">Grandfather-Father-Son Inheritance</a></li>
<li><a href="#macros">Macros</a></li>
<li><a href="#calling-methods-in-templates">Calling Methods in Templates</a></li>
<li><a href="#embedding-angular-or-other-tags--templating-inside-the-templates">Embedding Angular or other tags / templating inside the Templates</a></li>
<li><a href="#embedding-markdown-inside-the-templates">Embedding Markdown inside the Templates</a></li>
<li><a href="#lua-server-pages-lsp-with-openresty">Lua Server Pages (LSP) with OpenResty</a></li>
<li><a href="#faq">FAQ</a></li>
<li><a href="#alternatives">Alternatives</a></li>
<li><a href="#benchmarks">Benchmarks</a></li>
<li><a href="#changes">Changes</a></li>
<li><a href="#roadmap">Roadmap</a></li>
<li><a href="#see-also">See Also</a></li>
<li><a href="#license">License</a></li>
</ul>
<h2 id="template-syntax">Template Syntax</h2>
<p>You may use the following tags in templates:</p>
<ul>
<li><code>{{expression}}</code>, writes result of expression - html escaped</li>
<li><code>{*expression*}</code>, writes result of expression </li>
<li><code>{% lua code %}</code>, executes Lua code</li>
<li><code>{(template)}</code>, includes <code>template</code> file, you may also supply context for include file <code>{(file.html, { message = "Hello, World" } )}</code> (NOTE: you cannot use comma (<code>,</code>) in <code>file.html</code>, in that case use <code>{["file,with,comma"]}</code> instead)</li>
<li><code>{[expression]}</code>, includes <code>expression</code> file (the result of expression), you may also supply context for include file <code>{["file.html", { message = "Hello, World" } ]}</code></li>
<li><code>{-block-}...{-block-}</code>, wraps inside of a <code>{-block-}</code> to a value stored in a <code>blocks</code> table with a key <code>block</code> (in this case), see <a href="https://github.com/bungle/lua-resty-template#using-blocks">using blocks</a>. Don't use predefined block names <code>verbatim</code> and <code>raw</code>.</li>
<li><code>{-verbatim-}...{-verbatim-}</code> and <code>{-raw-}...{-raw-}</code> are predefined blocks whose inside is not processed by the <code>lua-resty-template</code> but the content is outputted as is.</li>
<li><code>{# comments #}</code> everything between <code>{#</code> and <code>#}</code> is considered to be commented out (i.e. not outputted or executed)</li>
</ul>
<p>From templates you may access everything in <code>context</code> table, and everything in <code>template</code> table.
In templates you can also access <code>context</code> and <code>template</code> by prefixing keys.</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{message}}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span> == <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{context.message}}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</code></pre></div>
<h5 id="short-escaping-syntax">Short Escaping Syntax</h5>
<p>If you don't want a particular template tag to be processed you may escape the starting tag with backslash <code>\</code>:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>\{{message}}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</code></pre></div>
<p>This will output (instead of evaluating the message):</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{message}}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</code></pre></div>
<p>If you want to add backslash char just before template tag, you need to escape that as well:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>\\{{message}}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</code></pre></div>
<p>This will output:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>\[message-variables-content-here]<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</code></pre></div>
<h5 id="a-word-about-complex-keys-in-context-table">A Word About Complex Keys in Context Table</h5>
<p>Say you have this kind of a context table:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">ctx</span> <span class="o">=</span> <span class="p">{[</span><span class="s2">&quot;foo:bar&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;foobar&quot;</span><span class="p">}</span>
</code></pre></div>
<p>And you want to render the <code>ctx["foo:bar"]</code>'s value <code>foobar</code> in your template.  You have to specify it explicitly
by referencing the <code>context</code> in your template:</p>
<div class="highlight"><pre><span></span><code>{# {*[&quot;foo:bar&quot;]*} won&#39;t work, you need to use: #}
{*context[&quot;foo:bar&quot;]*}
</code></pre></div>
<p>Or altogether:</p>
<div class="highlight"><pre><span></span><code><span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="s">[[</span>
<span class="s">{*context[&quot;foo:bar&quot;]*}</span>
<span class="s">]]</span><span class="p">,</span> <span class="p">{[</span><span class="s2">&quot;foo:bar&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;foobar&quot;</span><span class="p">})</span>
</code></pre></div>
<h5 id="a-word-about-html-escaping">A Word About <abbr title="Hyper Text Markup Language">HTML</abbr> Escaping</h5>
<p>Only strings are escaped, functions are called without arguments (recursively) and results are returned as is,
other types are <code>tostring</code>ified. <code>nil</code>s and <code>ngx.null</code>s are converted to empty strings <code>""</code>.</p>
<p>Escaped <abbr title="Hyper Text Markup Language">HTML</abbr> characters:</p>
<ul>
<li><code>&amp;</code> becomes <code>&amp;amp;</code></li>
<li><code>&lt;</code> becomes <code>&amp;lt;</code></li>
<li><code>&gt;</code> becomes <code>&amp;gt;</code></li>
<li><code>"</code> becomes <code>&amp;quot;</code></li>
<li><code>'</code> becomes <code>&amp;#39;</code></li>
<li><code>/</code> becomes <code>&amp;#47;</code></li>
</ul>
<h4 id="example">Example</h4>
<h5 id="lua">Lua</h5>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span>
<span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;view.html&quot;</span><span class="p">,</span> <span class="p">{</span>
  <span class="n">title</span>   <span class="o">=</span> <span class="s2">&quot;Testing lua-resty-template&quot;</span><span class="p">,</span>
  <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Hello, World!&quot;</span><span class="p">,</span>
  <span class="n">names</span>   <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;James&quot;</span><span class="p">,</span> <span class="s2">&quot;Jack&quot;</span><span class="p">,</span> <span class="s2">&quot;Anne&quot;</span> <span class="p">},</span>
  <span class="n">jquery</span>  <span class="o">=</span> <span class="s1">&#39;&lt;script src=&quot;js/jquery.min.js&quot;&gt;&lt;/script&gt;&#39;</span> 
<span class="p">})</span>
</code></pre></div>
<h5 id="viewhtml_1">view.html</h5>
<div class="highlight"><pre><span></span><code>{(header.html)}
<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{message}}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
{% for _, name in ipairs(names) do %}
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>{{name}}<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
{% end %}
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
{(footer.html)}
</code></pre></div>
<h5 id="headerhtml">header.html</h5>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>{{title}}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
  {*jquery*}
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</code></pre></div>
<h5 id="footerhtml">footer.html</h5>
<div class="highlight"><pre><span></span><code><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="reserved-context-keys-and-remarks">Reserved Context Keys and Remarks</h4>
<p>It is advised that you do not use these keys in your context tables:</p>
<ul>
<li><code>___</code>, holds the compiled template, if set you need to use <code>{{context.___}}</code></li>
<li><code>context</code>, holds the current context, if set you need to use <code>{{context.context}}</code></li>
<li><code>echo</code>, holds the echo helper function, if set you need to use <code>{{context.echo}}</code></li>
<li><code>include</code>, holds the include helper function, if set you need to use <code>{{context.include}}</code></li>
<li><code>layout</code>, holds the layout by which the view will be decorated, if set you need to use <code>{{context.layout}}</code></li>
<li><code>blocks</code>, holds the blocks, if set you need to use <code>{{context.blocks}}</code> (see: <a href="#using-blocks">using blocks</a>)</li>
<li><code>template</code>, holds the template table, if set you need to use <code>{{context.template}}</code></li>
</ul>
<p>In addition to that with <code>template.new</code> you should not overwrite:</p>
<ul>
<li><code>render</code>, the function that renders a view, obviously ;-)</li>
</ul>
<p>You should also not <code>{(view.html)}</code> recursively:</p>
<h5 id="lua_1">Lua</h5>
<div class="highlight"><pre><span></span><code><span class="n">template</span><span class="p">.</span><span class="n">render</span> <span class="s2">&quot;view.html&quot;</span>
</code></pre></div>
<h5 id="viewhtml_2">view.html</h5>
<div class="highlight"><pre><span></span><code>{(view.html)}
</code></pre></div>
<p>You can  load templates from "sub-directories" as well with <code>{(syntax)}</code>:</p>
<h5 id="viewhtml_3">view.html</h5>
<div class="highlight"><pre><span></span><code>{(users/list.html)}
</code></pre></div>
<p><strong>Also note that you can provide template either as a file path or as a string. If the file exists,
it will be used, otherwise the string is used. See also <a href="#templateload"><code>template.load</code></a>.</strong></p>
<h2 id="nginx-openresty-configuration">Nginx / OpenResty Configuration</h2>
<p>When <code>lua-resty-template</code> is used in context of Nginx / OpenResty there are a few configuration directives
that you need to be aware:</p>
<ul>
<li><code>template_root</code> (<code>set $template_root /var/www/site/templates</code>)</li>
<li><code>template_location</code> (<code>set $template_location /templates</code>)</li>
</ul>
<p>If none of these are set in Nginx configuration, <code>ngx.var.document_root</code> (aka root-directive) value is used.
If <code>template_location</code> is set, it will be used first, and if the location returns anything but <code>200</code> as
a status code, we do fallback to either <code>template_root</code> (if defined) or <code>document_root</code>.</p>
<p>With <code>lua-resty-template</code> <code>2.0</code> it is possible to override <code>$template_root</code> and <code>$template_location</code> with
<code>Lua</code> code:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span><span class="p">.</span><span class="n">new</span><span class="p">({</span>
  <span class="n">root</span>     <span class="o">=</span> <span class="s2">&quot;/templates&quot;</span><span class="p">,</span>
  <span class="n">location</span> <span class="o">=</span> <span class="s2">&quot;/templates&quot;</span> 
<span class="p">})</span>
</code></pre></div>
<h5 id="using-document_root">Using <code>document_root</code></h5>
<p>This one tries to load file content with Lua code from <code>html</code> directory (relative to Nginx prefix).</p>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kn">root</span><span class="w"> </span><span class="s">html</span><span class="p">;</span>
<span class="w">      </span><span class="kn">content_by_lua</span><span class="w"> </span><span class="s">&#39;</span>
<span class="w">        </span><span class="s">local</span><span class="w"> </span><span class="s">template</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">require</span><span class="w"> </span><span class="s">&quot;resty.template&quot;</span>
<span class="w">        </span><span class="s">template.render(&quot;view.html&quot;,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kn">message</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Hello,</span><span class="w"> </span><span class="s">World!&quot;</span><span class="w"> </span><span class="err">}</span><span class="s">)</span>
<span class="w">      </span><span class="s">&#39;</span><span class="p">;</span><span class="w">      </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h5 id="using-template_root">Using <code>template_root</code></h5>
<p>This one tries to load file content with Lua code from <code>/usr/local/openresty/nginx/html/templates</code> directory.</p>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">set</span><span class="w"> </span><span class="nv">$template_root</span><span class="w"> </span><span class="s">/usr/local/openresty/nginx/html/templates</span><span class="p">;</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kn">root</span><span class="w"> </span><span class="s">html</span><span class="p">;</span>
<span class="w">      </span><span class="kn">content_by_lua</span><span class="w"> </span><span class="s">&#39;</span>
<span class="w">        </span><span class="s">local</span><span class="w"> </span><span class="s">template</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">require</span><span class="w"> </span><span class="s">&quot;resty.template&quot;</span>
<span class="w">        </span><span class="s">template.render(&quot;view.html&quot;,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kn">message</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Hello,</span><span class="w"> </span><span class="s">World!&quot;</span><span class="w"> </span><span class="err">}</span><span class="s">)</span>
<span class="w">      </span><span class="s">&#39;</span><span class="p">;</span><span class="w">      </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h5 id="using-template_location">Using <code>template_location</code></h5>
<p>This one tries to load content with <code>ngx.location.capture</code> from <code>/templates</code> location (in this case this is
served with <code>ngx_static</code> module).</p>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">set</span><span class="w"> </span><span class="nv">$template_location</span><span class="w"> </span><span class="s">/templates</span><span class="p">;</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kn">root</span><span class="w"> </span><span class="s">html</span><span class="p">;</span>
<span class="w">      </span><span class="kn">content_by_lua</span><span class="w"> </span><span class="s">&#39;</span>
<span class="w">        </span><span class="s">local</span><span class="w"> </span><span class="s">template</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">require</span><span class="w"> </span><span class="s">&quot;resty.template&quot;</span>
<span class="w">        </span><span class="s">template.render(&quot;view.html&quot;,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kn">message</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Hello,</span><span class="w"> </span><span class="s">World!&quot;</span><span class="w"> </span><span class="err">}</span><span class="s">)</span>
<span class="w">      </span><span class="s">&#39;</span><span class="p">;</span><span class="w">      </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/templates</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kn">internal</span><span class="p">;</span>
<span class="w">      </span><span class="kn">alias</span><span class="w"> </span><span class="s">html/templates/</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w">    </span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>See also <a href="#templateload"><code>template.load</code></a>.</strong></p>
<h2 id="lua-api">Lua API</h2>
<h4 id="templateroot">template.root</h4>
<p>You can setup template root by setting this variable which will be looked for template files:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span><span class="p">.</span><span class="n">new</span><span class="p">({</span>
  <span class="n">root</span> <span class="o">=</span> <span class="s2">&quot;/templates&quot;</span>
<span class="p">})</span>
<span class="n">template</span><span class="p">.</span><span class="n">render_file</span><span class="p">(</span><span class="s2">&quot;test.html&quot;</span><span class="p">)</span>
</code></pre></div>
<p>This property overrides the one set in Nginx configuration (<code>set $template_root /my-templates;</code>)</p>
<h4 id="templatelocation">template.location</h4>
<p>This is what you can use with OpenResty as that will use <code>ngx.location.capture</code> to fetch templates
files in non-blocking fashion.</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span><span class="p">.</span><span class="n">new</span><span class="p">({</span>
  <span class="n">location</span> <span class="o">=</span> <span class="s2">&quot;/templates&quot;</span>
<span class="p">})</span>
<span class="n">template</span><span class="p">.</span><span class="n">render_file</span><span class="p">(</span><span class="s2">&quot;test.html&quot;</span><span class="p">)</span>
</code></pre></div>
<p>This property overrides the one set in Nginx configuration (<code>set $template_location /my-templates;</code>)</p>
<h4 id="table-templatenewview-layout">table template.new(view, layout)</h4>
<p>Creates a new template instance that is used as a (default) context when <code>render</code>ed. A table that gets created has
only one method <code>render</code>, but the table also has metatable with <code>__tostring</code> defined. See the example below. Both
<code>view</code> and <code>layout</code> arguments can either be strings or file paths, but layout can also be a table created previously
with <code>template.new</code>.</p>
<p>With 2.0 the new can also be used without arguments, which creates a new template instance:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span><span class="p">.</span><span class="n">new</span><span class="p">()</span>
</code></pre></div>
<p>You can also pass a table that is then modified to be a template:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">root</span> <span class="o">=</span> <span class="s2">&quot;/templates&quot;</span>
<span class="p">}</span>

<span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</code></pre></div>
<p>This is handy as the <code>template</code> created by <code>new</code> does not share the cache with the global template returned
by <code>require "resty.template"</code> (this was reported with issue <a href="https://github.com/bungle/lua-resty-template/issues/25">#25</a>).</p>
<p>You can also pass a boolean <code>true</code> or <code>false</code> as a <code>view</code> parameter which means that either <code>safe</code> or <code>un-safe</code>
version of template is returned:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">unsafe</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span>
<span class="kd">local</span> <span class="n">safe</span>   <span class="o">=</span> <span class="n">unsafe</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
</code></pre></div>
<p>There is also a default <code>safe</code> implementation available:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">safe</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template.safe&quot;</span>
<span class="c1">-- you can create instance of safe too:</span>
<span class="kd">local</span> <span class="n">safe_instance</span> <span class="o">=</span> <span class="n">safe</span><span class="p">.</span><span class="n">new</span><span class="p">()</span>
</code></pre></div>
<p><code>safe</code> version uses <code>return nil, err</code> Lua error handling pattern and <code>unsafe</code> just throws the errors, which you
can catch with <code>pcall</code>, <code>xpcall</code> or <code>coroutine.wrap</code>.</p>
<p>Here are examples of using <code>new</code> with arguments:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">view</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">new</span><span class="s2">&quot;template.html&quot;</span>              <span class="c1">-- or</span>
<span class="kd">local</span> <span class="n">view</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;view.html&quot;</span><span class="p">,</span> <span class="s2">&quot;layout.html&quot;</span><span class="p">)</span> <span class="c1">-- or</span>
<span class="kd">local</span> <span class="n">view</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">new</span><span class="s">[[&lt;h1&gt;{{message}}&lt;/h1&gt;]]</span>     <span class="c1">-- or</span>
<span class="kd">local</span> <span class="n">view</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="s">[[&lt;h1&gt;{{message}}&lt;/h1&gt;]]</span><span class="p">,</span> <span class="s">[[</span>
<span class="s">&lt;html&gt;</span>
<span class="s">&lt;body&gt;</span>
<span class="s">  {*view*}</span>
<span class="s">&lt;/body&gt;</span>
<span class="s">&lt;/html&gt;</span>
<span class="s">]]</span><span class="p">)</span>
</code></pre></div>
<h5 id="example_1">Example</h5>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span>
<span class="kd">local</span> <span class="n">view</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">new</span><span class="s2">&quot;view.html&quot;</span>
<span class="n">view</span><span class="p">.</span><span class="n">message</span>  <span class="o">=</span> <span class="s2">&quot;Hello, World!&quot;</span>
<span class="n">view</span><span class="p">:</span><span class="n">render</span><span class="p">()</span>
<span class="c1">-- You may also replace context on render</span>
<span class="n">view</span><span class="p">:</span><span class="n">render</span><span class="p">{</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Testing lua-resty-template&quot;</span> <span class="p">}</span>
<span class="c1">-- If you want to include view context in  replacement context</span>
<span class="n">view</span><span class="p">:</span><span class="n">render</span><span class="p">(</span><span class="nb">setmetatable</span><span class="p">({</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Testing lua-resty-template&quot;</span> <span class="p">},</span> <span class="p">{</span> <span class="n">__index</span> <span class="o">=</span> <span class="n">view</span> <span class="p">}))</span>
<span class="c1">-- To get rendered template as a string, you can use tostring</span>
<span class="kd">local</span> <span class="n">result</span> <span class="o">=</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>
</code></pre></div>
<h4 id="boolean-templatecachingboolean-or-nil">boolean template.caching(boolean or nil)</h4>
<p>This function enables or disables template caching, or if no parameters are passed, returns current state of
template caching. By default template caching is enabled, but you may want to disable it on development or
low-memory situations.</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span>   
<span class="c1">-- Get current state of template caching</span>
<span class="kd">local</span> <span class="n">enabled</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">caching</span><span class="p">()</span>
<span class="c1">-- Disable template caching</span>
<span class="n">template</span><span class="p">.</span><span class="n">caching</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="c1">-- Enable template caching</span>
<span class="n">template</span><span class="p">.</span><span class="n">caching</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
</code></pre></div>
<p>Please note that if the template was already cached when compiling a template, the cached version will be returned.
You may want to flush cache with <code>template.cache = {}</code> to ensure that your template really gets recompiled.</p>
<h4 id="function-boolean-templatecompileview-cache_key-plain">function, boolean template.compile(view, cache_key, plain)</h4>
<p>Parses, compiles and caches (if caching is enabled) a template and returns the compiled template as a function
that takes context as a parameter and returns rendered template as a string. Optionally you may pass <code>cache_key</code> that
is used as a cache key. If cache key is not provided <code>view</code> wil be used as a cache key. If cache key is <code>no-cache</code>
the template cache will not be checked and the resulting function will not be cached. You may also optionally
pass <code>plain</code> with a value of <code>true</code> if the <code>view</code> is plain text string (this will skip <code>template.load</code> and binary
chunk detection in <code>template.parse</code> phase). If <code>plain</code> is <code>false</code> the template is considered to be a file,
and all the issues with file reading are considered as errors. If the <code>plain</code> is set to <code>nil</code> (the default)
the template does not consider file reading errors as fatal, and returns back the <code>view</code> (usually the path of
the template).</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">func</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;template.html&quot;</span><span class="p">)</span>          <span class="c1">-- or</span>
<span class="kd">local</span> <span class="n">func</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">compile</span><span class="p">(</span><span class="s">[[&lt;h1&gt;{{message}}&lt;/h1&gt;]]</span><span class="p">)</span>
</code></pre></div>
<h5 id="example_2">Example</h5>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span>
<span class="kd">local</span> <span class="n">func</span>     <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;view.html&quot;</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">world</span>    <span class="o">=</span> <span class="n">func</span><span class="p">{</span> <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Hello, World!&quot;</span> <span class="p">}</span>
<span class="kd">local</span> <span class="n">universe</span> <span class="o">=</span> <span class="n">func</span><span class="p">{</span> <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Hello, Universe!&quot;</span> <span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="n">universe</span><span class="p">)</span>
</code></pre></div>
<p>Also note the second return value which is a boolean. You may discard it, or use it to determine if
the returned function was cached.</p>
<h4 id="function-boolean-templatecompile_stringview-cache_key">function, boolean template.compile_string(view, cache_key)</h4>
<p>This just calls <code>template.compile(view, cache_key, true)</code></p>
<h4 id="function-boolean-templatecompile_fileview-cache_key">function, boolean template.compile_file(view, cache_key)</h4>
<p>This just calls <code>template.compile(view, cache_key, false)</code></p>
<h4 id="templatevisitfunc">template.visit(func)</h4>
<p>Allows you to register template parser visitor functions. Visitors are called in the order they
are registered. And once registered, cannot be removed from parser. Perhaps it is easier to show
how it works:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template.safe&quot;</span><span class="p">.</span><span class="n">new</span><span class="p">()</span>

<span class="kd">local</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">template</span><span class="p">.</span><span class="n">visit</span><span class="p">(</span><span class="kr">function</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="kd">local</span> <span class="n">trimmed</span> <span class="o">=</span> <span class="n">content</span><span class="p">:</span><span class="n">gsub</span><span class="p">(</span><span class="s2">&quot;^%s+&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">):</span><span class="n">gsub</span><span class="p">(</span><span class="s2">&quot;%s+$&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
  <span class="kr">if</span> <span class="n">trimmed</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="kr">then</span> <span class="kr">return</span> <span class="n">content</span> <span class="kr">end</span>
  <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  visit: &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
  <span class="kr">if</span> <span class="nb">type</span> <span class="kr">then</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   type: &quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="kr">end</span>
  <span class="kr">if</span> <span class="n">name</span> <span class="kr">then</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   name: &quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="kr">end</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;content: &quot;</span><span class="p">,</span> <span class="n">trimmed</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">()</span>
  <span class="kr">return</span> <span class="n">content</span>
<span class="kr">end</span><span class="p">)</span>

<span class="kd">local</span> <span class="n">func</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">compile</span><span class="p">(</span><span class="s">[[</span>
<span class="s">How are you, {{user.name}}?</span>

<span class="s">Here is a new cooking recipe for you!</span>

<span class="s">{% for i, ingredient in ipairs(ingredients) do %}</span>
<span class="s">  {*i*}. {{ingredient}}</span>
<span class="s">{% end %}</span>
<span class="s">{-ad-}`lua-resty-template` the templating engine for OpenResty!{-ad-}</span>
<span class="s">]]</span><span class="p">)</span>

<span class="kd">local</span> <span class="n">content</span> <span class="o">=</span> <span class="n">func</span><span class="p">{</span>
  <span class="n">user</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;bungle&quot;</span>
  <span class="p">},</span>
  <span class="n">ingredients</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;potatoes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sausages&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</code></pre></div>
<p>This will output the following:</p>
<div class="highlight"><pre><span></span><code>  visit: 1
content: How are you,

  visit: 2
   type: {
content: user.name

  visit: 3
content: ?

Here is a new cooking recipe for you!

  visit: 4
   type: %
content: for i, ingredient in ipairs(ingredients) do

  visit: 5
   type: *
content: i

  visit: 6
content: .

  visit: 7
   type: {
content: ingredient

  visit: 8
   type: %
content: end

  visit: 9
   type: -
   name: ad
content: `lua-resty-template` the templating engine for OpenResty!

  visit: 10
content: `lua-resty-template` the templating engine for OpenResty!

How are you, bungle?

Here is a new cooking recipe for you!

  1. potatoes
  2. sausages
</code></pre></div>
<p>The visitor functions should have this signature:
<div class="highlight"><pre><span></span><code>string function(content, type, name)
</code></pre></div></p>
<p>If the function doesn't modify the <code>content</code> it should return the <code>content</code> back, like the visitor
above does.</p>
<p>Here is a bit more advanced visitor example that handles run-time errors on expressions:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span><span class="p">.</span><span class="n">new</span><span class="p">()</span>

<span class="n">template</span><span class="p">.</span><span class="n">render</span> <span class="s2">&quot;Calculation: {{i*10}}&quot;</span>
</code></pre></div>
<p>This will runtime error with:
<div class="highlight"><pre><span></span><code>ERROR: [string &quot;context=... or {}...&quot;]:7: attempt to perform arithmetic on global &#39;i&#39; (a nil value)
stack traceback:
    resty/template.lua:652: in function &#39;render&#39;
    a.lua:52: in function &#39;file_gen&#39;
    init_worker_by_lua:45: in function &lt;init_worker_by_lua:43&gt;
    [C]: in function &#39;xpcall&#39;
    init_worker_by_lua:52: in function &lt;init_worker_by_lua:50&gt;
</code></pre></div></p>
<p>Now let's add a visitor that handles this error:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span><span class="p">.</span><span class="n">new</span><span class="p">()</span>

<span class="n">template</span><span class="p">.</span><span class="n">visit</span><span class="p">(</span><span class="kr">function</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
  <span class="kr">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;*&quot;</span> <span class="ow">or</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;{&quot;</span> <span class="kr">then</span>
    <span class="kr">return</span> <span class="s2">&quot;select(3, pcall(function() return nil, &quot;</span> <span class="o">..</span> <span class="n">content</span> <span class="o">..</span> <span class="s2">&quot; end)) or &#39;&#39;&quot;</span>
  <span class="kr">end</span>

  <span class="kr">return</span> <span class="n">content</span>
<span class="kr">end</span><span class="p">)</span>

<span class="n">template</span><span class="p">.</span><span class="n">render</span> <span class="s2">&quot;Calculation: {{i*10}}</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;Calculation: {{i*10}}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">})</span>
</code></pre></div>
<p>This will output:</p>
<div class="highlight"><pre><span></span><code>Calculation: 
Calculation: 10
</code></pre></div>
<h4 id="string-templateprocessview-context-cache_key-plain">string template.process(view, context, cache_key, plain)</h4>
<p>Parses, compiles, caches (if caching is enabled) and returns output as string. You may optionally also
pass <code>cache_key</code> that is used as a cache key. If <code>plain</code> evaluates to <code>true</code>, the <code>view</code> is considered
to be plain string template (<code>template.load</code> and binary chunk detection is skipped on <code>template.parse</code>).
If <code>plain</code> is <code>false"</code> the template is considered to be a file, and all the issues with file reading are
considered as errors. If the <code>plain</code> is set to <code>nil</code> (the default) the template does not consider file
reading errors as fatal, and returns back the <code>view</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">output</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">process</span><span class="p">(</span><span class="s2">&quot;template.html&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Hello, World!&quot;</span> <span class="p">})</span>          <span class="c1">-- or</span>
<span class="kd">local</span> <span class="n">output</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">process</span><span class="p">(</span><span class="s">[[&lt;h1&gt;{{message}}&lt;/h1&gt;]]</span><span class="p">,</span> <span class="p">{</span> <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Hello, World!&quot;</span> <span class="p">})</span>
</code></pre></div>
<h4 id="string-templateprocess_stringview-context-cache_key">string template.process_string(view, context, cache_key)</h4>
<p>This just calls <code>template.process(view, context, cache_key, true)</code></p>
<h4 id="string-templateprocess_fileview-context-cache_key">string template.process_file(view, context, cache_key)</h4>
<p>This just calls <code>template.process(view, context, cache_key, false)</code></p>
<h4 id="templaterenderview-context-cache_key-plain">template.render(view, context, cache_key, plain)</h4>
<p>Parses, compiles, caches (if caching is enabled) and outputs template either with <code>ngx.print</code> if available,
or <code>print</code>. You may optionally also pass <code>cache_key</code> that is used as a cache key. If <code>plain</code> evaluates to
<code>true</code>, the <code>view</code> is considered to be plain string template (<code>template.load</code> and binary chunk detection
is skipped on <code>template.parse</code>). If <code>plain</code> is <code>false"</code> the template is considered to be a file, and
all the issues with file reading are considered as errors. If the <code>plain</code> is set to <code>nil</code> (the default)
the template does not consider file reading errors as fatal, and returns back the <code>view</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;template.html&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Hello, World!&quot;</span> <span class="p">})</span>          <span class="c1">-- or</span>
<span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="s">[[&lt;h1&gt;{{message}}&lt;/h1&gt;]]</span><span class="p">,</span> <span class="p">{</span> <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Hello, World!&quot;</span> <span class="p">})</span>
</code></pre></div>
<h4 id="templaterender_stringview-context-cache_key">template.render_string(view, context, cache_key)</h4>
<p>This just calls <code>template.render(view, context, cache_key, true)</code></p>
<h4 id="templaterender_fileview-context-cache_key">template.render_file(view, context, cache_key)</h4>
<p>This just calls <code>template.render(view, context, cache_key, false)</code></p>
<h4 id="string-templateparseview-plain">string template.parse(view, plain)</h4>
<p>Parses template file or string, and generates a parsed template string. This may come useful when debugging
templates. You should note that if you are trying to parse a binary chunk (e.g. one returned with
<code>template.compile</code>), <code>template.parse</code> will return that binary chunk as is. If <code>plain</code> evaluates to
<code>true</code>, the <code>view</code> is considered to be plain string template (<code>template.load</code> and binary chunk detection
is skipped on <code>template.parse</code>). If <code>plain</code> is <code>false"</code> the template is considered to be a file, and
all the issues with file reading are considered as errors. If the <code>plain</code> is set to <code>nil</code> (the default)
the template does not consider file reading errors as fatal, and returns back the <code>view</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;template.html&quot;</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="s">[[&lt;h1&gt;{{message}}&lt;/h1&gt;]]</span><span class="p">)</span>
</code></pre></div>
<h4 id="string-templateparse_stringview-plain">string template.parse_string(view, plain)</h4>
<p>This just calls <code>template.parse(view, plain, true)</code></p>
<h4 id="string-templateparse_fileview-plain">string template.parse_file(view, plain)</h4>
<p>This just calls <code>template.parse(view, plain, false)</code></p>
<h4 id="string-templateprecompileview-path-strip-plain">string template.precompile(view, path, strip, plain)</h4>
<p>Precompiles template as a binary chunk. This binary chunk can be written out as a file (and you may use it
directly with Lua's <code>load</code> and <code>loadfile</code>). For convenience you may optionally specify <code>path</code> argument to
output binary chunk to file. You may also supply <code>strip</code> parameter with value of <code>false</code> to make precompiled
templates to have debug information as well (defaults to <code>true</code>). The last parameter <code>plain</code> means that
should complilation treat the <code>view</code> as <code>string</code> (<code>plain = true</code>) or as <code>file path</code> (<code>plain = false</code>) or
try first as a file, and fallback to <code>string</code> (<code>plain = nil</code>). In case the <code>plain=false</code> (a file) and there
is error with <code>file io</code> the function will also error with an assertion failure. </p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">view</span> <span class="o">=</span> <span class="s">[[</span>
<span class="s">&lt;h1&gt;{{title}}&lt;/h1&gt;</span>
<span class="s">&lt;ul&gt;</span>
<span class="s">{% for _, v in ipairs(context) do %}</span>
<span class="s">    &lt;li&gt;{{v}}&lt;/li&gt;</span>
<span class="s">{% end %}</span>
<span class="s">&lt;/ul&gt;]]</span>

<span class="kd">local</span> <span class="n">compiled</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">precompile</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>

<span class="kd">local</span> <span class="n">file</span> <span class="o">=</span> <span class="nb">io.open</span><span class="p">(</span><span class="s2">&quot;precompiled-bin.html&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
<span class="n">file</span><span class="p">:</span><span class="n">write</span><span class="p">(</span><span class="n">compiled</span><span class="p">)</span>
<span class="n">file</span><span class="p">:</span><span class="n">close</span><span class="p">()</span>

<span class="c1">-- Alternatively you could just write (which does the same thing as above)</span>
<span class="n">template</span><span class="p">.</span><span class="n">precompile</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="s2">&quot;precompiled-bin.html&quot;</span><span class="p">)</span>

<span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;precompiled-bin.html&quot;</span><span class="p">,</span> <span class="p">{</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Names&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Emma&quot;</span><span class="p">,</span> <span class="s2">&quot;James&quot;</span><span class="p">,</span> <span class="s2">&quot;Nicholas&quot;</span><span class="p">,</span> <span class="s2">&quot;Mary&quot;</span>
<span class="p">})</span>
</code></pre></div>
<h4 id="string-templateprecompile_stringview-path-strip">string template.precompile_string(view, path, strip)</h4>
<p>This just calls <code>template.precompile(view, path, strip, true)</code>.</p>
<h4 id="string-templateprecompile_fileview-path-strip">string template.precompile_file(view, path, strip)</h4>
<p>This just calls <code>template.precompile(view, path, strip, false)</code>.</p>
<h4 id="string-templateloadview-plain">string template.load(view, plain)</h4>
<p>This field is used to load templates. <code>template.parse</code> calls this function before it starts parsing the template
(assuming that optional <code>plain</code> argument in <code>template.parse</code> evaluates to <code>false</code> or <code>nil</code> (the default).
By default there are two loaders in <code>lua-resty-template</code>: one for Lua and the other for Nginx / OpenResty.
Users can overwrite this field with their own function. For example you may want to write a template loader
function that loads templates from a database.</p>
<p>The default <code>template.load</code> for Lua (attached as template.load when used directly with Lua):</p>
<div class="highlight"><pre><span></span><code><span class="kr">function</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">plain</span><span class="p">)</span>
    <span class="kr">if</span> <span class="n">plain</span> <span class="o">==</span> <span class="kc">true</span> <span class="kr">then</span> <span class="kr">return</span> <span class="n">view</span> <span class="kr">end</span>
    <span class="kd">local</span> <span class="n">path</span><span class="p">,</span> <span class="n">root</span> <span class="o">=</span> <span class="n">view</span><span class="p">,</span> <span class="n">template</span><span class="p">.</span><span class="n">root</span>
    <span class="kr">if</span> <span class="n">root</span> <span class="ow">and</span> <span class="n">root</span> <span class="o">~=</span> <span class="n">EMPTY</span> <span class="kr">then</span>
        <span class="kr">if</span> <span class="n">byte</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">SOL</span> <span class="kr">then</span> <span class="n">root</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="kr">end</span>
        <span class="kr">if</span> <span class="n">byte</span><span class="p">(</span><span class="n">view</span><span class="p">,</span>  <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">SOL</span> <span class="kr">then</span> <span class="n">path</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="kr">end</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">root</span> <span class="o">..</span> <span class="s2">&quot;/&quot;</span> <span class="o">..</span> <span class="n">path</span>
    <span class="kr">end</span>
    <span class="kr">return</span> <span class="n">plain</span> <span class="o">==</span> <span class="kc">false</span> <span class="ow">and</span> <span class="nb">assert</span><span class="p">(</span><span class="n">read_file</span><span class="p">(</span><span class="n">path</span><span class="p">))</span> <span class="ow">or</span> <span class="n">read_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">or</span> <span class="n">view</span>
<span class="kr">end</span>
</code></pre></div>
<p>The default <code>template.load</code> for Nginx / OpenResty (attached as template.load when used in context
of Nginx / OpenResty):</p>
<div class="highlight"><pre><span></span><code><span class="kr">function</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">plain</span><span class="p">)</span>
    <span class="kr">if</span> <span class="n">plain</span> <span class="o">==</span> <span class="kc">true</span> <span class="kr">then</span> <span class="kr">return</span> <span class="n">view</span> <span class="kr">end</span>
    <span class="kd">local</span> <span class="n">vars</span> <span class="o">=</span> <span class="n">VAR_PHASES</span><span class="p">[</span><span class="n">phase</span><span class="p">()]</span>
    <span class="kd">local</span> <span class="n">path</span> <span class="o">=</span> <span class="n">view</span>
    <span class="kd">local</span> <span class="n">root</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">location</span>
    <span class="kr">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">root</span> <span class="ow">or</span> <span class="n">root</span> <span class="o">==</span> <span class="n">EMPTY</span><span class="p">)</span> <span class="ow">and</span> <span class="n">vars</span> <span class="kr">then</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">var</span><span class="p">.</span><span class="n">template_location</span>
    <span class="kr">end</span>
    <span class="kr">if</span> <span class="n">root</span> <span class="ow">and</span> <span class="n">root</span> <span class="o">~=</span> <span class="n">EMPTY</span> <span class="kr">then</span>
        <span class="kr">if</span> <span class="n">byte</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">SOL</span> <span class="kr">then</span> <span class="n">root</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="kr">end</span>
        <span class="kr">if</span> <span class="n">byte</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>  <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">SOL</span> <span class="kr">then</span> <span class="n">path</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="kr">end</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">root</span> <span class="o">..</span> <span class="s2">&quot;/&quot;</span> <span class="o">..</span> <span class="n">path</span>
        <span class="kd">local</span> <span class="n">res</span> <span class="o">=</span> <span class="n">capture</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="kr">if</span> <span class="n">res</span><span class="p">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">200</span> <span class="kr">then</span> <span class="kr">return</span> <span class="n">res</span><span class="p">.</span><span class="n">body</span> <span class="kr">end</span>
    <span class="kr">end</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">view</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">root</span>
    <span class="kr">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">root</span> <span class="ow">or</span> <span class="n">root</span> <span class="o">==</span> <span class="n">EMPTY</span><span class="p">)</span> <span class="ow">and</span> <span class="n">vars</span> <span class="kr">then</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">var</span><span class="p">.</span><span class="n">template_root</span>
        <span class="kr">if</span> <span class="ow">not</span> <span class="n">root</span> <span class="ow">or</span> <span class="n">root</span> <span class="o">==</span> <span class="n">EMPTY</span> <span class="kr">then</span> <span class="n">root</span> <span class="o">=</span> <span class="n">var</span><span class="p">.</span><span class="n">document_root</span> <span class="ow">or</span> <span class="n">prefix</span> <span class="kr">end</span>
    <span class="kr">end</span>
    <span class="kr">if</span> <span class="n">root</span> <span class="ow">and</span> <span class="n">root</span> <span class="o">~=</span> <span class="n">EMPTY</span> <span class="kr">then</span>
        <span class="kr">if</span> <span class="n">byte</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">SOL</span> <span class="kr">then</span> <span class="n">root</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="kr">end</span>
        <span class="kr">if</span> <span class="n">byte</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>  <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">SOL</span> <span class="kr">then</span> <span class="n">path</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="kr">end</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">root</span> <span class="o">..</span> <span class="s2">&quot;/&quot;</span> <span class="o">..</span> <span class="n">path</span>
    <span class="kr">end</span>
    <span class="kr">return</span> <span class="n">plain</span> <span class="o">==</span> <span class="kc">false</span> <span class="ow">and</span> <span class="nb">assert</span><span class="p">(</span><span class="n">read_file</span><span class="p">(</span><span class="n">path</span><span class="p">))</span> <span class="ow">or</span> <span class="n">read_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">or</span> <span class="n">view</span>
<span class="kr">end</span>
</code></pre></div>
<p>As you can see, <code>lua-resty-template</code> always tries (by default) to load a template from a file
(or with <code>ngx.location.capture</code>) even if you provided template as a string. <code>lua-resty-template</code>.
But if you know that your templates are always strings, and not file paths, you may use <code>plain</code>
argument in <code>template.compile</code>, <code>template.render</code>, and <code>template.parse</code> OR replace <code>template.load</code>
with the simplest possible template loader there is (but be aware that if your templates use
<code>{(file.html)}</code> includes, those are considered as strings too, in this case <code>file.html</code> will
be the template string that is parsed) - you could also setup a loader that finds templates in
some database system, e.g. Redis:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span>
<span class="n">template</span><span class="p">.</span><span class="n">load</span> <span class="o">=</span> <span class="kr">function</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">plain</span><span class="p">)</span> <span class="kr">return</span> <span class="n">view</span> <span class="kr">end</span>
</code></pre></div>
<p>If the <code>plain</code> parameter is <code>false</code> (<code>nil</code> is not treated as <code>false</code>), all the issues with file
io are considered assertion errors.</p>
<h4 id="string-templateload_stringview">string template.load_string(view)</h4>
<p>This just calls <code>template.load(view, true)</code></p>
<h4 id="string-templateload_fileview">string template.load_file(view)</h4>
<p>This just calls <code>template.load(view, false)</code></p>
<h4 id="templateprint">template.print</h4>
<p>This field contains a function that is used on <code>template.render()</code> or
<code>template.new("example.html"):render()</code> to output the results. By default this holds either
<code>ngx.print</code> (if available) or <code>print</code>. You may want to (and are allowed to) overwrite this
field, if you want to use your own output function instead. This is also useful if you are
using some other framework, e.g. Turbo.lua (<a href="http://turbolua.org/">http://turbolua.org/</a>).</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span>

<span class="n">template</span><span class="p">.</span><span class="n">print</span> <span class="o">=</span> <span class="kr">function</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&lt;!-- Output by My Function --&gt;&quot;</span><span class="p">)</span>
<span class="kr">end</span>
</code></pre></div>
<h2 id="template-precompilation">Template Precompilation</h2>
<p><code>lua-resty-template</code> supports template precompilation. This can be useful when you want to
skip template parsing (and Lua interpretation) in production or if you do not want your
templates distributed as plain text files on production servers. Also by precompiling,
you can ensure that your templates do not contain something, that cannot be compiled
(they are syntactically valid Lua). Although templates are cached (even without precompilation),
there are some performance (and memory) gains. You could integrate template precompilation in
your build (or deployment) scripts (maybe as Gulp, Grunt or Ant tasks).</p>
<h5 id="precompiling-template-and-output-it-as-a-binary-file">Precompiling template, and output it as a binary file</h5>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span>
<span class="kd">local</span> <span class="n">compiled</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">precompile</span><span class="p">(</span><span class="s2">&quot;example.html&quot;</span><span class="p">,</span> <span class="s2">&quot;example-bin.html&quot;</span><span class="p">)</span>
</code></pre></div>
<h5 id="load-precompiled-template-file-and-run-it-with-context-parameters">Load precompiled template file, and run it with context parameters</h5>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span>
<span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;example-bin.html&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&quot;Jack&quot;</span><span class="p">,</span> <span class="s2">&quot;Mary&quot;</span> <span class="p">})</span>
</code></pre></div>
<h2 id="template-helpers">Template Helpers</h2>
<h3 id="built-in-helpers">Built-in Helpers</h3>
<h4 id="echo">echo(...)</h4>
<p>Echoes output. This is useful with <code>{% .. %}</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span><span class="p">.</span><span class="n">render</span><span class="s">[[</span>
<span class="s">begin</span>
<span class="s">{%</span>
<span class="s">for i=1, 10 do</span>
<span class="s">  echo(&quot;\tline: &quot;, i, &quot;\n&quot;)</span>
<span class="s">end</span>
<span class="s">%}</span>
<span class="s">end</span>
<span class="s">]]</span>
</code></pre></div>
<p>This will output:</p>
<div class="highlight"><pre><span></span><code>begin
    line: 1
    line: 2
    line: 3
    line: 4
    line: 5
    line: 6
    line: 7
    line: 8
    line: 9
    line: 10
end
</code></pre></div>
<p>This can also be written as but <code>echo</code> might come handy in some cases:</p>
<div class="highlight"><pre><span></span><code><span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span><span class="p">.</span><span class="n">render</span><span class="s">[[</span>
<span class="s">begin</span>
<span class="s">{% for i=1, 10 do %}</span>
<span class="s">  line: {* i *}</span>
<span class="s">{% end %}</span>
<span class="s">end</span>
<span class="s">]]</span>
</code></pre></div>
<h4 id="includeview-context">include(view, context)</h4>
<p>This is mainly used with internally with <code>{(view.hmtl)}</code>, <code>{["view.hmtl"]}</code> and
with blocks <code>{-block-name-}..{-block-name-}</code>. If <code>context</code> is not given the context
used to compile parent view is used. This function will compile the <code>view</code> and call
the resulting function with <code>context</code> (or the <code>context</code> of parent view if not given).</p>
<h3 id="other-ways-to-extend">Other Ways to Extend</h3>
<p>While <code>lua-resty-template</code> does not have much infrastucture or ways to extend it,
you still have a few possibilities that you may try.</p>
<ul>
<li>Adding methods to global <code>string</code>, and <code>table</code> types (not encouraged, though)</li>
<li>Wrap your values with something before adding them in context (e.g. proxy-table)</li>
<li>Create global functions</li>
<li>Add local functions either to <code>template</code> table or <code>context</code> table</li>
<li>Use metamethods in your tables</li>
</ul>
<p>While modifying global types seems convenient, it can have nasty side effects.
That's why I suggest you to look at these libraries, and articles first:</p>
<ul>
<li>Method Chaining Wrapper (<a href="http://lua-users.org/wiki/MethodChainingWrapper">http://lua-users.org/wiki/MethodChainingWrapper</a>)</li>
<li>Moses (<a href="https://github.com/Yonaba/Moses">https://github.com/Yonaba/Moses</a>)</li>
<li>underscore-lua (<a href="https://github.com/jtarchie/underscore-lua">https://github.com/jtarchie/underscore-lua</a>)</li>
</ul>
<p>You could for example add Moses' or Underscore's <code>_</code> to template table or context table.</p>
<h5 id="example_3">Example</h5>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">_</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;moses&quot;</span>
<span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span>
<span class="n">template</span><span class="p">.</span><span class="n">_</span> <span class="o">=</span> <span class="n">_</span>
</code></pre></div>
<p>Then you can use <code>_</code> inside your templates. I created one example template helper
that can be found from here:
<a href="https://github.com/bungle/lua-resty-template/blob/master/lib/resty/template/html.lua">https://github.com/bungle/lua-resty-template/blob/master/lib/resty/template/html.lua</a></p>
<h5 id="lua_2">Lua</h5>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span>
<span class="kd">local</span> <span class="n">html</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template.html&quot;</span>

<span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="s">[[</span>
<span class="s">&lt;ul&gt;</span>
<span class="s">{% for _, person in ipairs(context) do %}</span>
<span class="s">    {*html.li(person.name)*}</span>
<span class="s">{% end %}</span>
<span class="s">&lt;/ul&gt;</span>
<span class="s">&lt;table&gt;</span>
<span class="s">{% for _, person in ipairs(context) do %}</span>
<span class="s">    &lt;tr data-sort=&quot;{{(person.name or &quot;&quot;):lower()}}&quot;&gt;</span>
<span class="s">        {*html.td{ id = person.id }(person.name)*}</span>
<span class="s">    &lt;/tr&gt;</span>
<span class="s">{% end %}</span>
<span class="s">&lt;/table&gt;]]</span><span class="p">,</span> <span class="p">{</span>
    <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Emma&quot;</span><span class="p">},</span>
    <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;James&quot;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Nicholas&quot;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">4</span> <span class="p">}</span>
<span class="p">})</span>
</code></pre></div>
<h5 id="output_1">Output</h5>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>Emma<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>James<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>Nicholas<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span> <span class="p">/&gt;</span>
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">table</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">tr</span> <span class="na">data-sort</span><span class="o">=</span><span class="s">&quot;emma&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">td</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;1&quot;</span><span class="p">&gt;</span>Emma<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">tr</span> <span class="na">data-sort</span><span class="o">=</span><span class="s">&quot;james&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">td</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;2&quot;</span><span class="p">&gt;</span>James<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">tr</span> <span class="na">data-sort</span><span class="o">=</span><span class="s">&quot;nicholas&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">td</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;3&quot;</span><span class="p">&gt;</span>Nicholas<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">tr</span> <span class="na">data-sort</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">td</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;4&quot;</span> <span class="p">/&gt;</span>
    <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">table</span><span class="p">&gt;</span>
</code></pre></div>
<h2 id="usage-examples">Usage Examples</h2>
<h3 id="template-including">Template Including</h3>
<p>You may include templates inside templates with <code>{(template)}</code> and <code>{(template, context)}</code> syntax.
The first one uses the current context as a context for included template, and the second one replaces
it with a new context. Here is example of using includes and passing a different context to include file:</p>
<h5 id="lua_3">Lua</h5>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span>
<span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;include.html&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="n">users</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Jane&quot;</span><span class="p">,</span> <span class="n">age</span> <span class="o">=</span> <span class="mi">29</span> <span class="p">},</span>
    <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="n">age</span> <span class="o">=</span> <span class="mi">25</span> <span class="p">}</span>
<span class="p">}})</span>
</code></pre></div>
<h5 id="includehtml">include.html</h5>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
{% for _, user in ipairs(users) do %}
    {(user.html, user)}
{% end %}
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<h5 id="userhtml">user.html</h5>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>User {{name}} is of age {{age}}<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</code></pre></div>
<h5 id="outut">Outut</h5>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>User Jane is of age 29<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>User John is of age 25<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="views-with-layouts">Views with Layouts</h3>
<p>Layouts (or Master Pages) can be used to wrap a view inside another view (aka layout).</p>
<h5 id="lua_4">Lua</h5>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span>
<span class="kd">local</span> <span class="n">layout</span>   <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">new</span> <span class="s2">&quot;layout.html&quot;</span>
<span class="n">layout</span><span class="p">.</span><span class="n">title</span>   <span class="o">=</span> <span class="s2">&quot;Testing lua-resty-template&quot;</span>
<span class="n">layout</span><span class="p">.</span><span class="n">view</span>    <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">compile</span> <span class="s2">&quot;view.html&quot;</span> <span class="p">{</span> <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Hello, World!&quot;</span> <span class="p">}</span>
<span class="n">layout</span><span class="p">:</span><span class="n">render</span><span class="p">()</span>
<span class="c1">-- Or like this</span>
<span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;layout.html&quot;</span><span class="p">,</span> <span class="p">{</span>
  <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Testing lua-resty-template&quot;</span><span class="p">,</span>
  <span class="n">view</span>  <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">compile</span> <span class="s2">&quot;view.html&quot;</span> <span class="p">{</span> <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Hello, World!&quot;</span> <span class="p">}</span>
<span class="p">})</span>
<span class="c1">-- Or maybe you like this style more</span>
<span class="c1">-- (but please remember that context.view is overwritten on rendering the layout.html)</span>
<span class="kd">local</span> <span class="n">view</span>     <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;view.html&quot;</span><span class="p">,</span> <span class="s2">&quot;layout.html&quot;</span><span class="p">)</span>
<span class="n">view</span><span class="p">.</span><span class="n">title</span>     <span class="o">=</span> <span class="s2">&quot;Testing lua-resty-template&quot;</span>
<span class="n">view</span><span class="p">.</span><span class="n">message</span>   <span class="o">=</span> <span class="s2">&quot;Hello, World!&quot;</span>
<span class="n">view</span><span class="p">:</span><span class="n">render</span><span class="p">()</span>
<span class="c1">-- Well, maybe like this then?</span>
<span class="kd">local</span> <span class="n">layout</span>   <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">new</span> <span class="s2">&quot;layout.html&quot;</span>
<span class="n">layout</span><span class="p">.</span><span class="n">title</span>   <span class="o">=</span> <span class="s2">&quot;Testing lua-resty-template&quot;</span>
<span class="kd">local</span> <span class="n">view</span>     <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;view.html&quot;</span><span class="p">,</span> <span class="n">layout</span><span class="p">)</span>
<span class="n">view</span><span class="p">.</span><span class="n">message</span>   <span class="o">=</span> <span class="s2">&quot;Hello, World!&quot;</span>
<span class="n">view</span><span class="p">:</span><span class="n">render</span><span class="p">()</span>
</code></pre></div>
<h5 id="viewhtml_4">view.html</h5>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{message}}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</code></pre></div>
<h5 id="layouthtml">layout.html</h5>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>{{title}}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    {*view*}
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<h5 id="alternatively-you-can-define-the-layout-in-a-view-as-well">Alternatively you can define the layout in a view as well:</h5>
<h5 id="lua_5">Lua</h5>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">view</span>     <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;view.html&quot;</span><span class="p">,</span> <span class="s2">&quot;layout.html&quot;</span><span class="p">)</span>
<span class="n">view</span><span class="p">.</span><span class="n">title</span>     <span class="o">=</span> <span class="s2">&quot;Testing lua-resty-template&quot;</span>
<span class="n">view</span><span class="p">.</span><span class="n">message</span>   <span class="o">=</span> <span class="s2">&quot;Hello, World!&quot;</span>
<span class="n">view</span><span class="p">:</span><span class="n">render</span><span class="p">()</span>
</code></pre></div>
<h5 id="viewhtml_5">view.html</h5>
<div class="highlight"><pre><span></span><code>{% layout=&quot;section.html&quot; %}
<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{message}}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</code></pre></div>
<h5 id="sectionhtml">section.html</h5>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;section&quot;</span><span class="p">&gt;</span>
    {*view*}
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>
<h5 id="layouthtml_1">layout.html</h5>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>{{title}}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    {*view*}
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<h5 id="output_2">Output</h5>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Testing lua-resty-template<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;section&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Hello, World!<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="using-blocks">Using Blocks</h3>
<p>Blocks can be used to move different parts of the views to specific places in layouts. Layouts have placeholders
for blocks.</p>
<h5 id="lua_6">Lua</h5>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">view</span>     <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;view.html&quot;</span><span class="p">,</span> <span class="s2">&quot;layout.html&quot;</span><span class="p">)</span>
<span class="n">view</span><span class="p">.</span><span class="n">title</span>     <span class="o">=</span> <span class="s2">&quot;Testing lua-resty-template blocks&quot;</span>
<span class="n">view</span><span class="p">.</span><span class="n">message</span>   <span class="o">=</span> <span class="s2">&quot;Hello, World!&quot;</span>
<span class="n">view</span><span class="p">.</span><span class="n">keywords</span>  <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;lua&quot;</span><span class="p">,</span> <span class="s2">&quot;template&quot;</span><span class="p">,</span> <span class="s2">&quot;blocks&quot;</span> <span class="p">}</span>
<span class="n">view</span><span class="p">:</span><span class="n">render</span><span class="p">()</span>
</code></pre></div>
<h5 id="viewhtml_6">view.html</h5>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{message}}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
{-aside-}
<span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
    {% for _, keyword in ipairs(keywords) do %}
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>{{keyword}}<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    {% end %}
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
{-aside-}
</code></pre></div>
<h5 id="layouthtml_2">layout.html</h5>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>{*title*}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">article</span><span class="p">&gt;</span>
    {*view*}
<span class="p">&lt;/</span><span class="nt">article</span><span class="p">&gt;</span>
{% if blocks.aside then %}
<span class="p">&lt;</span><span class="nt">aside</span><span class="p">&gt;</span>
    {*blocks.aside*}
<span class="p">&lt;/</span><span class="nt">aside</span><span class="p">&gt;</span>
{% end %}
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<h5 id="output_3">Output</h5>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Testing lua-resty-template blocks<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">article</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Hello, World!<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">article</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">aside</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>test<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>lua<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>template<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>blocks<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">aside</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="grandfather-father-son-inheritance">Grandfather-Father-Son Inheritance</h3>
<p>Say you have <code>base.html</code>, <code>layout1.html</code>, <code>layout2.html</code> and <code>page.html</code>. You want an inheritance like this:
<code>base.html ➡ layout1.html ➡ page.html</code> or <code>base.html ➡ layout2.html ➡ page.html</code> (actually this nesting is
not limited to three levels).</p>
<h5 id="lua_7">Lua</h5>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">res</span> <span class="o">=</span> <span class="nb">require</span><span class="s2">&quot;resty.template&quot;</span><span class="p">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;page.html&quot;</span><span class="p">){}</span> 
</code></pre></div>
<h5 id="basehtml">base.html</h5>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#39;zh&#39;</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;css/bootstrap.min.css&quot;</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span><span class="p">&gt;</span>
   {* blocks.page_css *}
   <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
   {* blocks.main *}
   <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;js/jquery.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;js/bootstrap.min.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
   {* blocks.page_js *}
   <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<h5 id="layout1html">layout1.html</h5>
<div class="highlight"><pre><span></span><code>{% layout = &quot;base.html&quot; %}
{-main-}
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;sidebar-1&quot;</span><span class="p">&gt;</span>
      {* blocks.sidebar *}
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;content-1&quot;</span><span class="p">&gt;</span>
      {* blocks.content *}
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
{-main-}
</code></pre></div>
<h5 id="layout2html">layout2.html</h5>
<div class="highlight"><pre><span></span><code>{% layout = &quot;base.html&quot; %}
{-main-}
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;sidebar-2&quot;</span><span class="p">&gt;</span>
      {* blocks.sidebar *}
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;content-2&quot;</span><span class="p">&gt;</span>
      {* blocks.content *}
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>I am different from layout1 <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
{-main-}
</code></pre></div>
<h5 id="pagehtml">page.html</h5>
<div class="highlight"><pre><span></span><code>{% layout = &quot;layout1.html&quot; %}
{-sidebar-}
  this is sidebar
{-sidebar-}

{-content-}
  this is content
{-content-}

{-page_css-}
  <span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;css/page.css&quot;</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span><span class="p">&gt;</span>
{-page_css-}

{-page_js-}
  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;js/page.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
{-page_js-}
</code></pre></div>
<p>Or:</p>
<h5 id="pagehtml_1">page.html</h5>
<div class="highlight"><pre><span></span><code>{% layout = &quot;layout2.html&quot; %}
{-sidebar-}
  this is sidebar
{-sidebar-}

{-content-}
  this is content
{-content-}

{-page_css-}
  <span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;css/page.css&quot;</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span><span class="p">&gt;</span>
{-page_css-}

{-page_js-}
  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;js/page.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
{-page_js-}
</code></pre></div>
<h3 id="macros">Macros</h3>
<p><a href="https://github.com/DDarko">@DDarko</a> mentioned in an <a href="https://github.com/bungle/lua-resty-template/issues/5">issue #5</a>
that he has a use case where he needs to have macros or parameterized views. That is a nice feature that you can
use with <code>lua-resty-template</code>.</p>
<p>To use macros, let's first define some Lua code:</p>
<div class="highlight"><pre><span></span><code><span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;macro.html&quot;</span><span class="p">,</span> <span class="p">{</span>
    <span class="n">item</span> <span class="o">=</span> <span class="s2">&quot;original&quot;</span><span class="p">,</span>
    <span class="n">items</span> <span class="o">=</span> <span class="p">{</span> <span class="n">a</span> <span class="o">=</span> <span class="s2">&quot;original-a&quot;</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="s2">&quot;original-b&quot;</span> <span class="p">}</span> 
<span class="p">})</span>
</code></pre></div>
<p>And the <code>macro-example.html</code>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="o">%</span> <span class="kd">local</span> <span class="n">string_macro</span> <span class="o">=</span> <span class="s">[[</span>
<span class="s">&lt;div&gt;{{item}}&lt;/div&gt;</span>
<span class="s">]]</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">*</span> <span class="n">template</span><span class="p">.</span><span class="n">compile</span><span class="p">(</span><span class="n">string_macro</span><span class="p">)(</span><span class="n">context</span><span class="p">)</span> <span class="o">*</span><span class="p">}</span>
<span class="p">{</span><span class="o">*</span> <span class="n">template</span><span class="p">.</span><span class="n">compile</span><span class="p">(</span><span class="n">string_macro</span><span class="p">){</span> <span class="n">item</span> <span class="o">=</span> <span class="s2">&quot;string-macro-context&quot;</span> <span class="p">}</span> <span class="o">*</span><span class="p">}</span>
</code></pre></div>
<p>This will output:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>original<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>string-macro-context<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>
<p>Now let's add function macro, in <code>macro-example.html</code> (you can omit <code>local</code> if you want):</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="o">%</span> <span class="kd">local</span> <span class="n">function_macro</span> <span class="o">=</span> <span class="kr">function</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">el</span><span class="p">)</span>
    <span class="n">el</span> <span class="o">=</span> <span class="n">el</span> <span class="ow">or</span> <span class="s2">&quot;div&quot;</span>
    <span class="kr">return</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">..</span> <span class="n">el</span> <span class="o">..</span> <span class="s2">&quot;&gt;{{&quot;</span> <span class="o">..</span> <span class="n">var</span> <span class="o">..</span> <span class="s2">&quot;}}&lt;/&quot;</span> <span class="o">..</span> <span class="n">el</span> <span class="o">..</span> <span class="s2">&quot;&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="kr">end</span> <span class="o">%</span><span class="p">}</span>

<span class="p">{</span><span class="o">*</span> <span class="n">template</span><span class="p">.</span><span class="n">compile</span><span class="p">(</span><span class="n">function_macro</span><span class="p">(</span><span class="s2">&quot;item&quot;</span><span class="p">))(</span><span class="n">context</span><span class="p">)</span> <span class="o">*</span><span class="p">}</span>
<span class="p">{</span><span class="o">*</span> <span class="n">template</span><span class="p">.</span><span class="n">compile</span><span class="p">(</span><span class="n">function_macro</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;span&quot;</span><span class="p">))(</span><span class="n">items</span><span class="p">)</span> <span class="o">*</span><span class="p">}</span>
</code></pre></div>
<p>This will output:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>original<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span>original-a<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</code></pre></div>
<p>But this is even more flexible, let's try another function macro:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="o">%</span> <span class="kd">local</span> <span class="kr">function</span> <span class="nf">function_macro2</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="kr">return</span> <span class="n">template</span><span class="p">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;{{&quot;</span> <span class="o">..</span> <span class="n">var</span> <span class="o">..</span> <span class="s2">&quot;}}&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="kr">end</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">*</span> <span class="n">function_macro2</span> <span class="s2">&quot;item&quot;</span> <span class="p">(</span><span class="n">context</span><span class="p">)</span> <span class="o">*</span><span class="p">}</span>
<span class="p">{</span><span class="o">*</span> <span class="n">function_macro2</span> <span class="s2">&quot;b&quot;</span> <span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">*</span><span class="p">}</span>
</code></pre></div>
<p>This will output:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>original<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>original-b<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>
<p>And here is another one:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="o">%</span> <span class="kr">function</span> <span class="nf">function_macro3</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
    <span class="kr">return</span> <span class="n">template</span><span class="p">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;{{&quot;</span> <span class="o">..</span> <span class="n">var</span> <span class="o">..</span> <span class="s2">&quot;}}&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)(</span><span class="n">ctx</span> <span class="ow">or</span> <span class="n">context</span><span class="p">)</span>
<span class="kr">end</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">*</span> <span class="n">function_macro3</span><span class="p">(</span><span class="s2">&quot;item&quot;</span><span class="p">)</span> <span class="o">*</span><span class="p">}</span>
<span class="p">{</span><span class="o">*</span> <span class="n">function_macro3</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">items</span><span class="p">)</span> <span class="o">*</span><span class="p">}</span>
<span class="p">{</span><span class="o">*</span> <span class="n">function_macro3</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">items</span><span class="p">)</span> <span class="o">*</span><span class="p">}</span>
<span class="p">{</span><span class="o">*</span> <span class="n">function_macro3</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="n">b</span> <span class="o">=</span> <span class="s2">&quot;b-from-new-context&quot;</span> <span class="p">})</span> <span class="o">*</span><span class="p">}</span>
</code></pre></div>
<p>This will output:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>original<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>original-a<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>original-b<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>b-from-new-context<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>
<p>Macros are really flexible. You may have form-renderers and other helper-macros to have a reusable and
parameterized template output. One thing you should know is that inside code blocks (between <code>{%</code> and <code>%}</code>)
you cannot have <code>%}</code>, but you can work around this using string concatenation <code>"%" .. "}"</code>.</p>
<h3 id="calling-methods-in-templates">Calling Methods in Templates</h3>
<p>You can call string methods (or other table functions) in templates too.</p>
<h5 id="lua_8">Lua</h5>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span>
<span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="s">[[</span>
<span class="s">&lt;h1&gt;{{header:upper()}}&lt;/h1&gt;</span>
<span class="s">]]</span><span class="p">,</span> <span class="p">{</span> <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;hello, world!&quot;</span> <span class="p">})</span>
</code></pre></div>
<h5 id="output_4">Output</h5>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>HELLO, WORLD!<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</code></pre></div>
<h3 id="embedding-angular-or-other-tags-templating-inside-the-templates">Embedding Angular or other tags / templating inside the Templates</h3>
<p>Sometimes you need to mix and match other templates (say client side Javascript templates like Angular) with
server side lua-resty-templates. Say you have this kind of Angular template:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span> <span class="na">ng-app</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">body</span> <span class="na">ng-controller</span><span class="o">=</span><span class="s">&quot;MyController&quot;</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">input</span> <span class="na">ng-model</span><span class="o">=</span><span class="s">&quot;foo&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;bar&quot;</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">button</span> <span class="na">ng-click</span><span class="o">=</span><span class="s">&quot;changeFoo()&quot;</span><span class="p">&gt;</span>{{buttonText}}<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;angular.js&quot;</span><span class="p">&gt;</span>
<span class="w"> </span><span class="o">&lt;</span><span class="err">/body&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<p>Now you can see that there is <code>{{buttonText}}</code> that is really for Angular templating, and not for lua-resty-template.
You can fix this by wrapping either the whole code with <code>{-verbatim-}</code> or <code>{-raw-}</code> or only the parts that you want:</p>
<div class="highlight"><pre><span></span><code>{-raw-}
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">ng-app</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">body</span> <span class="na">ng-controller</span><span class="o">=</span><span class="s">&quot;MyController&quot;</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">input</span> <span class="na">ng-model</span><span class="o">=</span><span class="s">&quot;foo&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;bar&quot;</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">button</span> <span class="na">ng-click</span><span class="o">=</span><span class="s">&quot;changeFoo()&quot;</span><span class="p">&gt;</span>{{buttonText}}<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;angular.js&quot;</span><span class="p">&gt;</span>
<span class="w"> </span><span class="o">&lt;</span><span class="err">/body&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
{-raw-}
</code></pre></div>
<p>or (see the <code>{(head.html)}</code> is processed by lua-resty-template):</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span> <span class="na">ng-app</span><span class="p">&gt;</span>
 {(head.html)}
 <span class="p">&lt;</span><span class="nt">body</span> <span class="na">ng-controller</span><span class="o">=</span><span class="s">&quot;MyController&quot;</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">input</span> <span class="na">ng-model</span><span class="o">=</span><span class="s">&quot;foo&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;bar&quot;</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">button</span> <span class="na">ng-click</span><span class="o">=</span><span class="s">&quot;changeFoo()&quot;</span><span class="p">&gt;</span>{-raw-}{{buttonText}}{-raw-}<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;angular.js&quot;</span><span class="p">&gt;</span>
<span class="w"> </span><span class="o">&lt;</span><span class="err">/body&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<p>You may also use short escaping syntax:</p>
<div class="highlight"><pre><span></span><code>...
<span class="p">&lt;</span><span class="nt">button</span> <span class="na">ng-click</span><span class="o">=</span><span class="s">&quot;changeFoo()&quot;</span><span class="p">&gt;</span>\{{buttonText}}<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
...
</code></pre></div>
<h3 id="embedding-markdown-inside-the-templates">Embedding Markdown inside the Templates</h3>
<p>If you want to embed Markdown (and SmartyPants) syntax inside your templates you can do it by using for example
<a href="https://github.com/bungle/lua-resty-hoedown"><code>lua-resty-hoedown</code></a> (it depends on LuaJIT). Here is an example of
using that:</p>
<h5 id="lua_9">Lua</h5>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span>
<span class="n">template</span><span class="p">.</span><span class="n">markdown</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.hoedown&quot;</span>

<span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="s">[=[</span>
<span class="s">&lt;html&gt;</span>
<span class="s">&lt;body&gt;</span>
<span class="s">{*markdown[[</span>
<span class="s">#Hello, World</span>

<span class="s">Testing Markdown.</span>
<span class="s">]]*}</span>
<span class="s">&lt;/body&gt;</span>
<span class="s">&lt;/html&gt;</span>
<span class="s">]=]</span>
</code></pre></div>
<h5 id="output_5">Output</h5>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Hello, World<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Testing Markdown.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<p>You may also add config parameters that are documented in <code>lua-resty-hoedown</code> project.
Say you want also to use SmartyPants:</p>
<h5 id="lua_10">Lua</h5>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template&quot;</span>
<span class="n">template</span><span class="p">.</span><span class="n">markdown</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.hoedown&quot;</span>

<span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="s">[=[</span>
<span class="s">&lt;html&gt;</span>
<span class="s">&lt;body&gt;</span>
<span class="s">{*markdown([[</span>
<span class="s">#Hello, World</span>

<span class="s">Testing Markdown with &quot;SmartyPants&quot;...</span>
<span class="s">]], { smartypants = true })*}</span>
<span class="s">&lt;/body&gt;</span>
<span class="s">&lt;/html&gt;</span>
<span class="s">]=]</span>
</code></pre></div>
<h5 id="output_6">Output</h5>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Hello, World<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Testing Markdown with <span class="ni">&amp;ldquo;</span>SmartyPants<span class="ni">&amp;rdquo;&amp;hellip;</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<p>You may also want to add caching layer for your Markdowns, or a helper functions instead of placing
Hoedown library directly  as a template helper function in <code>template</code>.   </p>
<h3 id="lua-server-pages-lsp-with-openresty">Lua Server Pages (LSP) with OpenResty</h3>
<p>Lua Server Pages or LSPs is similar to traditional PHP or Microsoft Active Server Pages (ASP)
where you can just place source code files in your document root (of your web server) and have
them processed by compilers of the respective languages (PHP, VBScript, JScript, etc.).
You can emulate quite closely this, sometimes called spaghetti-style of develoment, easily with
<code>lua-resty-template</code>. Those that have been doing ASP.NET Web Forms development, know a concept
of Code Behind files. There is something similar, but this time we call it Layout in Front here
(you may include Lua modules with normal <code>require</code> calls if you wish in LSPs). To help you
understand the concepts, let's have a small example:</p>
<h5 id="nginxconf">nginx.conf:</h5>
<div class="highlight"><pre><span></span><code><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kn">init_by_lua</span><span class="w"> </span><span class="s">&#39;</span>
<span class="w">    </span><span class="s">require</span><span class="w"> </span><span class="s">&quot;resty.core&quot;</span>
<span class="w">    </span><span class="s">template</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">require</span><span class="w"> </span><span class="s">&quot;resty.template&quot;</span>
<span class="w">    </span><span class="s">template.caching(false)</span><span class="p">;</span><span class="w"> </span><span class="kn">--</span><span class="w"> </span><span class="s">you</span><span class="w"> </span><span class="s">may</span><span class="w"> </span><span class="s">remove</span><span class="w"> </span><span class="s">this</span><span class="w"> </span><span class="no">on</span><span class="w"> </span><span class="s">production</span>
<span class="w">  </span><span class="s">&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="p">~</span><span class="w"> </span><span class="sr">\.lsp$</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kn">default_type</span><span class="w"> </span><span class="s">text/html</span><span class="p">;</span>
<span class="w">      </span><span class="kn">content_by_lua</span><span class="w"> </span><span class="s">&#39;template.render(ngx.var.uri)&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The above configuration creates a global <code>template</code> variable in Lua environment (you may not want that).
We also created location to match all <code>.lsp</code> files (or locations), and then we just render the template.</p>
<p>Let's imagine that the request is for <code>index.lsp</code>.</p>
<h5 id="indexlsp">index.lsp</h5>
<div class="highlight"><pre><span></span><code>{%
layout = &quot;layouts/default.lsp&quot;
local title = &quot;Hello, World!&quot;
%}
<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{title}}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</code></pre></div>
<p>Here you can see that this file includes a little bit of a view (<code>&lt;h1&gt;{{title}}&lt;/h1&gt;</code>) in addition to some
Lua code that we want to run. If you want to have a pure code file with Layout in Front, then just don't
write any view code in this file. The <code>layout</code> variable is already defined in views as documented else
where in this documentation. Now let's see the other files too.</p>
<h5 id="layoutsdefaultlsp">layouts/default.lsp</h5>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
{(include/header.lsp)}
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
{*view*}
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<p>Here we have a layout to decorate the <code>index.lsp</code>, but we also have include here, so let's look at it.</p>
<h5 id="includeheaderlsp">include/header.lsp</h5>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Testing Lua Server Pages<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</code></pre></div>
<p>Static stuff here only.</p>
<h5 id="output_7">Output</h5>
<p>The final output will look like this:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Testing Lua Server Pages<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Hello, World!<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<p>As you can see, <code>lua-resty-template</code> can be quite flexibile and easy to start with. Just place
files under your document root and use the normal save-and-refresh style of development. The
server will automatically pick the new files and reload the templates (if the caching is turned
of) on save.</p>
<p>If you want to pass variables to layouts or includes you can add stuff to context table (in the
example below see <code>context.title</code>):</p>
<div class="highlight"><pre><span></span><code>{%
layout = &quot;layouts/default.lsp&quot;
local title = &quot;Hello, World!&quot;
context.title = &#39;My Application - &#39; .. title
%}
<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{title}}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</code></pre></div>
<h2 id="faq">FAQ</h2>
<h3 id="how-do-i-clear-the-template-cache">How Do I Clear the Template Cache</h3>
<p><code>lua-resty-template</code> automatically caches (if caching is enabled) the resulting template functions
in <code>template.cache</code> table. You can clear the cache by issuing <code>template.cache = {}</code>.</p>
<h3 id="where-is-lua-resty-template-used">Where is <code>lua-resty-template</code> Used</h3>
<ul>
<li><a href="http://www.jd.com/">jd.com</a> – Jingdong Mall (Chinese: 京东商城; pinyin: Jīngdōng Shāngchéng),
formerly 360Buy, is a Chinese electronic commerce company</li>
</ul>
<p>Please let me know if there are errors or old information in this list. </p>
<h2 id="alternatives">Alternatives</h2>
<p>You may also look at these (as alternatives, or to mix them with <code>lua-resty-template</code>):</p>
<ul>
<li>lemplate (<a href="https://github.com/openresty/lemplate">https://github.com/openresty/lemplate</a>)</li>
<li>lua-resty-tags (<a href="https://github.com/bungle/lua-resty-tags">https://github.com/bungle/lua-resty-tags</a>)</li>
<li>lua-resty-hoedown (<a href="https://github.com/bungle/lua-resty-hoedown">https://github.com/bungle/lua-resty-hoedown</a>)</li>
<li>etlua (<a href="https://github.com/leafo/etlua">https://github.com/leafo/etlua</a>)</li>
<li>lua-template (<a href="https://github.com/dannote/lua-template">https://github.com/dannote/lua-template</a>)</li>
<li>lua-resty-tmpl (<a href="https://github.com/lloydzhou/lua-resty-tmpl">https://github.com/lloydzhou/lua-resty-tmpl</a>) (a fork of the <a href="https://github.com/dannote/lua-template">lua-template</a>)</li>
<li>htmlua (<a href="https://github.com/benglard/htmlua">https://github.com/benglard/htmlua</a>)</li>
<li>cgilua (<a href="http://keplerproject.github.io/cgilua/manual.html#templates">http://keplerproject.github.io/cgilua/manual.html#templates</a>)</li>
<li>orbit (<a href="http://keplerproject.github.io/orbit/pages.html">http://keplerproject.github.io/orbit/pages.html</a>)</li>
<li>turbolua mustache (<a href="http://turbolua.org/doc/web.html#mustache-templating">http://turbolua.org/doc/web.html#mustache-templating</a>)</li>
<li>pl.template (<a href="http://stevedonovan.github.io/Penlight/api/modules/pl.template.html">http://stevedonovan.github.io/Penlight/api/modules/pl.template.html</a>)</li>
<li>lustache (<a href="https://github.com/Olivine-Labs/lustache">https://github.com/Olivine-Labs/lustache</a>)</li>
<li>luvstache (<a href="https://github.com/james2doyle/luvstache">https://github.com/james2doyle/luvstache</a>)</li>
<li>luaghetti (<a href="https://github.com/AterCattus/luaghetti">https://github.com/AterCattus/luaghetti</a>)</li>
<li>lub.Template (<a href="http://doc.lubyk.org/lub.Template.html">http://doc.lubyk.org/lub.Template.html</a>)</li>
<li>lust (<a href="https://github.com/weshoke/Lust">https://github.com/weshoke/Lust</a>)</li>
<li>templet (<a href="http://colberg.org/lua-templet/">http://colberg.org/lua-templet/</a>)</li>
<li>luahtml (<a href="https://github.com/TheLinx/LuaHTML">https://github.com/TheLinx/LuaHTML</a>)</li>
<li>mixlua (<a href="https://github.com/LuaDist/mixlua">https://github.com/LuaDist/mixlua</a>)</li>
<li>lutem (<a href="https://github.com/daly88/lutem">https://github.com/daly88/lutem</a>)</li>
<li>tirtemplate (<a href="https://github.com/torhve/LuaWeb/blob/master/tirtemplate.lua">https://github.com/torhve/LuaWeb/blob/master/tirtemplate.lua</a>)</li>
<li>cosmo (<a href="http://cosmo.luaforge.net/">http://cosmo.luaforge.net/</a>)</li>
<li>lua-codegen (<a href="http://fperrad.github.io/lua-CodeGen/">http://fperrad.github.io/lua-CodeGen/</a>)</li>
<li>groucho (<a href="https://github.com/hanjos/groucho">https://github.com/hanjos/groucho</a>)</li>
<li>simple lua preprocessor (<a href="http://lua-users.org/wiki/SimpleLuaPreprocessor">http://lua-users.org/wiki/SimpleLuaPreprocessor</a>)</li>
<li>slightly less simple lua preprocessor (<a href="http://lua-users.org/wiki/SlightlyLessSimpleLuaPreprocessor">http://lua-users.org/wiki/SlightlyLessSimpleLuaPreprocessor</a>)</li>
<li>ltp (<a href="http://www.savarese.com/software/ltp/">http://www.savarese.com/software/ltp/</a>)</li>
<li>slt (<a href="https://code.google.com/p/slt/">https://code.google.com/p/slt/</a>)</li>
<li>slt2 (<a href="https://github.com/henix/slt2">https://github.com/henix/slt2</a>)</li>
<li>luasp (<a href="http://luasp.org/">http://luasp.org/</a>)</li>
<li>view0 (<a href="https://bitbucket.org/jimstudt/view0">https://bitbucket.org/jimstudt/view0</a>)</li>
<li>leslie (<a href="https://code.google.com/p/leslie/">https://code.google.com/p/leslie/</a>)</li>
<li>fraudster (<a href="https://bitbucket.org/sphen_lee/fraudster">https://bitbucket.org/sphen_lee/fraudster</a>)</li>
<li>lua-haml (<a href="https://github.com/norman/lua-haml">https://github.com/norman/lua-haml</a>)</li>
<li>lua-template (<a href="https://github.com/tgn14/Lua-template">https://github.com/tgn14/Lua-template</a>)</li>
<li>hige (<a href="https://github.com/nrk/hige">https://github.com/nrk/hige</a>)</li>
<li>mod_pLua (<a href="https://sourceforge.net/p/modplua/wiki/Home/">https://sourceforge.net/p/modplua/wiki/Home/</a>)</li>
<li>lapis html generation (<a href="http://leafo.net/lapis/reference.html#html-generation">http://leafo.net/lapis/reference.html#html-generation</a>)</li>
</ul>
<p><code>lua-resty-template</code> <em>was originally forked from Tor Hveem's</em> <code>tirtemplate.lua</code> <em>that he had extracted
from Zed Shaw's Tir web framework (<a href="http://tir.mongrel2.org/">http://tir.mongrel2.org/</a>). Thank you Tor, and Zed for your earlier
contributions.</em></p>
<h2 id="benchmarks">Benchmarks</h2>
<p>There is a small microbenchmark located here:
<a href="https://github.com/bungle/lua-resty-template/blob/master/lib/resty/template/microbenchmark.lua">https://github.com/bungle/lua-resty-template/blob/master/lib/resty/template/microbenchmark.lua</a></p>
<p>There is also a regression in LuaJIT that affects the results. If you want your LuaJIT patched against this,
you need to merge this pull request: <a href="https://github.com/LuaJIT/LuaJIT/pull/174">https://github.com/LuaJIT/LuaJIT/pull/174</a>.</p>
<p>Others have <a href="https://github.com/bungle/lua-resty-template/issues/21#issuecomment-226786051">reported</a>
that in simple benchmarks running this template engine actually beats Nginx serving static files by
a factor of three. So I guess this engine is quite fast. </p>
<h5 id="lua_11">Lua</h5>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">benchmark</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;resty.template.microbenchmark&quot;</span>
<span class="n">benchmark</span><span class="p">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1">-- You may also pass iteration count (by default it is 1,000)</span>
<span class="n">benchmark</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div>
<p>Here are some results from my desktop (old 2010 Mac Pro):
<div class="highlight"><pre><span></span><code>&lt;lua|luajit|resty&gt; -e &#39;require &quot;resty.template.microbenchmark&quot;.run()&#39;
</code></pre></div>
`</p>
<h5 id="resty-resty-023-nginx-version-openresty11582">resty (resty 0.23, nginx version: openresty/1.15.8.2)</h5>
<div class="highlight"><pre><span></span><code>Running 1000 iterations in each test
    Parsing Time: 0.003980
Compilation Time: 0.025983 (template)
Compilation Time: 0.000066 (template, cached)
  Execution Time: 0.032752 (same template)
  Execution Time: 0.002740 (same template, cached)
  Execution Time: 0.036111 (different template)
  Execution Time: 0.005559 (different template, cached)
  Execution Time: 0.032453 (different template, different context)
  Execution Time: 0.006057 (different template, different context, cached)
      Total Time: 0.145701
</code></pre></div>
<p>I have not yet compared the results against the alternatives.</p>
<h2 id="changes">Changes</h2>
<p>The changes of every release of this module is recorded in
<a href="https://github.com/bungle/lua-resty-template/blob/master/Changes.md">Changes.md</a> file.</p>
<h2 id="see-also">See Also</h2>
<ul>
<li><a href="https://github.com/bungle/lua-resty-route">lua-resty-route</a> — Routing library</li>
<li><a href="https://github.com/bungle/lua-resty-reqargs">lua-resty-reqargs</a> — Request arguments parser</li>
<li><a href="https://github.com/bungle/lua-resty-session">lua-resty-session</a> — Session library</li>
<li><a href="https://github.com/bungle/lua-resty-validation">lua-resty-validation</a> — Validation and filtering library</li>
</ul>
<h2 id="roadmap">Roadmap</h2>
<p>Some things I and the community wishes to be added:</p>
<ul>
<li>Better debugging capabilities and better error messages</li>
<li>Proper sandboxing</li>
</ul>
<h2 id="github">GitHub</h2>
<p>You may find additional configuration tips and documentation for this module in the <a href="https://github.com/bungle/lua-resty-template" target="_blank">GitHub repository for 
nginx-module-template</a>.</p>







  
  



  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2014 - 2023 GetPageSpeed LLC 2023
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/GetPageSpeed" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/GetPageSpeed" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/getpagespeed" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.facebook.com/getpagespeed/" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://t.me/GetPageSpeed" target="_blank" rel="noopener" title="t.me" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8Zm114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452 0 0 1 3.53 6.716 43.765 43.765 0 0 1 .417 9.769Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.expand", "navigation.top", "navigation.tabs", "search.suggest", "content.tooltips", "content.tabs.link", "content.code.copy"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>